import"../chunks/NZTpNUN0.js";import{i as Mt}from"../chunks/CIEG9mRb.js";import{D as Dt,E as Za,am as au,an as ou,ao as iu,C as hs,O as vs,N as Ja,P as rr,U as su,a as u,Y as ee,G as uu,I as cu,J as Oo,K as Mo,L as Na,ap as lu,aq as fu,M as ps,ar as ms,as as du,m as Ct,a7 as ko,at as Ia,$ as Ua,au as gu,av as hu,aw as vu,ax as pu,ay as mu,az as _u,aA as yu,aB as bu,aC as wu,aD as Eu,aE as Su,aF as Tu,aG as xu,aH as Au,aI as Pu,F as Ru,aJ as Du,aK as Ou,Q as Mu,f as br,aL as ku,aM as Cu,aN as Nu,aO as _s,aa as Iu,S as $u,n as Gt,V as Lu,t as Uu,aP as Zt,p as Qe,l as pe,y as re,ai as Rt,A as te,z as ae,q as it,aQ as Xt,v as ne,x as Ze,B as Nt,b as Fe,ac as St,o as je,ak as gn,aR as Tn,ad as vn,aS as Sr,ab as Wn,aT as Fu,e as Fa,al as Bu,aU as Ba,aV as jn,aW as eo,i as Ku,Z as Vu,aX as Hu,aY as Gu}from"../chunks/Dm59emqP.js";import{p as me,i as Xe,l as qn,s as zn,b as Yt}from"../chunks/D0wKyxf_.js";import{b as A,s as st,a as z,d as ju,u as he}from"../chunks/B2Eo3WWr.js";import{d as fn,s as ta,L as gt,l as Ot,p as na,O as d,w as Qt,c as It,m as ys,M as Ka,I as kt,R as wr,a as $n,b as bs,r as ws,j as to,e as no,k as Es,f as Ss,g as qt,h as zt,i as Ts,n as xs,o as Va,q as Ha,t as qr,u as zr,v as Yr,x as Ga,y as Wu,z as H,T as dt,A as ja,B as Er,C as Wa,D as qa,E as ra,F as Qr,G as za,H as dn,J as qu,K as As,N as Ps,P as zu,Q as Rs,S as Zr,U as Ds,V as Ya,W as Yu,X as Os,Y as Xu,Z as Co,_ as No,$ as Io,a0 as $o,a1 as Lo,a2 as Uo,a3 as Fo,a4 as Bo,a5 as Ko,a6 as Vo,a7 as Ho,a8 as Go,a9 as jo,aa as Wo,ab as qo,ac as zo,ad as Qu,ae as Yo,af as Xo,ag as Qo,ah as Zo,ai as Jo,aj as ei,ak as ti,al as ni,am as ri,an as ai,ao as oi,ap as ii,aq as si,ar as ui,as as ci,at as li,au as fi,av as di,aw as gi,ax as hi,ay as vi,az as pi,aA as mi,aB as _i,aC as yi,aD as bi,aE as wi,aF as Ei,aG as Si,aH as Ti,aI as xi,aJ as Ai,aK as Pi,aL as Ri,aM as Di,aN as Oi,aO as Mi,aP as ki,aQ as Ci,aR as Ni,aS as Ii,aT as $i,aU as Li,aV as Ui,aW as Fi,aX as Bi,aY as Ki,aZ as Vi,a_ as Hi,a$ as Gi,b0 as ji,b1 as Wi,b2 as qi,b3 as zi,b4 as Yi,b5 as Xi,b6 as Qi,b7 as Zi,b8 as Ji,b9 as es,ba as ts,bb as ns,bc as rs,bd as Zu,be as Ju,bf as ec,bg as tc,bh as nc,bi as rc,bj as ac,bk as oc,bl as ic,bm as sc,bn as uc,bo as cc,bp as lc,bq as fc}from"../chunks/kRkG3li4.js";let as=!1;function dc(){as||(as=!0,document.addEventListener("reset",v=>{Promise.resolve().then(()=>{if(!v.defaultPrevented)for(const s of v.target.elements)s.__on_r?.()})},{capture:!0}))}function Jr(v,s,i){Dt&&Za();var h=v,a=su,l,f=au()?ou:iu;hs(()=>{f(a,a=s())&&(l&&vs(l),l=Ja(()=>i(h)))}),Dt&&(h=rr)}function gc(v,s){return s}function hc(v,s,i,h){for(var a=[],l=s.length,f=0;f<l;f++)vu(s[f].e,a,!0);var P=l>0&&a.length===0&&i!==null;if(P){var N=i.parentNode;pu(N),N.append(i),h.clear(),Nn(v,s[0].prev,s[l-1].next)}mu(a,()=>{for(var k=0;k<l;k++){var M=s[k];P||(h.delete(M.k),Nn(v,M.prev,M.next)),_u(M.e,!P)}})}function vc(v,s,i,h,a,l=null){var f=v,P={flags:s,items:new Map,first:null};Dt&&Za();var N=null,k=!1,M=ee(()=>{var C=i();return du(C)?C:C==null?[]:ms(C)});hs(()=>{var C=u(M),O=C.length;if(k&&O===0)return;k=O===0;let B=!1;if(Dt){var $=uu(f)===cu;$!==(O===0)&&(f=Oo(),Mo(f),Na(!1),B=!0)}if(Dt){for(var j=null,L,G=0;G<O;G++){if(rr.nodeType===lu&&rr.data===fu){f=rr,B=!0,Na(!1);break}var X=C[G],q=h(X,G);L=Ms(rr,P,j,null,X,q,G,a,s,i),P.items.set(q,L),j=L}O>0&&Mo(Oo())}Dt||pc(C,P,f,a,s,h,i),l!==null&&(O===0?N?ps(N):N=Ja(()=>l(f)):N!==null&&vs(N,()=>{N=null})),B&&Na(!0),u(M)}),Dt&&(f=rr)}function pc(v,s,i,h,a,l,f){var P=v.length,N=s.items,k=s.first,M=k,C,O=null,B=[],$=[],j,L,G,X;for(X=0;X<P;X+=1){if(j=v[X],L=l(j,X),G=N.get(L),G===void 0){var q=M?M.e.nodes_start:i;O=Ms(q,s,O,O===null?s.first:O.next,j,L,X,h,a,f),N.set(L,O),B=[],$=[],M=O.next;continue}if(mc(G,j,X),(G.e.f&Ia)!==0&&ps(G.e),G!==M){if(C!==void 0&&C.has(G)){if(B.length<$.length){var m=$[0],Y;O=m.prev;var Q=B[0],K=B[B.length-1];for(Y=0;Y<B.length;Y+=1)os(B[Y],m,i);for(Y=0;Y<$.length;Y+=1)C.delete($[Y]);Nn(s,Q.prev,K.next),Nn(s,O,Q),Nn(s,K,m),M=m,O=K,X-=1,B=[],$=[]}else C.delete(G),os(G,M,i),Nn(s,G.prev,G.next),Nn(s,G,O===null?s.first:O.next),Nn(s,O,G),O=G;continue}for(B=[],$=[];M!==null&&M.k!==L;)(M.e.f&Ia)===0&&(C??=new Set).add(M),$.push(M),M=M.next;if(M===null)continue;G=M}B.push(G),O=G,M=G.next}if(M!==null||C!==void 0){for(var Z=C===void 0?[]:ms(C);M!==null;)(M.e.f&Ia)===0&&Z.push(M),M=M.next;var ce=Z.length;if(ce>0){var Te=null;hc(s,Z,Te,N)}}Ua.first=s.first&&s.first.e,Ua.last=O&&O.e}function mc(v,s,i,h){hu(v.v,s),v.i=i}function Ms(v,s,i,h,a,l,f,P,N,k){var M=(N&yu)!==0,C=(N&bu)===0,O=M?C?Ct(a,!1,!1):ko(a):a,B=(N&gu)===0?f:ko(f),$={i:B,v:O,k:l,a:null,e:null,prev:i,next:h};try{return $.e=Ja(()=>P(v,O,B,k),Dt),$.e.prev=i&&i.e,$.e.next=h&&h.e,i===null?s.first=$:(i.next=$,i.e.next=$.e),h!==null&&(h.prev=$,h.e.prev=$.e),$}finally{}}function os(v,s,i){for(var h=v.next?v.next.e.nodes_start:i,a=s?s.e.nodes_start:i,l=v.e.nodes_start;l!==h;){var f=wu(l);a.before(l),l=f}}function Nn(v,s,i){s===null?v.first=i:(s.next=i,s.e.next=i&&i.e),i!==null&&(i.prev=s,i.e.prev=s&&s.e)}function _c(v,s,i,h,a){Dt&&Za();var l=s.$$slots?.[i],f=!1;l===!0&&(l=s.children,f=!0),l===void 0||l(v,f?()=>h:h)}function ks(v){var s,i,h="";if(typeof v=="string"||typeof v=="number")h+=v;else if(typeof v=="object")if(Array.isArray(v)){var a=v.length;for(s=0;s<a;s++)v[s]&&(i=ks(v[s]))&&(h&&(h+=" "),h+=i)}else for(i in v)v[i]&&(h&&(h+=" "),h+=i);return h}function yc(){for(var v,s,i=0,h="",a=arguments.length;i<a;i++)(v=arguments[i])&&(s=ks(v))&&(h&&(h+=" "),h+=s);return h}function sr(v){return typeof v=="object"?yc(v):v??""}const is=[...` 	
\r\f \v\uFEFF`];function bc(v,s,i){var h=v==null?"":""+v;if(s&&(h=h?h+" "+s:s),i){for(var a in i)if(i[a])h=h?h+" "+a:a;else if(h.length)for(var l=a.length,f=0;(f=h.indexOf(a,f))>=0;){var P=f+l;(f===0||is.includes(h[f-1]))&&(P===h.length||is.includes(h[P]))?h=(f===0?"":h.substring(0,f))+h.substring(P+1):f=P}}return h===""?null:h}function wc(v,s){return v==null?null:String(v)}function Ye(v,s,i,h,a,l){var f=v.__className;if(Dt||f!==i||f===void 0){var P=bc(i,h,l);(!Dt||P!==v.getAttribute("class"))&&(P==null?v.removeAttribute("class"):v.className=P),v.__className=i}else if(l&&a!==l)for(var N in l){var k=!!l[N];(a==null||k!==!!a[N])&&v.classList.toggle(N,k)}return l}function Cs(v,s,i,h){var a=v.__style;if(Dt||a!==s){var l=wc(s);(!Dt||l!==v.getAttribute("style"))&&(l==null?v.removeAttribute("style"):v.style.cssText=l),v.__style=s}return h}const Ec=Symbol("is custom element"),Sc=Symbol("is html");function Tc(v){if(Dt){var s=!1,i=()=>{if(!s){if(s=!0,v.hasAttribute("value")){var h=v.value;hn(v,"value",null),v.value=h}if(v.hasAttribute("checked")){var a=v.checked;hn(v,"checked",null),v.checked=a}}};v.__on_r=i,Au(i),dc()}}function xc(v,s){var i=Ns(v);i.value===(i.value=s??void 0)||v.value===s&&(s!==0||v.nodeName!=="PROGRESS")||(v.value=s??"")}function hn(v,s,i,h){var a=Ns(v);Dt&&(a[s]=v.getAttribute(s),s==="src"||s==="srcset"||s==="href"&&v.nodeName==="LINK")||a[s]!==(a[s]=i)&&(s==="loading"&&(v[Eu]=i),i==null?v.removeAttribute(s):typeof i!="string"&&Ac(v).includes(s)?v[s]=i:v.setAttribute(s,i))}function Ns(v){return v.__attributes??={[Ec]:v.nodeName.includes("-"),[Sc]:v.namespaceURI===Su}}var ss=new Map;function Ac(v){var s=ss.get(v.nodeName);if(s)return s;ss.set(v.nodeName,s=[]);for(var i,h=v,a=Element.prototype;a!==h;){i=xu(h);for(var l in i)i[l].set&&s.push(l);h=Tu(h)}return s}const Pc=()=>performance.now(),Sn={tick:v=>requestAnimationFrame(v),now:()=>Pc(),tasks:new Set};function Is(){const v=Sn.now();Sn.tasks.forEach(s=>{s.c(v)||(Sn.tasks.delete(s),s.f())}),Sn.tasks.size!==0&&Sn.tick(Is)}function Rc(v){let s;return Sn.tasks.size===0&&Sn.tick(Is),{promise:new Promise(i=>{Sn.tasks.add(s={c:v,f:i})}),abort(){Sn.tasks.delete(s)}}}function Wr(v,s){_s(()=>{v.dispatchEvent(new CustomEvent(s))})}function Dc(v){if(v==="float")return"cssFloat";if(v==="offset")return"cssOffset";if(v.startsWith("--"))return v;const s=v.split("-");return s.length===1?s[0]:s[0]+s.slice(1).map(i=>i[0].toUpperCase()+i.slice(1)).join("")}function us(v){const s={},i=v.split(";");for(const h of i){const[a,l]=h.split(":");if(!a||l===void 0)break;const f=Dc(a.trim());s[f]=l.trim()}return s}const Oc=v=>v;function $t(v,s,i,h){var a=(v&Cu)!==0,l=(v&Nu)!==0,f=a&&l,P=(v&ku)!==0,N=f?"both":a?"in":"out",k,M=s.inert,C=s.style.overflow,O,B;function $(){return _s(()=>k??=i()(s,h?.()??{},{direction:N}))}var j={is_global:P,in(){if(s.inert=M,!a){B?.abort(),B?.reset?.();return}l||O?.abort(),Wr(s,"introstart"),O=Xa(s,$(),B,1,()=>{Wr(s,"introend"),O?.abort(),O=k=void 0,s.style.overflow=C})},out(q){if(!l){q?.(),k=void 0;return}s.inert=!0,Wr(s,"outrostart"),B=Xa(s,$(),O,0,()=>{Wr(s,"outroend"),q?.()})},stop:()=>{O?.abort(),B?.abort()}},L=Ua;if((L.transitions??=[]).push(j),a&&Pu){var G=P;if(!G){for(var X=L.parent;X&&(X.f&Ru)!==0;)for(;(X=X.parent)&&(X.f&Du)===0;);G=!X||(X.f&Ou)!==0}G&&Mu(()=>{br(()=>j.in())})}}function Xa(v,s,i,h,a){var l=h===1;if(Iu(s)){var f,P=!1;return $u(()=>{if(!P){var L=s({direction:l?"in":"out"});f=Xa(v,L,i,h,a)}}),{abort:()=>{P=!0,f?.abort()},deactivate:()=>f.deactivate(),reset:()=>f.reset(),t:()=>f.t()}}if(i?.deactivate(),!s?.duration)return a(),{abort:Gt,deactivate:Gt,reset:Gt,t:()=>h};const{delay:N=0,css:k,tick:M,easing:C=Oc}=s;var O=[];if(l&&i===void 0&&(M&&M(0,1),k)){var B=us(k(0,1));O.push(B,B)}var $=()=>1-h,j=v.animate(O,{duration:N,fill:"forwards"});return j.onfinish=()=>{j.cancel();var L=i?.t()??1-h;i?.abort();var G=h-L,X=s.duration*Math.abs(G),q=[];if(X>0){var m=!1;if(k)for(var Y=Math.ceil(X/16.666666666666668),Q=0;Q<=Y;Q+=1){var K=L+G*C(Q/Y),Z=us(k(K,1-K));q.push(Z),m||=Z.overflow==="hidden"}m&&(v.style.overflow="hidden"),$=()=>{var ce=j.currentTime;return L+G*C(ce/X)},M&&Rc(()=>{if(j.playState!=="running")return!1;var ce=$();return M(ce,1-ce),!0})}j=v.animate(q,{duration:X,fill:"forwards"}),j.onfinish=()=>{$=()=>h,M?.(h,1-h),a()}},{abort:()=>{j&&(j.cancel(),j.effect=null,j.onfinish=Gt)},deactivate:()=>{a=Gt},reset:()=>{h===0&&M?.(1,0)},t:()=>$()}}function Le(v,s,i){var h=Lu(v,s);h&&h.set&&(v[s]=i,Uu(()=>{v[s]=null}))}var Mc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function kc(v){return v&&v.__esModule&&Object.prototype.hasOwnProperty.call(v,"default")?v.default:v}var Xr={exports:{}},Cc=Xr.exports,cs;function Nc(){return cs||(cs=1,function(v,s){(function(i,h){v.exports=h()})(Cc,function(){var i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(n[o]=r[o])})(e,t)},h=function(){return(h=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function a(e,t,n){for(var r,o=0,c=t.length;o<c;o++)!r&&o in t||((r=r||Array.prototype.slice.call(t,0,o))[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))}var l=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:Mc,f=Object.keys,P=Array.isArray;function N(e,t){return typeof t!="object"||f(t).forEach(function(n){e[n]=t[n]}),e}typeof Promise>"u"||l.Promise||(l.Promise=Promise);var k=Object.getPrototypeOf,M={}.hasOwnProperty;function C(e,t){return M.call(e,t)}function O(e,t){typeof t=="function"&&(t=t(k(e))),(typeof Reflect>"u"?f:Reflect.ownKeys)(t).forEach(function(n){$(e,n,t[n])})}var B=Object.defineProperty;function $(e,t,n,r){B(e,t,N(n&&C(n,"get")&&typeof n.get=="function"?{get:n.get,set:n.set,configurable:!0}:{value:n,configurable:!0,writable:!0},r))}function j(e){return{from:function(t){return e.prototype=Object.create(t.prototype),$(e.prototype,"constructor",e),{extend:O.bind(null,e.prototype)}}}}var L=Object.getOwnPropertyDescriptor,G=[].slice;function X(e,t,n){return G.call(e,t,n)}function q(e,t){return t(e)}function m(e){if(!e)throw new Error("Assertion Failed")}function Y(e){l.setImmediate?setImmediate(e):setTimeout(e,0)}function Q(e,t){if(typeof t=="string"&&C(e,t))return e[t];if(!t)return e;if(typeof t!="string"){for(var n=[],r=0,o=t.length;r<o;++r){var c=Q(e,t[r]);n.push(c)}return n}var g=t.indexOf(".");if(g!==-1){var p=e[t.substr(0,g)];return p==null?void 0:Q(p,t.substr(g+1))}}function K(e,t,n){if(e&&t!==void 0&&!("isFrozen"in Object&&Object.isFrozen(e)))if(typeof t!="string"&&"length"in t){m(typeof n!="string"&&"length"in n);for(var r=0,o=t.length;r<o;++r)K(e,t[r],n[r])}else{var c,g,p=t.indexOf(".");p!==-1?(c=t.substr(0,p),(g=t.substr(p+1))===""?n===void 0?P(e)&&!isNaN(parseInt(c))?e.splice(c,1):delete e[c]:e[c]=n:K(p=!(p=e[c])||!C(e,c)?e[c]={}:p,g,n)):n===void 0?P(e)&&!isNaN(parseInt(t))?e.splice(t,1):delete e[t]:e[t]=n}}function Z(e){var t,n={};for(t in e)C(e,t)&&(n[t]=e[t]);return n}var ce=[].concat;function Te(e){return ce.apply([],e)}var tn="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(Te([8,16,32,64].map(function(e){return["Int","Uint","Float"].map(function(t){return t+e+"Array"})}))).filter(function(e){return l[e]}),Pe=new Set(tn.map(function(e){return l[e]})),_e=null;function De(e){return _e=new WeakMap,e=function t(n){if(!n||typeof n!="object")return n;var r=_e.get(n);if(r)return r;if(P(n)){r=[],_e.set(n,r);for(var o=0,c=n.length;o<c;++o)r.push(t(n[o]))}else if(Pe.has(n.constructor))r=n;else{var g,p=k(n);for(g in r=p===Object.prototype?{}:Object.create(p),_e.set(n,r),n)C(n,g)&&(r[g]=t(n[g]))}return r}(e),_e=null,e}var Ie={}.toString;function xe(e){return Ie.call(e).slice(8,-1)}var Ue=typeof Symbol<"u"?Symbol.iterator:"@@iterator",ke=typeof Ue=="symbol"?function(e){var t;return e!=null&&(t=e[Ue])&&t.apply(e)}:function(){return null};function Ee(e,t){return t=e.indexOf(t),0<=t&&e.splice(t,1),0<=t}var He={};function Se(e){var t,n,r,o;if(arguments.length===1){if(P(e))return e.slice();if(this===He&&typeof e=="string")return[e];if(o=ke(e)){for(n=[];!(r=o.next()).done;)n.push(r.value);return n}if(e==null)return[e];if(typeof(t=e.length)!="number")return[e];for(n=new Array(t);t--;)n[t]=e[t];return n}for(t=arguments.length,n=new Array(t);t--;)n[t]=arguments[t];return n}var Oe=typeof Symbol<"u"?function(e){return e[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},mn=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],Wt=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(mn),We={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function we(e,t){this.name=e,this.message=t}function qe(e,t){return e+". Errors: "+Object.keys(t).map(function(n){return t[n].toString()}).filter(function(n,r,o){return o.indexOf(n)===r}).join(`
`)}function Ce(e,t,n,r){this.failures=t,this.failedKeys=r,this.successCount=n,this.message=qe(e,t)}function tt(e,t){this.name="BulkError",this.failures=Object.keys(t).map(function(n){return t[n]}),this.failuresByPos=t,this.message=qe(e,this.failures)}j(we).from(Error).extend({toString:function(){return this.name+": "+this.message}}),j(Ce).from(we),j(tt).from(we);var ut=Wt.reduce(function(e,t){return e[t]=t+"Error",e},{}),at=we,S=Wt.reduce(function(e,t){var n=t+"Error";function r(o,c){this.name=n,o?typeof o=="string"?(this.message="".concat(o).concat(c?`
 `+c:""),this.inner=c||null):typeof o=="object"&&(this.message="".concat(o.name," ").concat(o.message),this.inner=o):(this.message=We[t]||n,this.inner=null)}return j(r).from(at),e[t]=r,e},{});S.Syntax=SyntaxError,S.Type=TypeError,S.Range=RangeError;var Je=mn.reduce(function(e,t){return e[t+"Error"]=S[t],e},{}),Tt=Wt.reduce(function(e,t){return["Syntax","Type","Range"].indexOf(t)===-1&&(e[t+"Error"]=S[t]),e},{});function Be(){}function vt(e){return e}function Jt(e,t){return e==null||e===vt?t:function(n){return t(e(n))}}function pt(e,t){return function(){e.apply(this,arguments),t.apply(this,arguments)}}function sn(e,t){return e===Be?t:function(){var n=e.apply(this,arguments);n!==void 0&&(arguments[0]=n);var r=this.onsuccess,o=this.onerror;this.onsuccess=null,this.onerror=null;var c=t.apply(this,arguments);return r&&(this.onsuccess=this.onsuccess?pt(r,this.onsuccess):r),o&&(this.onerror=this.onerror?pt(o,this.onerror):o),c!==void 0?c:n}}function en(e,t){return e===Be?t:function(){e.apply(this,arguments);var n=this.onsuccess,r=this.onerror;this.onsuccess=this.onerror=null,t.apply(this,arguments),n&&(this.onsuccess=this.onsuccess?pt(n,this.onsuccess):n),r&&(this.onerror=this.onerror?pt(r,this.onerror):r)}}function se(e,t){return e===Be?t:function(n){var r=e.apply(this,arguments);N(n,r);var o=this.onsuccess,c=this.onerror;return this.onsuccess=null,this.onerror=null,n=t.apply(this,arguments),o&&(this.onsuccess=this.onsuccess?pt(o,this.onsuccess):o),c&&(this.onerror=this.onerror?pt(c,this.onerror):c),r===void 0?n===void 0?void 0:n:N(r,n)}}function J(e,t){return e===Be?t:function(){return t.apply(this,arguments)!==!1&&e.apply(this,arguments)}}function yt(e,t){return e===Be?t:function(){var n=e.apply(this,arguments);if(n&&typeof n.then=="function"){for(var r=this,o=arguments.length,c=new Array(o);o--;)c[o]=arguments[o];return n.then(function(){return t.apply(r,c)})}return t.apply(this,arguments)}}Tt.ModifyError=Ce,Tt.DexieError=we,Tt.BulkError=tt;var xt=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function Xn(e){xt=e}var pn={},Qn=100,tn=typeof Promise>"u"?[]:function(){var e=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[e,k(e),e];var t=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[t,k(t),e]}(),mn=tn[0],Wt=tn[1],tn=tn[2],Wt=Wt&&Wt.then,jt=mn&&mn.constructor,xn=!!tn,_n=function(e,t){At.push([e,t]),yn&&(queueMicrotask(oa),yn=!1)},Ln=!0,yn=!0,nn=[],An=[],bn=vt,Ut={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:Be,pgp:!1,env:{},finalize:Be},be=Ut,At=[],rn=0,ge=[];function V(e){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var t=this._PSD=be;if(typeof e!="function"){if(e!==pn)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(this._state===!1&&mt(this,this._value))}this._state=null,this._value=null,++t.ref,function n(r,o){try{o(function(c){if(r._state===null){if(c===r)throw new TypeError("A promise cannot be resolved with itself.");var g=r._lib&&Pn();c&&typeof c.then=="function"?n(r,function(p,y){c instanceof V?c._then(p,y):c.then(p,y)}):(r._state=!0,r._value=c,Tr(r)),g&&Rn()}},mt.bind(null,r))}catch(c){mt(r,c)}}(this,e)}var Ae={get:function(){var e=be,t=un;function n(r,o){var c=this,g=!e.global&&(e!==be||t!==un),p=g&&!an(),y=new V(function(w,x){ur(c,new nt(Ar(r,e,g,p),Ar(o,e,g,p),w,x,e))});return this._consoleTask&&(y._consoleTask=this._consoleTask),y}return n.prototype=pn,n},set:function(e){$(this,"then",e&&e.prototype===pn?Ae:{get:function(){return e},set:Ae.set})}};function nt(e,t,n,r,o){this.onFulfilled=typeof e=="function"?e:null,this.onRejected=typeof t=="function"?t:null,this.resolve=n,this.reject=r,this.psd=o}function mt(e,t){var n,r;An.push(t),e._state===null&&(n=e._lib&&Pn(),t=bn(t),e._state=!1,e._value=t,r=e,nn.some(function(o){return o._value===r._value})||nn.push(r),Tr(e),n&&Rn())}function Tr(e){var t=e._listeners;e._listeners=[];for(var n=0,r=t.length;n<r;++n)ur(e,t[n]);var o=e._PSD;--o.ref||o.finalize(),rn===0&&(++rn,_n(function(){--rn==0&&cr()},[]))}function ur(e,t){if(e._state!==null){var n=e._state?t.onFulfilled:t.onRejected;if(n===null)return(e._state?t.resolve:t.reject)(e._value);++t.psd.ref,++rn,_n(aa,[n,e,t])}else e._listeners.push(t)}function aa(e,t,n){try{var r,o=t._value;!t._state&&An.length&&(An=[]),r=xt&&t._consoleTask?t._consoleTask.run(function(){return e(o)}):e(o),t._state||An.indexOf(o)!==-1||function(c){for(var g=nn.length;g;)if(nn[--g]._value===c._value)return nn.splice(g,1)}(t),n.resolve(r)}catch(c){n.reject(c)}finally{--rn==0&&cr(),--n.psd.ref||n.psd.finalize()}}function oa(){on(Ut,function(){Pn()&&Rn()})}function Pn(){var e=Ln;return yn=Ln=!1,e}function Rn(){var e,t,n;do for(;0<At.length;)for(e=At,At=[],n=e.length,t=0;t<n;++t){var r=e[t];r[0].apply(null,r[1])}while(0<At.length);yn=Ln=!0}function cr(){var e=nn;nn=[],e.forEach(function(r){r._PSD.onunhandled.call(null,r._value,r)});for(var t=ge.slice(0),n=t.length;n;)t[--n]()}function Zn(e){return new V(pn,!1,e)}function rt(e,t){var n=be;return function(){var r=Pn(),o=be;try{return Bt(n,!0),e.apply(this,arguments)}catch(c){t&&t(c)}finally{Bt(o,!1),r&&Rn()}}}O(V.prototype,{then:Ae,_then:function(e,t){ur(this,new nt(null,null,e,t,be))},catch:function(e){if(arguments.length===1)return this.then(null,e);var t=e,n=arguments[1];return typeof t=="function"?this.then(null,function(r){return(r instanceof t?n:Zn)(r)}):this.then(null,function(r){return(r&&r.name===t?n:Zn)(r)})},finally:function(e){return this.then(function(t){return V.resolve(e()).then(function(){return t})},function(t){return V.resolve(e()).then(function(){return Zn(t)})})},timeout:function(e,t){var n=this;return e<1/0?new V(function(r,o){var c=setTimeout(function(){return o(new S.Timeout(t))},e);n.then(r,o).finally(clearTimeout.bind(null,c))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&$(V.prototype,Symbol.toStringTag,"Dexie.Promise"),Ut.env=et(),O(V,{all:function(){var e=Se.apply(null,arguments).map(Bn);return new V(function(t,n){e.length===0&&t([]);var r=e.length;e.forEach(function(o,c){return V.resolve(o).then(function(g){e[c]=g,--r||t(e)},n)})})},resolve:function(e){return e instanceof V?e:e&&typeof e.then=="function"?new V(function(t,n){e.then(t,n)}):new V(pn,!0,e)},reject:Zn,race:function(){var e=Se.apply(null,arguments).map(Bn);return new V(function(t,n){e.map(function(r){return V.resolve(r).then(t,n)})})},PSD:{get:function(){return be},set:function(e){return be=e}},totalEchoes:{get:function(){return un}},newPSD:Ft,usePSD:on,scheduler:{get:function(){return _n},set:function(e){_n=e}},rejectionMapper:{get:function(){return bn},set:function(e){bn=e}},follow:function(e,t){return new V(function(n,r){return Ft(function(o,c){var g=be;g.unhandleds=[],g.onunhandled=c,g.finalize=pt(function(){var p,y=this;p=function(){y.unhandleds.length===0?o():c(y.unhandleds[0])},ge.push(function w(){p(),ge.splice(ge.indexOf(w),1)}),++rn,_n(function(){--rn==0&&cr()},[])},g.finalize),e()},t,n,r)})}}),jt&&(jt.allSettled&&$(V,"allSettled",function(){var e=Se.apply(null,arguments).map(Bn);return new V(function(t){e.length===0&&t([]);var n=e.length,r=new Array(n);e.forEach(function(o,c){return V.resolve(o).then(function(g){return r[c]={status:"fulfilled",value:g}},function(g){return r[c]={status:"rejected",reason:g}}).then(function(){return--n||t(r)})})})}),jt.any&&typeof AggregateError<"u"&&$(V,"any",function(){var e=Se.apply(null,arguments).map(Bn);return new V(function(t,n){e.length===0&&n(new AggregateError([]));var r=e.length,o=new Array(r);e.forEach(function(c,g){return V.resolve(c).then(function(p){return t(p)},function(p){o[g]=p,--r||n(new AggregateError(o))})})})}),jt.withResolvers&&(V.withResolvers=jt.withResolvers));var lt={awaits:0,echoes:0,id:0},ia=0,Un=[],Dn=0,un=0,Fn=0;function Ft(e,t,n,r){var o=be,c=Object.create(o);return c.parent=o,c.ref=0,c.global=!1,c.id=++Fn,Ut.env,c.env=xn?{Promise:V,PromiseProp:{value:V,configurable:!0,writable:!0},all:V.all,race:V.race,allSettled:V.allSettled,any:V.any,resolve:V.resolve,reject:V.reject}:{},t&&N(c,t),++o.ref,c.finalize=function(){--this.parent.ref||this.parent.finalize()},r=on(c,e,n,r),c.ref===0&&c.finalize(),r}function wn(){return lt.id||(lt.id=++ia),++lt.awaits,lt.echoes+=Qn,lt.id}function an(){return!!lt.awaits&&(--lt.awaits==0&&(lt.id=0),lt.echoes=lt.awaits*Qn,!0)}function Bn(e){return lt.echoes&&e&&e.constructor===jt?(wn(),e.then(function(t){return an(),t},function(t){return an(),ye(t)})):e}function xr(){var e=Un[Un.length-1];Un.pop(),Bt(e,!1)}function Bt(e,t){var n,r=be;(t?!lt.echoes||Dn++&&e===be:!Dn||--Dn&&e===be)||queueMicrotask(t?(function(o){++un,lt.echoes&&--lt.echoes!=0||(lt.echoes=lt.awaits=lt.id=0),Un.push(be),Bt(o,!0)}).bind(null,e):xr),e!==be&&(be=e,r===Ut&&(Ut.env=et()),xn&&(n=Ut.env.Promise,t=e.env,(r.global||e.global)&&(Object.defineProperty(l,"Promise",t.PromiseProp),n.all=t.all,n.race=t.race,n.resolve=t.resolve,n.reject=t.reject,t.allSettled&&(n.allSettled=t.allSettled),t.any&&(n.any=t.any))))}function et(){var e=l.Promise;return xn?{Promise:e,PromiseProp:Object.getOwnPropertyDescriptor(l,"Promise"),all:e.all,race:e.race,allSettled:e.allSettled,any:e.any,resolve:e.resolve,reject:e.reject}:{}}function on(e,t,n,r,o){var c=be;try{return Bt(e,!0),t(n,r,o)}finally{Bt(c,!1)}}function Ar(e,t,n,r){return typeof e!="function"?e:function(){var o=be;n&&wn(),Bt(t,!0);try{return e.apply(this,arguments)}finally{Bt(o,!1),r&&queueMicrotask(an)}}}function Me(e){Promise===jt&&lt.echoes===0?Dn===0?e():enqueueNativeMicroTask(e):setTimeout(e,0)}(""+Wt).indexOf("[native code]")===-1&&(wn=an=Be);var ye=V.reject,ft="￿",Kt="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",Pr="String expected.",Jn=[],Rr="__dbnames",sa="readonly",ua="readwrite";function Kn(e,t){return e?t?function(){return e.apply(this,arguments)&&t.apply(this,arguments)}:e:t}var ro={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function Dr(e){return typeof e!="string"||/\./.test(e)?function(t){return t}:function(t){return t[e]===void 0&&e in t&&delete(t=De(t))[e],t}}function ao(){throw S.Type()}function Ge(e,t){try{var n=oo(e),r=oo(t);if(n!==r)return n==="Array"?1:r==="Array"?-1:n==="binary"?1:r==="binary"?-1:n==="string"?1:r==="string"?-1:n==="Date"?1:r!=="Date"?NaN:-1;switch(n){case"number":case"Date":case"string":return t<e?1:e<t?-1:0;case"binary":return function(o,c){for(var g=o.length,p=c.length,y=g<p?g:p,w=0;w<y;++w)if(o[w]!==c[w])return o[w]<c[w]?-1:1;return g===p?0:g<p?-1:1}(io(e),io(t));case"Array":return function(o,c){for(var g=o.length,p=c.length,y=g<p?g:p,w=0;w<y;++w){var x=Ge(o[w],c[w]);if(x!==0)return x}return g===p?0:g<p?-1:1}(e,t)}}catch{}return NaN}function oo(e){var t=typeof e;return t!="object"?t:ArrayBuffer.isView(e)?"binary":(e=xe(e),e==="ArrayBuffer"?"binary":e)}function io(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e)}var so=(ot.prototype._trans=function(e,t,n){var r=this._tx||be.trans,o=this.name,c=xt&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(e==="readonly"?"read":"write"," ").concat(this.name));function g(w,x,_){if(!_.schema[o])throw new S.NotFound("Table "+o+" not part of transaction");return t(_.idbtrans,_)}var p=Pn();try{var y=r&&r.db._novip===this.db._novip?r===be.trans?r._promise(e,g,n):Ft(function(){return r._promise(e,g,n)},{trans:r,transless:be.transless||be}):function w(x,_,D,b){if(x.idbdb&&(x._state.openComplete||be.letThrough||x._vip)){var T=x._createTransaction(_,D,x._dbSchema);try{T.create(),x._state.PR1398_maxLoop=3}catch(R){return R.name===ut.InvalidState&&x.isOpen()&&0<--x._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),x.close({disableAutoOpen:!1}),x.open().then(function(){return w(x,_,D,b)})):ye(R)}return T._promise(_,function(R,E){return Ft(function(){return be.trans=T,b(R,E,T)})}).then(function(R){if(_==="readwrite")try{T.idbtrans.commit()}catch{}return _==="readonly"?R:T._completion.then(function(){return R})})}if(x._state.openComplete)return ye(new S.DatabaseClosed(x._state.dbOpenError));if(!x._state.isBeingOpened){if(!x._state.autoOpen)return ye(new S.DatabaseClosed);x.open().catch(Be)}return x._state.dbReadyPromise.then(function(){return w(x,_,D,b)})}(this.db,e,[this.name],g);return c&&(y._consoleTask=c,y=y.catch(function(w){return console.trace(w),ye(w)})),y}finally{p&&Rn()}},ot.prototype.get=function(e,t){var n=this;return e&&e.constructor===Object?this.where(e).first(t):e==null?ye(new S.Type("Invalid argument to Table.get()")):this._trans("readonly",function(r){return n.core.get({trans:r,key:e}).then(function(o){return n.hook.reading.fire(o)})}).then(t)},ot.prototype.where=function(e){if(typeof e=="string")return new this.db.WhereClause(this,e);if(P(e))return new this.db.WhereClause(this,"[".concat(e.join("+"),"]"));var t=f(e);if(t.length===1)return this.where(t[0]).equals(e[t[0]]);var n=this.schema.indexes.concat(this.schema.primKey).filter(function(p){if(p.compound&&t.every(function(w){return 0<=p.keyPath.indexOf(w)})){for(var y=0;y<t.length;++y)if(t.indexOf(p.keyPath[y])===-1)return!1;return!0}return!1}).sort(function(p,y){return p.keyPath.length-y.keyPath.length})[0];if(n&&this.db._maxKey!==ft){var c=n.keyPath.slice(0,t.length);return this.where(c).equals(c.map(function(y){return e[y]}))}!n&&xt&&console.warn("The query ".concat(JSON.stringify(e)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(t.join("+"),"]"));var r=this.schema.idxByName;function o(p,y){return Ge(p,y)===0}var g=t.reduce(function(_,y){var w=_[0],x=_[1],_=r[y],D=e[y];return[w||_,w||!_?Kn(x,_&&_.multi?function(b){return b=Q(b,y),P(b)&&b.some(function(T){return o(D,T)})}:function(b){return o(D,Q(b,y))}):x]},[null,null]),c=g[0],g=g[1];return c?this.where(c.name).equals(e[c.keyPath]).filter(g):n?this.filter(g):this.where(t).equals("")},ot.prototype.filter=function(e){return this.toCollection().and(e)},ot.prototype.count=function(e){return this.toCollection().count(e)},ot.prototype.offset=function(e){return this.toCollection().offset(e)},ot.prototype.limit=function(e){return this.toCollection().limit(e)},ot.prototype.each=function(e){return this.toCollection().each(e)},ot.prototype.toArray=function(e){return this.toCollection().toArray(e)},ot.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},ot.prototype.orderBy=function(e){return new this.db.Collection(new this.db.WhereClause(this,P(e)?"[".concat(e.join("+"),"]"):e))},ot.prototype.reverse=function(){return this.toCollection().reverse()},ot.prototype.mapToClass=function(e){var t,n=this.db,r=this.name;function o(){return t!==null&&t.apply(this,arguments)||this}(this.schema.mappedClass=e).prototype instanceof ao&&(function(y,w){if(typeof w!="function"&&w!==null)throw new TypeError("Class extends value "+String(w)+" is not a constructor or null");function x(){this.constructor=y}i(y,w),y.prototype=w===null?Object.create(w):(x.prototype=w.prototype,new x)}(o,t=e),Object.defineProperty(o.prototype,"db",{get:function(){return n},enumerable:!1,configurable:!0}),o.prototype.table=function(){return r},e=o);for(var c=new Set,g=e.prototype;g;g=k(g))Object.getOwnPropertyNames(g).forEach(function(y){return c.add(y)});function p(y){if(!y)return y;var w,x=Object.create(e.prototype);for(w in y)if(!c.has(w))try{x[w]=y[w]}catch{}return x}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=p,this.hook("reading",p),e},ot.prototype.defineClass=function(){return this.mapToClass(function(e){N(this,e)})},ot.prototype.add=function(e,t){var n=this,r=this.schema.primKey,o=r.auto,c=r.keyPath,g=e;return c&&o&&(g=Dr(c)(e)),this._trans("readwrite",function(p){return n.core.mutate({trans:p,type:"add",keys:t!=null?[t]:null,values:[g]})}).then(function(p){return p.numFailures?V.reject(p.failures[0]):p.lastResult}).then(function(p){if(c)try{K(e,c,p)}catch{}return p})},ot.prototype.update=function(e,t){return typeof e!="object"||P(e)?this.where(":id").equals(e).modify(t):(e=Q(e,this.schema.primKey.keyPath),e===void 0?ye(new S.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(e).modify(t))},ot.prototype.put=function(e,t){var n=this,r=this.schema.primKey,o=r.auto,c=r.keyPath,g=e;return c&&o&&(g=Dr(c)(e)),this._trans("readwrite",function(p){return n.core.mutate({trans:p,type:"put",values:[g],keys:t!=null?[t]:null})}).then(function(p){return p.numFailures?V.reject(p.failures[0]):p.lastResult}).then(function(p){if(c)try{K(e,c,p)}catch{}return p})},ot.prototype.delete=function(e){var t=this;return this._trans("readwrite",function(n){return t.core.mutate({trans:n,type:"delete",keys:[e]})}).then(function(n){return n.numFailures?V.reject(n.failures[0]):void 0})},ot.prototype.clear=function(){var e=this;return this._trans("readwrite",function(t){return e.core.mutate({trans:t,type:"deleteRange",range:ro})}).then(function(t){return t.numFailures?V.reject(t.failures[0]):void 0})},ot.prototype.bulkGet=function(e){var t=this;return this._trans("readonly",function(n){return t.core.getMany({keys:e,trans:n}).then(function(r){return r.map(function(o){return t.hook.reading.fire(o)})})})},ot.prototype.bulkAdd=function(e,t,n){var r=this,o=Array.isArray(t)?t:void 0,c=(n=n||(o?void 0:t))?n.allKeys:void 0;return this._trans("readwrite",function(g){var w=r.schema.primKey,p=w.auto,w=w.keyPath;if(w&&o)throw new S.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(o&&o.length!==e.length)throw new S.InvalidArgument("Arguments objects and keys must have the same length");var y=e.length,w=w&&p?e.map(Dr(w)):e;return r.core.mutate({trans:g,type:"add",keys:o,values:w,wantResults:c}).then(function(T){var _=T.numFailures,D=T.results,b=T.lastResult,T=T.failures;if(_===0)return c?D:b;throw new tt("".concat(r.name,".bulkAdd(): ").concat(_," of ").concat(y," operations failed"),T)})})},ot.prototype.bulkPut=function(e,t,n){var r=this,o=Array.isArray(t)?t:void 0,c=(n=n||(o?void 0:t))?n.allKeys:void 0;return this._trans("readwrite",function(g){var w=r.schema.primKey,p=w.auto,w=w.keyPath;if(w&&o)throw new S.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(o&&o.length!==e.length)throw new S.InvalidArgument("Arguments objects and keys must have the same length");var y=e.length,w=w&&p?e.map(Dr(w)):e;return r.core.mutate({trans:g,type:"put",keys:o,values:w,wantResults:c}).then(function(T){var _=T.numFailures,D=T.results,b=T.lastResult,T=T.failures;if(_===0)return c?D:b;throw new tt("".concat(r.name,".bulkPut(): ").concat(_," of ").concat(y," operations failed"),T)})})},ot.prototype.bulkUpdate=function(e){var t=this,n=this.core,r=e.map(function(g){return g.key}),o=e.map(function(g){return g.changes}),c=[];return this._trans("readwrite",function(g){return n.getMany({trans:g,keys:r,cache:"clone"}).then(function(p){var y=[],w=[];e.forEach(function(_,D){var b=_.key,T=_.changes,R=p[D];if(R){for(var E=0,I=Object.keys(T);E<I.length;E++){var U=I[E],F=T[U];if(U===t.schema.primKey.keyPath){if(Ge(F,b)!==0)throw new S.Constraint("Cannot update primary key in bulkUpdate()")}else K(R,U,F)}c.push(D),y.push(b),w.push(R)}});var x=y.length;return n.mutate({trans:g,type:"put",keys:y,values:w,updates:{keys:r,changeSpecs:o}}).then(function(_){var D=_.numFailures,b=_.failures;if(D===0)return x;for(var T=0,R=Object.keys(b);T<R.length;T++){var E,I=R[T],U=c[Number(I)];U!=null&&(E=b[I],delete b[I],b[U]=E)}throw new tt("".concat(t.name,".bulkUpdate(): ").concat(D," of ").concat(x," operations failed"),b)})})})},ot.prototype.bulkDelete=function(e){var t=this,n=e.length;return this._trans("readwrite",function(r){return t.core.mutate({trans:r,type:"delete",keys:e})}).then(function(g){var o=g.numFailures,c=g.lastResult,g=g.failures;if(o===0)return c;throw new tt("".concat(t.name,".bulkDelete(): ").concat(o," of ").concat(n," operations failed"),g)})},ot);function ot(){}function lr(e){function t(g,p){if(p){for(var y=arguments.length,w=new Array(y-1);--y;)w[y-1]=arguments[y];return n[g].subscribe.apply(null,w),e}if(typeof g=="string")return n[g]}var n={};t.addEventType=c;for(var r=1,o=arguments.length;r<o;++r)c(arguments[r]);return t;function c(g,p,y){if(typeof g!="object"){var w;p=p||J;var x={subscribers:[],fire:y=y||Be,subscribe:function(_){x.subscribers.indexOf(_)===-1&&(x.subscribers.push(_),x.fire=p(x.fire,_))},unsubscribe:function(_){x.subscribers=x.subscribers.filter(function(D){return D!==_}),x.fire=x.subscribers.reduce(p,y)}};return n[g]=t[g]=x}f(w=g).forEach(function(_){var D=w[_];if(P(D))c(_,w[_][0],w[_][1]);else{if(D!=="asap")throw new S.InvalidArgument("Invalid event config");var b=c(_,vt,function(){for(var T=arguments.length,R=new Array(T);T--;)R[T]=arguments[T];b.subscribers.forEach(function(E){Y(function(){E.apply(null,R)})})})}})}}function fr(e,t){return j(t).from({prototype:e}),t}function er(e,t){return!(e.filter||e.algorithm||e.or)&&(t?e.justLimit:!e.replayFilter)}function ca(e,t){e.filter=Kn(e.filter,t)}function la(e,t,n){var r=e.replayFilter;e.replayFilter=r?function(){return Kn(r(),t())}:t,e.justLimit=n&&!r}function Or(e,t){if(e.isPrimKey)return t.primaryKey;var n=t.getIndexByKeyPath(e.index);if(!n)throw new S.Schema("KeyPath "+e.index+" on object store "+t.name+" is not indexed");return n}function uo(e,t,n){var r=Or(e,t.schema);return t.openCursor({trans:n,values:!e.keysOnly,reverse:e.dir==="prev",unique:!!e.unique,query:{index:r,range:e.range}})}function Mr(e,t,n,r){var o=e.replayFilter?Kn(e.filter,e.replayFilter()):e.filter;if(e.or){var c={},g=function(p,y,w){var x,_;o&&!o(y,w,function(D){return y.stop(D)},function(D){return y.fail(D)})||((_=""+(x=y.primaryKey))=="[object ArrayBuffer]"&&(_=""+new Uint8Array(x)),C(c,_)||(c[_]=!0,t(p,y,w)))};return Promise.all([e.or._iterate(g,n),co(uo(e,r,n),e.algorithm,g,!e.keysOnly&&e.valueMapper)])}return co(uo(e,r,n),Kn(e.algorithm,o),t,!e.keysOnly&&e.valueMapper)}function co(e,t,n,r){var o=rt(r?function(c,g,p){return n(r(c),g,p)}:n);return e.then(function(c){if(c)return c.start(function(){var g=function(){return c.continue()};t&&!t(c,function(p){return g=p},function(p){c.stop(p),g=Be},function(p){c.fail(p),g=Be})||o(c.value,c,function(p){return g=p}),g()})})}var dr=(lo.prototype.execute=function(e){var t=this["@@propmod"];if(t.add!==void 0){var n=t.add;if(P(n))return a(a([],P(e)?e:[],!0),n).sort();if(typeof n=="number")return(Number(e)||0)+n;if(typeof n=="bigint")try{return BigInt(e)+n}catch{return BigInt(0)+n}throw new TypeError("Invalid term ".concat(n))}if(t.remove!==void 0){var r=t.remove;if(P(r))return P(e)?e.filter(function(o){return!r.includes(o)}).sort():[];if(typeof r=="number")return Number(e)-r;if(typeof r=="bigint")try{return BigInt(e)-r}catch{return BigInt(0)-r}throw new TypeError("Invalid subtrahend ".concat(r))}return n=(n=t.replacePrefix)===null||n===void 0?void 0:n[0],n&&typeof e=="string"&&e.startsWith(n)?t.replacePrefix[1]+e.substring(n.length):e},lo);function lo(e){this["@@propmod"]=e}var Us=(ze.prototype._read=function(e,t){var n=this._ctx;return n.error?n.table._trans(null,ye.bind(null,n.error)):n.table._trans("readonly",e).then(t)},ze.prototype._write=function(e){var t=this._ctx;return t.error?t.table._trans(null,ye.bind(null,t.error)):t.table._trans("readwrite",e,"locked")},ze.prototype._addAlgorithm=function(e){var t=this._ctx;t.algorithm=Kn(t.algorithm,e)},ze.prototype._iterate=function(e,t){return Mr(this._ctx,e,t,this._ctx.table.core)},ze.prototype.clone=function(e){var t=Object.create(this.constructor.prototype),n=Object.create(this._ctx);return e&&N(n,e),t._ctx=n,t},ze.prototype.raw=function(){return this._ctx.valueMapper=null,this},ze.prototype.each=function(e){var t=this._ctx;return this._read(function(n){return Mr(t,e,n,t.table.core)})},ze.prototype.count=function(e){var t=this;return this._read(function(n){var r=t._ctx,o=r.table.core;if(er(r,!0))return o.count({trans:n,query:{index:Or(r,o.schema),range:r.range}}).then(function(g){return Math.min(g,r.limit)});var c=0;return Mr(r,function(){return++c,!1},n,o).then(function(){return c})}).then(e)},ze.prototype.sortBy=function(e,t){var n=e.split(".").reverse(),r=n[0],o=n.length-1;function c(y,w){return w?c(y[n[w]],w-1):y[r]}var g=this._ctx.dir==="next"?1:-1;function p(y,w){return Ge(c(y,o),c(w,o))*g}return this.toArray(function(y){return y.sort(p)}).then(t)},ze.prototype.toArray=function(e){var t=this;return this._read(function(n){var r=t._ctx;if(r.dir==="next"&&er(r,!0)&&0<r.limit){var o=r.valueMapper,c=Or(r,r.table.core.schema);return r.table.core.query({trans:n,limit:r.limit,values:!0,query:{index:c,range:r.range}}).then(function(p){return p=p.result,o?p.map(o):p})}var g=[];return Mr(r,function(p){return g.push(p)},n,r.table.core).then(function(){return g})},e)},ze.prototype.offset=function(e){var t=this._ctx;return e<=0||(t.offset+=e,er(t)?la(t,function(){var n=e;return function(r,o){return n===0||(n===1?--n:o(function(){r.advance(n),n=0}),!1)}}):la(t,function(){var n=e;return function(){return--n<0}})),this},ze.prototype.limit=function(e){return this._ctx.limit=Math.min(this._ctx.limit,e),la(this._ctx,function(){var t=e;return function(n,r,o){return--t<=0&&r(o),0<=t}},!0),this},ze.prototype.until=function(e,t){return ca(this._ctx,function(n,r,o){return!e(n.value)||(r(o),t)}),this},ze.prototype.first=function(e){return this.limit(1).toArray(function(t){return t[0]}).then(e)},ze.prototype.last=function(e){return this.reverse().first(e)},ze.prototype.filter=function(e){var t;return ca(this._ctx,function(n){return e(n.value)}),(t=this._ctx).isMatch=Kn(t.isMatch,e),this},ze.prototype.and=function(e){return this.filter(e)},ze.prototype.or=function(e){return new this.db.WhereClause(this._ctx.table,e,this)},ze.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},ze.prototype.desc=function(){return this.reverse()},ze.prototype.eachKey=function(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each(function(n,r){e(r.key,r)})},ze.prototype.eachUniqueKey=function(e){return this._ctx.unique="unique",this.eachKey(e)},ze.prototype.eachPrimaryKey=function(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each(function(n,r){e(r.primaryKey,r)})},ze.prototype.keys=function(e){var t=this._ctx;t.keysOnly=!t.isMatch;var n=[];return this.each(function(r,o){n.push(o.key)}).then(function(){return n}).then(e)},ze.prototype.primaryKeys=function(e){var t=this._ctx;if(t.dir==="next"&&er(t,!0)&&0<t.limit)return this._read(function(r){var o=Or(t,t.table.core.schema);return t.table.core.query({trans:r,values:!1,limit:t.limit,query:{index:o,range:t.range}})}).then(function(r){return r.result}).then(e);t.keysOnly=!t.isMatch;var n=[];return this.each(function(r,o){n.push(o.primaryKey)}).then(function(){return n}).then(e)},ze.prototype.uniqueKeys=function(e){return this._ctx.unique="unique",this.keys(e)},ze.prototype.firstKey=function(e){return this.limit(1).keys(function(t){return t[0]}).then(e)},ze.prototype.lastKey=function(e){return this.reverse().firstKey(e)},ze.prototype.distinct=function(){var e=this._ctx,e=e.index&&e.table.schema.idxByName[e.index];if(!e||!e.multi)return this;var t={};return ca(this._ctx,function(o){var r=o.primaryKey.toString(),o=C(t,r);return t[r]=!0,!o}),this},ze.prototype.modify=function(e){var t=this,n=this._ctx;return this._write(function(r){var o,c,g;g=typeof e=="function"?e:(o=f(e),c=o.length,function(E){for(var I=!1,U=0;U<c;++U){var F=o[U],W=e[F],oe=Q(E,F);W instanceof dr?(K(E,F,W.execute(oe)),I=!0):oe!==W&&(K(E,F,W),I=!0)}return I});var p=n.table.core,_=p.schema.primaryKey,y=_.outbound,w=_.extractKey,x=200,_=t.db._options.modifyChunkSize;_&&(x=typeof _=="object"?_[p.name]||_["*"]||200:_);function D(E,F){var U=F.failures,F=F.numFailures;T+=E-F;for(var W=0,oe=f(U);W<oe.length;W++){var fe=oe[W];b.push(U[fe])}}var b=[],T=0,R=[];return t.clone().primaryKeys().then(function(E){function I(F){var W=Math.min(x,E.length-F);return p.getMany({trans:r,keys:E.slice(F,F+W),cache:"immutable"}).then(function(oe){for(var fe=[],ie=[],ue=y?[]:null,de=[],le=0;le<W;++le){var ve=oe[le],$e={value:De(ve),primKey:E[F+le]};g.call($e,$e.value,$e)!==!1&&($e.value==null?de.push(E[F+le]):y||Ge(w(ve),w($e.value))===0?(ie.push($e.value),y&&ue.push(E[F+le])):(de.push(E[F+le]),fe.push($e.value)))}return Promise.resolve(0<fe.length&&p.mutate({trans:r,type:"add",values:fe}).then(function(Ke){for(var Ve in Ke.failures)de.splice(parseInt(Ve),1);D(fe.length,Ke)})).then(function(){return(0<ie.length||U&&typeof e=="object")&&p.mutate({trans:r,type:"put",keys:ue,values:ie,criteria:U,changeSpec:typeof e!="function"&&e,isAdditionalChunk:0<F}).then(function(Ke){return D(ie.length,Ke)})}).then(function(){return(0<de.length||U&&e===fa)&&p.mutate({trans:r,type:"delete",keys:de,criteria:U,isAdditionalChunk:0<F}).then(function(Ke){return D(de.length,Ke)})}).then(function(){return E.length>F+W&&I(F+x)})})}var U=er(n)&&n.limit===1/0&&(typeof e!="function"||e===fa)&&{index:n.index,range:n.range};return I(0).then(function(){if(0<b.length)throw new Ce("Error modifying one or more objects",b,T,R);return E.length})})})},ze.prototype.delete=function(){var e=this._ctx,t=e.range;return er(e)&&(e.isPrimKey||t.type===3)?this._write(function(n){var r=e.table.core.schema.primaryKey,o=t;return e.table.core.count({trans:n,query:{index:r,range:o}}).then(function(c){return e.table.core.mutate({trans:n,type:"deleteRange",range:o}).then(function(g){var p=g.failures;if(g.lastResult,g.results,g=g.numFailures,g)throw new Ce("Could not delete some values",Object.keys(p).map(function(y){return p[y]}),c-g);return c-g})})}):this.modify(fa)},ze);function ze(){}var fa=function(e,t){return t.value=null};function Fs(e,t){return e<t?-1:e===t?0:1}function Bs(e,t){return t<e?-1:e===t?0:1}function Vt(e,t,n){return e=e instanceof go?new e.Collection(e):e,e._ctx.error=new(n||TypeError)(t),e}function tr(e){return new e.Collection(e,function(){return fo("")}).limit(0)}function kr(e,t,n,r){var o,c,g,p,y,w,x,_=n.length;if(!n.every(function(T){return typeof T=="string"}))return Vt(e,Pr);function D(T){o=T==="next"?function(E){return E.toUpperCase()}:function(E){return E.toLowerCase()},c=T==="next"?function(E){return E.toLowerCase()}:function(E){return E.toUpperCase()},g=T==="next"?Fs:Bs;var R=n.map(function(E){return{lower:c(E),upper:o(E)}}).sort(function(E,I){return g(E.lower,I.lower)});p=R.map(function(E){return E.upper}),y=R.map(function(E){return E.lower}),x=(w=T)==="next"?"":r}D("next"),e=new e.Collection(e,function(){return On(p[0],y[_-1]+r)}),e._ondirectionchange=function(T){D(T)};var b=0;return e._addAlgorithm(function(T,R,E){var I=T.key;if(typeof I!="string")return!1;var U=c(I);if(t(U,y,b))return!0;for(var F=null,W=b;W<_;++W){var oe=function(fe,ie,ue,de,le,ve){for(var $e=Math.min(fe.length,de.length),Ke=-1,Ve=0;Ve<$e;++Ve){var Ht=ie[Ve];if(Ht!==de[Ve])return le(fe[Ve],ue[Ve])<0?fe.substr(0,Ve)+ue[Ve]+ue.substr(Ve+1):le(fe[Ve],de[Ve])<0?fe.substr(0,Ve)+de[Ve]+ue.substr(Ve+1):0<=Ke?fe.substr(0,Ke)+ie[Ke]+ue.substr(Ke+1):null;le(fe[Ve],Ht)<0&&(Ke=Ve)}return $e<de.length&&ve==="next"?fe+ue.substr(fe.length):$e<fe.length&&ve==="prev"?fe.substr(0,ue.length):Ke<0?null:fe.substr(0,Ke)+de[Ke]+ue.substr(Ke+1)}(I,U,p[W],y[W],g,w);oe===null&&F===null?b=W+1:(F===null||0<g(F,oe))&&(F=oe)}return R(F!==null?function(){T.continue(F+x)}:E),!1}),e}function On(e,t,n,r){return{type:2,lower:e,upper:t,lowerOpen:n,upperOpen:r}}function fo(e){return{type:1,lower:e,upper:e}}var go=(Object.defineProperty(_t.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),_t.prototype.between=function(e,t,n,r){n=n!==!1,r=r===!0;try{return 0<this._cmp(e,t)||this._cmp(e,t)===0&&(n||r)&&(!n||!r)?tr(this):new this.Collection(this,function(){return On(e,t,!n,!r)})}catch{return Vt(this,Kt)}},_t.prototype.equals=function(e){return e==null?Vt(this,Kt):new this.Collection(this,function(){return fo(e)})},_t.prototype.above=function(e){return e==null?Vt(this,Kt):new this.Collection(this,function(){return On(e,void 0,!0)})},_t.prototype.aboveOrEqual=function(e){return e==null?Vt(this,Kt):new this.Collection(this,function(){return On(e,void 0,!1)})},_t.prototype.below=function(e){return e==null?Vt(this,Kt):new this.Collection(this,function(){return On(void 0,e,!1,!0)})},_t.prototype.belowOrEqual=function(e){return e==null?Vt(this,Kt):new this.Collection(this,function(){return On(void 0,e)})},_t.prototype.startsWith=function(e){return typeof e!="string"?Vt(this,Pr):this.between(e,e+ft,!0,!0)},_t.prototype.startsWithIgnoreCase=function(e){return e===""?this.startsWith(e):kr(this,function(t,n){return t.indexOf(n[0])===0},[e],ft)},_t.prototype.equalsIgnoreCase=function(e){return kr(this,function(t,n){return t===n[0]},[e],"")},_t.prototype.anyOfIgnoreCase=function(){var e=Se.apply(He,arguments);return e.length===0?tr(this):kr(this,function(t,n){return n.indexOf(t)!==-1},e,"")},_t.prototype.startsWithAnyOfIgnoreCase=function(){var e=Se.apply(He,arguments);return e.length===0?tr(this):kr(this,function(t,n){return n.some(function(r){return t.indexOf(r)===0})},e,ft)},_t.prototype.anyOf=function(){var e=this,t=Se.apply(He,arguments),n=this._cmp;try{t.sort(n)}catch{return Vt(this,Kt)}if(t.length===0)return tr(this);var r=new this.Collection(this,function(){return On(t[0],t[t.length-1])});r._ondirectionchange=function(c){n=c==="next"?e._ascending:e._descending,t.sort(n)};var o=0;return r._addAlgorithm(function(c,g,p){for(var y=c.key;0<n(y,t[o]);)if(++o===t.length)return g(p),!1;return n(y,t[o])===0||(g(function(){c.continue(t[o])}),!1)}),r},_t.prototype.notEqual=function(e){return this.inAnyRange([[-1/0,e],[e,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},_t.prototype.noneOf=function(){var e=Se.apply(He,arguments);if(e.length===0)return new this.Collection(this);try{e.sort(this._ascending)}catch{return Vt(this,Kt)}var t=e.reduce(function(n,r){return n?n.concat([[n[n.length-1][1],r]]):[[-1/0,r]]},null);return t.push([e[e.length-1],this.db._maxKey]),this.inAnyRange(t,{includeLowers:!1,includeUppers:!1})},_t.prototype.inAnyRange=function(I,t){var n=this,r=this._cmp,o=this._ascending,c=this._descending,g=this._min,p=this._max;if(I.length===0)return tr(this);if(!I.every(function(U){return U[0]!==void 0&&U[1]!==void 0&&o(U[0],U[1])<=0}))return Vt(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",S.InvalidArgument);var y=!t||t.includeLowers!==!1,w=t&&t.includeUppers===!0,x,_=o;function D(U,F){return _(U[0],F[0])}try{(x=I.reduce(function(U,F){for(var W=0,oe=U.length;W<oe;++W){var fe=U[W];if(r(F[0],fe[1])<0&&0<r(F[1],fe[0])){fe[0]=g(fe[0],F[0]),fe[1]=p(fe[1],F[1]);break}}return W===oe&&U.push(F),U},[])).sort(D)}catch{return Vt(this,Kt)}var b=0,T=w?function(U){return 0<o(U,x[b][1])}:function(U){return 0<=o(U,x[b][1])},R=y?function(U){return 0<c(U,x[b][0])}:function(U){return 0<=c(U,x[b][0])},E=T,I=new this.Collection(this,function(){return On(x[0][0],x[x.length-1][1],!y,!w)});return I._ondirectionchange=function(U){_=U==="next"?(E=T,o):(E=R,c),x.sort(D)},I._addAlgorithm(function(U,F,W){for(var oe,fe=U.key;E(fe);)if(++b===x.length)return F(W),!1;return!T(oe=fe)&&!R(oe)||(n._cmp(fe,x[b][1])===0||n._cmp(fe,x[b][0])===0||F(function(){_===o?U.continue(x[b][0]):U.continue(x[b][1])}),!1)}),I},_t.prototype.startsWithAnyOf=function(){var e=Se.apply(He,arguments);return e.every(function(t){return typeof t=="string"})?e.length===0?tr(this):this.inAnyRange(e.map(function(t){return[t,t+ft]})):Vt(this,"startsWithAnyOf() only works with strings")},_t);function _t(){}function cn(e){return rt(function(t){return gr(t),e(t.target.error),!1})}function gr(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault()}var hr="storagemutated",da="x-storagemutated-1",Mn=lr(null,hr),Ks=(ln.prototype._lock=function(){return m(!be.global),++this._reculock,this._reculock!==1||be.global||(be.lockOwnerFor=this),this},ln.prototype._unlock=function(){if(m(!be.global),--this._reculock==0)for(be.global||(be.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var e=this._blockedFuncs.shift();try{on(e[1],e[0])}catch{}}return this},ln.prototype._locked=function(){return this._reculock&&be.lockOwnerFor!==this},ln.prototype.create=function(e){var t=this;if(!this.mode)return this;var n=this.db.idbdb,r=this.db._state.dbOpenError;if(m(!this.idbtrans),!e&&!n)switch(r&&r.name){case"DatabaseClosedError":throw new S.DatabaseClosed(r);case"MissingAPIError":throw new S.MissingAPI(r.message,r);default:throw new S.OpenFailed(r)}if(!this.active)throw new S.TransactionInactive;return m(this._completion._state===null),(e=this.idbtrans=e||(this.db.core||n).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=rt(function(o){gr(o),t._reject(e.error)}),e.onabort=rt(function(o){gr(o),t.active&&t._reject(new S.Abort(e.error)),t.active=!1,t.on("abort").fire(o)}),e.oncomplete=rt(function(){t.active=!1,t._resolve(),"mutatedParts"in e&&Mn.storagemutated.fire(e.mutatedParts)}),this},ln.prototype._promise=function(e,t,n){var r=this;if(e==="readwrite"&&this.mode!=="readwrite")return ye(new S.ReadOnly("Transaction is readonly"));if(!this.active)return ye(new S.TransactionInactive);if(this._locked())return new V(function(c,g){r._blockedFuncs.push([function(){r._promise(e,t,n).then(c,g)},be])});if(n)return Ft(function(){var c=new V(function(g,p){r._lock();var y=t(g,p,r);y&&y.then&&y.then(g,p)});return c.finally(function(){return r._unlock()}),c._lib=!0,c});var o=new V(function(c,g){var p=t(c,g,r);p&&p.then&&p.then(c,g)});return o._lib=!0,o},ln.prototype._root=function(){return this.parent?this.parent._root():this},ln.prototype.waitFor=function(e){var t,n=this._root(),r=V.resolve(e);n._waitingFor?n._waitingFor=n._waitingFor.then(function(){return r}):(n._waitingFor=r,n._waitingQueue=[],t=n.idbtrans.objectStore(n.storeNames[0]),function c(){for(++n._spinCount;n._waitingQueue.length;)n._waitingQueue.shift()();n._waitingFor&&(t.get(-1/0).onsuccess=c)}());var o=n._waitingFor;return new V(function(c,g){r.then(function(p){return n._waitingQueue.push(rt(c.bind(null,p)))},function(p){return n._waitingQueue.push(rt(g.bind(null,p)))}).finally(function(){n._waitingFor===o&&(n._waitingFor=null)})})},ln.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new S.Abort))},ln.prototype.table=function(e){var t=this._memoizedTables||(this._memoizedTables={});if(C(t,e))return t[e];var n=this.schema[e];if(!n)throw new S.NotFound("Table "+e+" not part of transaction");return n=new this.db.Table(e,n,this),n.core=this.db.core.table(e),t[e]=n},ln);function ln(){}function ga(e,t,n,r,o,c,g){return{name:e,keyPath:t,unique:n,multi:r,auto:o,compound:c,src:(n&&!g?"&":"")+(r?"*":"")+(o?"++":"")+ho(t)}}function ho(e){return typeof e=="string"?e:e?"["+[].join.call(e,"+")+"]":""}function ha(e,t,n){return{name:e,primKey:t,indexes:n,mappedClass:null,idxByName:(r=function(o){return[o.name,o]},n.reduce(function(o,c,g){return g=r(c,g),g&&(o[g[0]]=g[1]),o},{}))};var r}var vr=function(e){try{return e.only([[]]),vr=function(){return[[]]},[[]]}catch{return vr=function(){return ft},ft}};function va(e){return e==null?function(){}:typeof e=="string"?(t=e).split(".").length===1?function(n){return n[t]}:function(n){return Q(n,t)}:function(n){return Q(n,e)};var t}function vo(e){return[].slice.call(e)}var Vs=0;function pr(e){return e==null?":id":typeof e=="string"?e:"[".concat(e.join("+"),"]")}function Hs(e,t,y){function r(E){if(E.type===3)return null;if(E.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var b=E.lower,T=E.upper,R=E.lowerOpen,E=E.upperOpen;return b===void 0?T===void 0?null:t.upperBound(T,!!E):T===void 0?t.lowerBound(b,!!R):t.bound(b,T,!!R,!!E)}function o(D){var b,T=D.name;return{name:T,schema:D,mutate:function(R){var E=R.trans,I=R.type,U=R.keys,F=R.values,W=R.range;return new Promise(function(oe,fe){oe=rt(oe);var ie=E.objectStore(T),ue=ie.keyPath==null,de=I==="put"||I==="add";if(!de&&I!=="delete"&&I!=="deleteRange")throw new Error("Invalid operation type: "+I);var le,ve=(U||F||{length:1}).length;if(U&&F&&U.length!==F.length)throw new Error("Given keys array must have same length as given values array.");if(ve===0)return oe({numFailures:0,failures:{},results:[],lastResult:void 0});function $e(Pt){++Ht,gr(Pt)}var Ke=[],Ve=[],Ht=0;if(I==="deleteRange"){if(W.type===4)return oe({numFailures:Ht,failures:Ve,results:[],lastResult:void 0});W.type===3?Ke.push(le=ie.clear()):Ke.push(le=ie.delete(r(W)))}else{var ue=de?ue?[F,U]:[F,null]:[U,null],Ne=ue[0],wt=ue[1];if(de)for(var Et=0;Et<ve;++Et)Ke.push(le=wt&&wt[Et]!==void 0?ie[I](Ne[Et],wt[Et]):ie[I](Ne[Et])),le.onerror=$e;else for(Et=0;Et<ve;++Et)Ke.push(le=ie[I](Ne[Et])),le.onerror=$e}function jr(Pt){Pt=Pt.target.result,Ke.forEach(function(Gn,Ca){return Gn.error!=null&&(Ve[Ca]=Gn.error)}),oe({numFailures:Ht,failures:Ve,results:I==="delete"?U:Ke.map(function(Gn){return Gn.result}),lastResult:Pt})}le.onerror=function(Pt){$e(Pt),jr(Pt)},le.onsuccess=jr})},getMany:function(R){var E=R.trans,I=R.keys;return new Promise(function(U,F){U=rt(U);for(var W,oe=E.objectStore(T),fe=I.length,ie=new Array(fe),ue=0,de=0,le=function(Ke){Ke=Ke.target,ie[Ke._pos]=Ke.result,++de===ue&&U(ie)},ve=cn(F),$e=0;$e<fe;++$e)I[$e]!=null&&((W=oe.get(I[$e]))._pos=$e,W.onsuccess=le,W.onerror=ve,++ue);ue===0&&U(ie)})},get:function(R){var E=R.trans,I=R.key;return new Promise(function(U,F){U=rt(U);var W=E.objectStore(T).get(I);W.onsuccess=function(oe){return U(oe.target.result)},W.onerror=cn(F)})},query:(b=w,function(R){return new Promise(function(E,I){E=rt(E);var U,F,W,ue=R.trans,oe=R.values,fe=R.limit,le=R.query,ie=fe===1/0?void 0:fe,de=le.index,le=le.range,ue=ue.objectStore(T),de=de.isPrimaryKey?ue:ue.index(de.name),le=r(le);if(fe===0)return E({result:[]});b?((ie=oe?de.getAll(le,ie):de.getAllKeys(le,ie)).onsuccess=function(ve){return E({result:ve.target.result})},ie.onerror=cn(I)):(U=0,F=!oe&&"openKeyCursor"in de?de.openKeyCursor(le):de.openCursor(le),W=[],F.onsuccess=function(ve){var $e=F.result;return $e?(W.push(oe?$e.value:$e.primaryKey),++U===fe?E({result:W}):void $e.continue()):E({result:W})},F.onerror=cn(I))})}),openCursor:function(R){var E=R.trans,I=R.values,U=R.query,F=R.reverse,W=R.unique;return new Promise(function(oe,fe){oe=rt(oe);var de=U.index,ie=U.range,ue=E.objectStore(T),ue=de.isPrimaryKey?ue:ue.index(de.name),de=F?W?"prevunique":"prev":W?"nextunique":"next",le=!I&&"openKeyCursor"in ue?ue.openKeyCursor(r(ie),de):ue.openCursor(r(ie),de);le.onerror=cn(fe),le.onsuccess=rt(function(ve){var $e,Ke,Ve,Ht,Ne=le.result;Ne?(Ne.___id=++Vs,Ne.done=!1,$e=Ne.continue.bind(Ne),Ke=(Ke=Ne.continuePrimaryKey)&&Ke.bind(Ne),Ve=Ne.advance.bind(Ne),Ht=function(){throw new Error("Cursor not stopped")},Ne.trans=E,Ne.stop=Ne.continue=Ne.continuePrimaryKey=Ne.advance=function(){throw new Error("Cursor not started")},Ne.fail=rt(fe),Ne.next=function(){var wt=this,Et=1;return this.start(function(){return Et--?wt.continue():wt.stop()}).then(function(){return wt})},Ne.start=function(wt){function Et(){if(le.result)try{wt()}catch(Pt){Ne.fail(Pt)}else Ne.done=!0,Ne.start=function(){throw new Error("Cursor behind last entry")},Ne.stop()}var jr=new Promise(function(Pt,Gn){Pt=rt(Pt),le.onerror=cn(Gn),Ne.fail=Gn,Ne.stop=function(Ca){Ne.stop=Ne.continue=Ne.continuePrimaryKey=Ne.advance=Ht,Pt(Ca)}});return le.onsuccess=rt(function(Pt){le.onsuccess=Et,Et()}),Ne.continue=$e,Ne.continuePrimaryKey=Ke,Ne.advance=Ve,Et(),jr},oe(Ne)):oe(null)},fe)})},count:function(R){var E=R.query,I=R.trans,U=E.index,F=E.range;return new Promise(function(W,oe){var fe=I.objectStore(T),ie=U.isPrimaryKey?fe:fe.index(U.name),fe=r(F),ie=fe?ie.count(fe):ie.count();ie.onsuccess=rt(function(ue){return W(ue.target.result)}),ie.onerror=cn(oe)})}}}var c,g,p,x=(g=y,p=vo((c=e).objectStoreNames),{schema:{name:c.name,tables:p.map(function(D){return g.objectStore(D)}).map(function(D){var b=D.keyPath,E=D.autoIncrement,T=P(b),R={},E={name:D.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:b==null,compound:T,keyPath:b,autoIncrement:E,unique:!0,extractKey:va(b)},indexes:vo(D.indexNames).map(function(I){return D.index(I)}).map(function(W){var U=W.name,F=W.unique,oe=W.multiEntry,W=W.keyPath,oe={name:U,compound:P(W),keyPath:W,unique:F,multiEntry:oe,extractKey:va(W)};return R[pr(W)]=oe}),getIndexByKeyPath:function(I){return R[pr(I)]}};return R[":id"]=E.primaryKey,b!=null&&(R[pr(b)]=E.primaryKey),E})},hasGetAll:0<p.length&&"getAll"in g.objectStore(p[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}),y=x.schema,w=x.hasGetAll,x=y.tables.map(o),_={};return x.forEach(function(D){return _[D.name]=D}),{stack:"dbcore",transaction:e.transaction.bind(e),table:function(D){if(!_[D])throw new Error("Table '".concat(D,"' not found"));return _[D]},MIN_KEY:-1/0,MAX_KEY:vr(t),schema:y}}function Gs(e,t,n,r){var o=n.IDBKeyRange;return n.indexedDB,{dbcore:(r=Hs(t,o,r),e.dbcore.reduce(function(c,g){return g=g.create,h(h({},c),g(c))},r))}}function Cr(e,r){var n=r.db,r=Gs(e._middlewares,n,e._deps,r);e.core=r.dbcore,e.tables.forEach(function(o){var c=o.name;e.core.schema.tables.some(function(g){return g.name===c})&&(o.core=e.core.table(c),e[c]instanceof e.Table&&(e[c].core=o.core))})}function Nr(e,t,n,r){n.forEach(function(o){var c=r[o];t.forEach(function(g){var p=function y(w,x){return L(w,x)||(w=k(w))&&y(w,x)}(g,o);(!p||"value"in p&&p.value===void 0)&&(g===e.Transaction.prototype||g instanceof e.Transaction?$(g,o,{get:function(){return this.table(o)},set:function(y){B(this,o,{value:y,writable:!0,configurable:!0,enumerable:!0})}}):g[o]=new e.Table(o,c))})})}function pa(e,t){t.forEach(function(n){for(var r in n)n[r]instanceof e.Table&&delete n[r]})}function js(e,t){return e._cfg.version-t._cfg.version}function Ws(e,t,n,r){var o=e._dbSchema;n.objectStoreNames.contains("$meta")&&!o.$meta&&(o.$meta=ha("$meta",mo("")[0],[]),e._storeNames.push("$meta"));var c=e._createTransaction("readwrite",e._storeNames,o);c.create(n),c._completion.catch(r);var g=c._reject.bind(c),p=be.transless||be;Ft(function(){return be.trans=c,be.transless=p,t!==0?(Cr(e,n),w=t,((y=c).storeNames.includes("$meta")?y.table("$meta").get("version").then(function(x){return x??w}):V.resolve(w)).then(function(x){return D=x,b=c,T=n,R=[],x=(_=e)._versions,E=_._dbSchema=$r(0,_.idbdb,T),(x=x.filter(function(I){return I._cfg.version>=D})).length!==0?(x.forEach(function(I){R.push(function(){var U=E,F=I._cfg.dbschema;Lr(_,U,T),Lr(_,F,T),E=_._dbSchema=F;var W=ma(U,F);W.add.forEach(function(de){_a(T,de[0],de[1].primKey,de[1].indexes)}),W.change.forEach(function(de){if(de.recreate)throw new S.Upgrade("Not yet support for changing primary key");var le=T.objectStore(de.name);de.add.forEach(function(ve){return Ir(le,ve)}),de.change.forEach(function(ve){le.deleteIndex(ve.name),Ir(le,ve)}),de.del.forEach(function(ve){return le.deleteIndex(ve)})});var oe=I._cfg.contentUpgrade;if(oe&&I._cfg.version>D){Cr(_,T),b._memoizedTables={};var fe=Z(F);W.del.forEach(function(de){fe[de]=U[de]}),pa(_,[_.Transaction.prototype]),Nr(_,[_.Transaction.prototype],f(fe),fe),b.schema=fe;var ie,ue=Oe(oe);return ue&&wn(),W=V.follow(function(){var de;(ie=oe(b))&&ue&&(de=an.bind(null,null),ie.then(de,de))}),ie&&typeof ie.then=="function"?V.resolve(ie):W.then(function(){return ie})}}),R.push(function(U){var F,W,oe=I._cfg.dbschema;F=oe,W=U,[].slice.call(W.db.objectStoreNames).forEach(function(fe){return F[fe]==null&&W.db.deleteObjectStore(fe)}),pa(_,[_.Transaction.prototype]),Nr(_,[_.Transaction.prototype],_._storeNames,_._dbSchema),b.schema=_._dbSchema}),R.push(function(U){_.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(_.idbdb.version/10)===I._cfg.version?(_.idbdb.deleteObjectStore("$meta"),delete _._dbSchema.$meta,_._storeNames=_._storeNames.filter(function(F){return F!=="$meta"})):U.objectStore("$meta").put(I._cfg.version,"version"))})}),function I(){return R.length?V.resolve(R.shift()(b.idbtrans)).then(I):V.resolve()}().then(function(){po(E,T)})):V.resolve();var _,D,b,T,R,E}).catch(g)):(f(o).forEach(function(x){_a(n,x,o[x].primKey,o[x].indexes)}),Cr(e,n),void V.follow(function(){return e.on.populate.fire(c)}).catch(g));var y,w})}function qs(e,t){po(e._dbSchema,t),t.db.version%10!=0||t.objectStoreNames.contains("$meta")||t.db.createObjectStore("$meta").add(Math.ceil(t.db.version/10-1),"version");var n=$r(0,e.idbdb,t);Lr(e,e._dbSchema,t);for(var r=0,o=ma(n,e._dbSchema).change;r<o.length;r++){var c=function(g){if(g.change.length||g.recreate)return console.warn("Unable to patch indexes of table ".concat(g.name," because it has changes on the type of index or primary key.")),{value:void 0};var p=t.objectStore(g.name);g.add.forEach(function(y){xt&&console.debug("Dexie upgrade patch: Creating missing index ".concat(g.name,".").concat(y.src)),Ir(p,y)})}(o[r]);if(typeof c=="object")return c.value}}function ma(e,t){var n,r={del:[],add:[],change:[]};for(n in e)t[n]||r.del.push(n);for(n in t){var o=e[n],c=t[n];if(o){var g={name:n,def:c,recreate:!1,del:[],add:[],change:[]};if(""+(o.primKey.keyPath||"")!=""+(c.primKey.keyPath||"")||o.primKey.auto!==c.primKey.auto)g.recreate=!0,r.change.push(g);else{var p=o.idxByName,y=c.idxByName,w=void 0;for(w in p)y[w]||g.del.push(w);for(w in y){var x=p[w],_=y[w];x?x.src!==_.src&&g.change.push(_):g.add.push(_)}(0<g.del.length||0<g.add.length||0<g.change.length)&&r.change.push(g)}}else r.add.push([n,c])}return r}function _a(e,t,n,r){var o=e.db.createObjectStore(t,n.keyPath?{keyPath:n.keyPath,autoIncrement:n.auto}:{autoIncrement:n.auto});return r.forEach(function(c){return Ir(o,c)}),o}function po(e,t){f(e).forEach(function(n){t.db.objectStoreNames.contains(n)||(xt&&console.debug("Dexie: Creating missing table",n),_a(t,n,e[n].primKey,e[n].indexes))})}function Ir(e,t){e.createIndex(t.name,t.keyPath,{unique:t.unique,multiEntry:t.multi})}function $r(e,t,n){var r={};return X(t.objectStoreNames,0).forEach(function(o){for(var c=n.objectStore(o),g=ga(ho(w=c.keyPath),w||"",!0,!1,!!c.autoIncrement,w&&typeof w!="string",!0),p=[],y=0;y<c.indexNames.length;++y){var x=c.index(c.indexNames[y]),w=x.keyPath,x=ga(x.name,w,!!x.unique,!!x.multiEntry,!1,w&&typeof w!="string",!1);p.push(x)}r[o]=ha(o,g,p)}),r}function Lr(e,t,n){for(var r=n.db.objectStoreNames,o=0;o<r.length;++o){var c=r[o],g=n.objectStore(c);e._hasGetAll="getAll"in g;for(var p=0;p<g.indexNames.length;++p){var y=g.indexNames[p],w=g.index(y).keyPath,x=typeof w=="string"?w:"["+X(w).join("+")+"]";!t[c]||(w=t[c].idxByName[x])&&(w.name=y,delete t[c].idxByName[x],t[c].idxByName[y]=w)}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&l.WorkerGlobalScope&&l instanceof l.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(e._hasGetAll=!1)}function mo(e){return e.split(",").map(function(t,n){var r=(t=t.trim()).replace(/([&*]|\+\+)/g,""),o=/^\[/.test(r)?r.match(/^\[(.*)\]$/)[1].split("+"):r;return ga(r,o||null,/\&/.test(t),/\*/.test(t),/\+\+/.test(t),P(o),n===0)})}var zs=(Ur.prototype._parseStoresSpec=function(e,t){f(e).forEach(function(n){if(e[n]!==null){var r=mo(e[n]),o=r.shift();if(o.unique=!0,o.multi)throw new S.Schema("Primary key cannot be multi-valued");r.forEach(function(c){if(c.auto)throw new S.Schema("Only primary key can be marked as autoIncrement (++)");if(!c.keyPath)throw new S.Schema("Index must have a name and cannot be an empty string")}),t[n]=ha(n,o,r)}})},Ur.prototype.stores=function(n){var t=this.db;this._cfg.storesSource=this._cfg.storesSource?N(this._cfg.storesSource,n):n;var n=t._versions,r={},o={};return n.forEach(function(c){N(r,c._cfg.storesSource),o=c._cfg.dbschema={},c._parseStoresSpec(r,o)}),t._dbSchema=o,pa(t,[t._allTables,t,t.Transaction.prototype]),Nr(t,[t._allTables,t,t.Transaction.prototype,this._cfg.tables],f(o),o),t._storeNames=f(o),this},Ur.prototype.upgrade=function(e){return this._cfg.contentUpgrade=yt(this._cfg.contentUpgrade||Be,e),this},Ur);function Ur(){}function ya(e,t){var n=e._dbNamesDB;return n||(n=e._dbNamesDB=new En(Rr,{addons:[],indexedDB:e,IDBKeyRange:t})).version(1).stores({dbnames:"name"}),n.table("dbnames")}function ba(e){return e&&typeof e.databases=="function"}function wa(e){return Ft(function(){return be.letThrough=!0,e()})}function Ea(e){return!("from"in e)}var bt=function(e,t){if(!this){var n=new bt;return e&&"d"in e&&N(n,e),n}N(this,arguments.length?{d:1,from:e,to:1<arguments.length?t:e}:{d:0})};function mr(e,t,n){var r=Ge(t,n);if(!isNaN(r)){if(0<r)throw RangeError();if(Ea(e))return N(e,{from:t,to:n,d:1});var o=e.l,r=e.r;if(Ge(n,e.from)<0)return o?mr(o,t,n):e.l={from:t,to:n,d:1,l:null,r:null},yo(e);if(0<Ge(t,e.to))return r?mr(r,t,n):e.r={from:t,to:n,d:1,l:null,r:null},yo(e);Ge(t,e.from)<0&&(e.from=t,e.l=null,e.d=r?r.d+1:1),0<Ge(n,e.to)&&(e.to=n,e.r=null,e.d=e.l?e.l.d+1:1),n=!e.r,o&&!e.l&&_r(e,o),r&&n&&_r(e,r)}}function _r(e,t){Ea(t)||function n(r,y){var c=y.from,g=y.to,p=y.l,y=y.r;mr(r,c,g),p&&n(r,p),y&&n(r,y)}(e,t)}function _o(e,t){var n=Fr(t),r=n.next();if(r.done)return!1;for(var o=r.value,c=Fr(e),g=c.next(o.from),p=g.value;!r.done&&!g.done;){if(Ge(p.from,o.to)<=0&&0<=Ge(p.to,o.from))return!0;Ge(o.from,p.from)<0?o=(r=n.next(p.from)).value:p=(g=c.next(o.from)).value}return!1}function Fr(e){var t=Ea(e)?null:{s:0,n:e};return{next:function(n){for(var r=0<arguments.length;t;)switch(t.s){case 0:if(t.s=1,r)for(;t.n.l&&Ge(n,t.n.from)<0;)t={up:t,n:t.n.l,s:1};else for(;t.n.l;)t={up:t,n:t.n.l,s:1};case 1:if(t.s=2,!r||Ge(n,t.n.to)<=0)return{value:t.n,done:!1};case 2:if(t.n.r){t.s=3,t={up:t,n:t.n.r,s:0};continue}case 3:t=t.up}return{done:!0}}}}function yo(e){var t,n,r=(((t=e.r)===null||t===void 0?void 0:t.d)||0)-(((n=e.l)===null||n===void 0?void 0:n.d)||0),o=1<r?"r":r<-1?"l":"";o&&(t=o=="r"?"l":"r",n=h({},e),r=e[o],e.from=r.from,e.to=r.to,e[o]=r[o],n[o]=r[t],(e[t]=n).d=bo(n)),e.d=bo(e)}function bo(n){var t=n.r,n=n.l;return(t?n?Math.max(t.d,n.d):t.d:n?n.d:0)+1}function Br(e,t){return f(t).forEach(function(n){e[n]?_r(e[n],t[n]):e[n]=function r(o){var c,g,p={};for(c in o)C(o,c)&&(g=o[c],p[c]=!g||typeof g!="object"||Pe.has(g.constructor)?g:r(g));return p}(t[n])}),e}function Sa(e,t){return e.all||t.all||Object.keys(e).some(function(n){return t[n]&&_o(t[n],e[n])})}O(bt.prototype,((Wt={add:function(e){return _r(this,e),this},addKey:function(e){return mr(this,e,e),this},addKeys:function(e){var t=this;return e.forEach(function(n){return mr(t,n,n)}),this},hasKey:function(e){var t=Fr(this).next(e).value;return t&&Ge(t.from,e)<=0&&0<=Ge(t.to,e)}})[Ue]=function(){return Fr(this)},Wt));var Vn={},Ta={},xa=!1;function Kr(e){Br(Ta,e),xa||(xa=!0,setTimeout(function(){xa=!1,Aa(Ta,!(Ta={}))},0))}function Aa(e,t){t===void 0&&(t=!1);var n=new Set;if(e.all)for(var r=0,o=Object.values(Vn);r<o.length;r++)wo(g=o[r],e,n,t);else for(var c in e){var g,p=/^idb\:\/\/(.*)\/(.*)\//.exec(c);p&&(c=p[1],p=p[2],(g=Vn["idb://".concat(c,"/").concat(p)])&&wo(g,e,n,t))}n.forEach(function(y){return y()})}function wo(e,t,n,r){for(var o=[],c=0,g=Object.entries(e.queries.query);c<g.length;c++){for(var p=g[c],y=p[0],w=[],x=0,_=p[1];x<_.length;x++){var D=_[x];Sa(t,D.obsSet)?D.subscribers.forEach(function(E){return n.add(E)}):r&&w.push(D)}r&&o.push([y,w])}if(r)for(var b=0,T=o;b<T.length;b++){var R=T[b],y=R[0],w=R[1];e.queries.query[y]=w}}function Ys(e){var t=e._state,n=e._deps.indexedDB;if(t.isBeingOpened||e.idbdb)return t.dbReadyPromise.then(function(){return t.dbOpenError?ye(t.dbOpenError):e});t.isBeingOpened=!0,t.dbOpenError=null,t.openComplete=!1;var r=t.openCanceller,o=Math.round(10*e.verno),c=!1;function g(){if(t.openCanceller!==r)throw new S.DatabaseClosed("db.open() was cancelled")}function p(){return new V(function(D,b){if(g(),!n)throw new S.MissingAPI;var T=e.name,R=t.autoSchema||!o?n.open(T):n.open(T,o);if(!R)throw new S.MissingAPI;R.onerror=cn(b),R.onblocked=rt(e._fireOnBlocked),R.onupgradeneeded=rt(function(E){var I;x=R.transaction,t.autoSchema&&!e._options.allowEmptyDB?(R.onerror=gr,x.abort(),R.result.close(),(I=n.deleteDatabase(T)).onsuccess=I.onerror=rt(function(){b(new S.NoSuchDatabase("Database ".concat(T," doesnt exist")))})):(x.onerror=cn(b),E=E.oldVersion>Math.pow(2,62)?0:E.oldVersion,_=E<1,e.idbdb=R.result,c&&qs(e,x),Ws(e,E/10,x,b))},b),R.onsuccess=rt(function(){x=null;var E,I,U,F,W,oe=e.idbdb=R.result,fe=X(oe.objectStoreNames);if(0<fe.length)try{var ie=oe.transaction((F=fe).length===1?F[0]:F,"readonly");if(t.autoSchema)I=oe,U=ie,(E=e).verno=I.version/10,U=E._dbSchema=$r(0,I,U),E._storeNames=X(I.objectStoreNames,0),Nr(E,[E._allTables],f(U),U);else if(Lr(e,e._dbSchema,ie),((W=ma($r(0,(W=e).idbdb,ie),W._dbSchema)).add.length||W.change.some(function(ue){return ue.add.length||ue.change.length}))&&!c)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),oe.close(),o=oe.version+1,c=!0,D(p());Cr(e,ie)}catch{}Jn.push(e),oe.onversionchange=rt(function(ue){t.vcFired=!0,e.on("versionchange").fire(ue)}),oe.onclose=rt(function(ue){e.on("close").fire(ue)}),_&&(W=e._deps,ie=T,oe=W.indexedDB,W=W.IDBKeyRange,ba(oe)||ie===Rr||ya(oe,W).put({name:ie}).catch(Be)),D()},b)}).catch(function(D){switch(D?.name){case"UnknownError":if(0<t.PR1398_maxLoop)return t.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),p();break;case"VersionError":if(0<o)return o=0,p()}return V.reject(D)})}var y,w=t.dbReadyResolve,x=null,_=!1;return V.race([r,(typeof navigator>"u"?V.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(D){function b(){return indexedDB.databases().finally(D)}y=setInterval(b,100),b()}).finally(function(){return clearInterval(y)}):Promise.resolve()).then(p)]).then(function(){return g(),t.onReadyBeingFired=[],V.resolve(wa(function(){return e.on.ready.fire(e.vip)})).then(function D(){if(0<t.onReadyBeingFired.length){var b=t.onReadyBeingFired.reduce(yt,Be);return t.onReadyBeingFired=[],V.resolve(wa(function(){return b(e.vip)})).then(D)}})}).finally(function(){t.openCanceller===r&&(t.onReadyBeingFired=null,t.isBeingOpened=!1)}).catch(function(D){t.dbOpenError=D;try{x&&x.abort()}catch{}return r===t.openCanceller&&e._close(),ye(D)}).finally(function(){t.openComplete=!0,w()}).then(function(){var D;return _&&(D={},e.tables.forEach(function(b){b.schema.indexes.forEach(function(T){T.name&&(D["idb://".concat(e.name,"/").concat(b.name,"/").concat(T.name)]=new bt(-1/0,[[[]]]))}),D["idb://".concat(e.name,"/").concat(b.name,"/")]=D["idb://".concat(e.name,"/").concat(b.name,"/:dels")]=new bt(-1/0,[[[]]])}),Mn(hr).fire(D),Aa(D,!0)),e})}function Pa(e){function t(c){return e.next(c)}var n=o(t),r=o(function(c){return e.throw(c)});function o(c){return function(y){var p=c(y),y=p.value;return p.done?y:y&&typeof y.then=="function"?y.then(n,r):P(y)?Promise.all(y).then(n,r):n(y)}}return o(t)()}function Vr(e,t,n){for(var r=P(e)?e.slice():[e],o=0;o<n;++o)r.push(t);return r}var Xs={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(e){return h(h({},e),{table:function(t){var n=e.table(t),r=n.schema,o={},c=[];function g(_,D,b){var T=pr(_),R=o[T]=o[T]||[],E=_==null?0:typeof _=="string"?1:_.length,I=0<D,I=h(h({},b),{name:I?"".concat(T,"(virtual-from:").concat(b.name,")"):b.name,lowLevelIndex:b,isVirtual:I,keyTail:D,keyLength:E,extractKey:va(_),unique:!I&&b.unique});return R.push(I),I.isPrimaryKey||c.push(I),1<E&&g(E===2?_[0]:_.slice(0,E-1),D+1,b),R.sort(function(U,F){return U.keyTail-F.keyTail}),I}t=g(r.primaryKey.keyPath,0,r.primaryKey),o[":id"]=[t];for(var p=0,y=r.indexes;p<y.length;p++){var w=y[p];g(w.keyPath,0,w)}function x(_){var D,b=_.query.index;return b.isVirtual?h(h({},_),{query:{index:b.lowLevelIndex,range:(D=_.query.range,b=b.keyTail,{type:D.type===1?2:D.type,lower:Vr(D.lower,D.lowerOpen?e.MAX_KEY:e.MIN_KEY,b),lowerOpen:!0,upper:Vr(D.upper,D.upperOpen?e.MIN_KEY:e.MAX_KEY,b),upperOpen:!0})}}):_}return h(h({},n),{schema:h(h({},r),{primaryKey:t,indexes:c,getIndexByKeyPath:function(_){return(_=o[pr(_)])&&_[0]}}),count:function(_){return n.count(x(_))},query:function(_){return n.query(x(_))},openCursor:function(_){var D=_.query.index,b=D.keyTail,T=D.isVirtual,R=D.keyLength;return T?n.openCursor(x(_)).then(function(I){return I&&E(I)}):n.openCursor(_);function E(I){return Object.create(I,{continue:{value:function(U){U!=null?I.continue(Vr(U,_.reverse?e.MAX_KEY:e.MIN_KEY,b)):_.unique?I.continue(I.key.slice(0,R).concat(_.reverse?e.MIN_KEY:e.MAX_KEY,b)):I.continue()}},continuePrimaryKey:{value:function(U,F){I.continuePrimaryKey(Vr(U,e.MAX_KEY,b),F)}},primaryKey:{get:function(){return I.primaryKey}},key:{get:function(){var U=I.key;return R===1?U[0]:U.slice(0,R)}},value:{get:function(){return I.value}}})}}})}})}};function Ra(e,t,n,r){return n=n||{},r=r||"",f(e).forEach(function(o){var c,g,p;C(t,o)?(c=e[o],g=t[o],typeof c=="object"&&typeof g=="object"&&c&&g?(p=xe(c))!==xe(g)?n[r+o]=t[o]:p==="Object"?Ra(c,g,n,r+o+"."):c!==g&&(n[r+o]=t[o]):c!==g&&(n[r+o]=t[o])):n[r+o]=void 0}),f(t).forEach(function(o){C(e,o)||(n[r+o]=t[o])}),n}function Da(e,t){return t.type==="delete"?t.keys:t.keys||t.values.map(e.extractKey)}var Qs={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(e){return h(h({},e),{table:function(t){var n=e.table(t),r=n.schema.primaryKey;return h(h({},n),{mutate:function(o){var c=be.trans,g=c.table(t).hook,p=g.deleting,y=g.creating,w=g.updating;switch(o.type){case"add":if(y.fire===Be)break;return c._promise("readwrite",function(){return x(o)},!0);case"put":if(y.fire===Be&&w.fire===Be)break;return c._promise("readwrite",function(){return x(o)},!0);case"delete":if(p.fire===Be)break;return c._promise("readwrite",function(){return x(o)},!0);case"deleteRange":if(p.fire===Be)break;return c._promise("readwrite",function(){return function _(D,b,T){return n.query({trans:D,values:!1,query:{index:r,range:b},limit:T}).then(function(R){var E=R.result;return x({type:"delete",keys:E,trans:D}).then(function(I){return 0<I.numFailures?Promise.reject(I.failures[0]):E.length<T?{failures:[],numFailures:0,lastResult:void 0}:_(D,h(h({},b),{lower:E[E.length-1],lowerOpen:!0}),T)})})}(o.trans,o.range,1e4)},!0)}return n.mutate(o);function x(_){var D,b,T,R=be.trans,E=_.keys||Da(r,_);if(!E)throw new Error("Keys missing");return(_=_.type==="add"||_.type==="put"?h(h({},_),{keys:E}):h({},_)).type!=="delete"&&(_.values=a([],_.values)),_.keys&&(_.keys=a([],_.keys)),D=n,T=E,((b=_).type==="add"?Promise.resolve([]):D.getMany({trans:b.trans,keys:T,cache:"immutable"})).then(function(I){var U=E.map(function(F,W){var oe,fe,ie,ue=I[W],de={onerror:null,onsuccess:null};return _.type==="delete"?p.fire.call(de,F,ue,R):_.type==="add"||ue===void 0?(oe=y.fire.call(de,F,_.values[W],R),F==null&&oe!=null&&(_.keys[W]=F=oe,r.outbound||K(_.values[W],r.keyPath,F))):(oe=Ra(ue,_.values[W]),(fe=w.fire.call(de,oe,F,ue,R))&&(ie=_.values[W],Object.keys(fe).forEach(function(le){C(ie,le)?ie[le]=fe[le]:K(ie,le,fe[le])}))),de});return n.mutate(_).then(function(F){for(var W=F.failures,oe=F.results,fe=F.numFailures,F=F.lastResult,ie=0;ie<E.length;++ie){var ue=(oe||E)[ie],de=U[ie];ue==null?de.onerror&&de.onerror(W[ie]):de.onsuccess&&de.onsuccess(_.type==="put"&&I[ie]?_.values[ie]:ue)}return{failures:W,results:oe,numFailures:fe,lastResult:F}}).catch(function(F){return U.forEach(function(W){return W.onerror&&W.onerror(F)}),Promise.reject(F)})})}}})}})}};function Eo(e,t,n){try{if(!t||t.keys.length<e.length)return null;for(var r=[],o=0,c=0;o<t.keys.length&&c<e.length;++o)Ge(t.keys[o],e[c])===0&&(r.push(n?De(t.values[o]):t.values[o]),++c);return r.length===e.length?r:null}catch{return null}}var Zs={stack:"dbcore",level:-1,create:function(e){return{table:function(t){var n=e.table(t);return h(h({},n),{getMany:function(r){if(!r.cache)return n.getMany(r);var o=Eo(r.keys,r.trans._cache,r.cache==="clone");return o?V.resolve(o):n.getMany(r).then(function(c){return r.trans._cache={keys:r.keys,values:r.cache==="clone"?De(c):c},c})},mutate:function(r){return r.type!=="add"&&(r.trans._cache=null),n.mutate(r)}})}}}};function So(e,t){return e.trans.mode==="readonly"&&!!e.subscr&&!e.trans.explicit&&e.trans.db._options.cache!=="disabled"&&!t.schema.primaryKey.outbound}function To(e,t){switch(e){case"query":return t.values&&!t.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var Js={stack:"dbcore",level:0,name:"Observability",create:function(e){var t=e.schema.name,n=new bt(e.MIN_KEY,e.MAX_KEY);return h(h({},e),{transaction:function(r,o,c){if(be.subscr&&o!=="readonly")throw new S.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(be.querier));return e.transaction(r,o,c)},table:function(r){var o=e.table(r),c=o.schema,g=c.primaryKey,_=c.indexes,p=g.extractKey,y=g.outbound,w=g.autoIncrement&&_.filter(function(b){return b.compound&&b.keyPath.includes(g.keyPath)}),x=h(h({},o),{mutate:function(b){function T(le){return le="idb://".concat(t,"/").concat(r,"/").concat(le),F[le]||(F[le]=new bt)}var R,E,I,U=b.trans,F=b.mutatedParts||(b.mutatedParts={}),W=T(""),oe=T(":dels"),fe=b.type,de=b.type==="deleteRange"?[b.range]:b.type==="delete"?[b.keys]:b.values.length<50?[Da(g,b).filter(function(le){return le}),b.values]:[],ie=de[0],ue=de[1],de=b.trans._cache;return P(ie)?(W.addKeys(ie),(de=fe==="delete"||ie.length===ue.length?Eo(ie,de):null)||oe.addKeys(ie),(de||ue)&&(R=T,E=de,I=ue,c.indexes.forEach(function(le){var ve=R(le.name||"");function $e(Ve){return Ve!=null?le.extractKey(Ve):null}function Ke(Ve){return le.multiEntry&&P(Ve)?Ve.forEach(function(Ht){return ve.addKey(Ht)}):ve.addKey(Ve)}(E||I).forEach(function(Ve,wt){var Ne=E&&$e(E[wt]),wt=I&&$e(I[wt]);Ge(Ne,wt)!==0&&(Ne!=null&&Ke(Ne),wt!=null&&Ke(wt))})}))):ie?(ue={from:(ue=ie.lower)!==null&&ue!==void 0?ue:e.MIN_KEY,to:(ue=ie.upper)!==null&&ue!==void 0?ue:e.MAX_KEY},oe.add(ue),W.add(ue)):(W.add(n),oe.add(n),c.indexes.forEach(function(le){return T(le.name).add(n)})),o.mutate(b).then(function(le){return!ie||b.type!=="add"&&b.type!=="put"||(W.addKeys(le.results),w&&w.forEach(function(ve){for(var $e=b.values.map(function(Ne){return ve.extractKey(Ne)}),Ke=ve.keyPath.findIndex(function(Ne){return Ne===g.keyPath}),Ve=0,Ht=le.results.length;Ve<Ht;++Ve)$e[Ve][Ke]=le.results[Ve];T(ve.name).addKeys($e)})),U.mutatedParts=Br(U.mutatedParts||{},F),le})}}),_=function(T){var R=T.query,T=R.index,R=R.range;return[T,new bt((T=R.lower)!==null&&T!==void 0?T:e.MIN_KEY,(R=R.upper)!==null&&R!==void 0?R:e.MAX_KEY)]},D={get:function(b){return[g,new bt(b.key)]},getMany:function(b){return[g,new bt().addKeys(b.keys)]},count:_,query:_,openCursor:_};return f(D).forEach(function(b){x[b]=function(T){var R=be.subscr,E=!!R,I=So(be,o)&&To(b,T)?T.obsSet={}:R;if(E){var U=function(ue){return ue="idb://".concat(t,"/").concat(r,"/").concat(ue),I[ue]||(I[ue]=new bt)},F=U(""),W=U(":dels"),R=D[b](T),E=R[0],R=R[1];if((b==="query"&&E.isPrimaryKey&&!T.values?W:U(E.name||"")).add(R),!E.isPrimaryKey){if(b!=="count"){var oe=b==="query"&&y&&T.values&&o.query(h(h({},T),{values:!1}));return o[b].apply(this,arguments).then(function(ue){if(b==="query"){if(y&&T.values)return oe.then(function($e){return $e=$e.result,F.addKeys($e),ue});var de=T.values?ue.result.map(p):ue.result;(T.values?F:W).addKeys(de)}else if(b==="openCursor"){var le=ue,ve=T.values;return le&&Object.create(le,{key:{get:function(){return W.addKey(le.primaryKey),le.key}},primaryKey:{get:function(){var $e=le.primaryKey;return W.addKey($e),$e}},value:{get:function(){return ve&&F.addKey(le.primaryKey),le.value}}})}return ue})}W.add(n)}}return o[b].apply(this,arguments)}}),x}})}};function xo(e,t,n){if(n.numFailures===0)return t;if(t.type==="deleteRange")return null;var r=t.keys?t.keys.length:"values"in t&&t.values?t.values.length:1;return n.numFailures===r?null:(t=h({},t),P(t.keys)&&(t.keys=t.keys.filter(function(o,c){return!(c in n.failures)})),"values"in t&&P(t.values)&&(t.values=t.values.filter(function(o,c){return!(c in n.failures)})),t)}function Oa(e,t){return n=e,((r=t).lower===void 0||(r.lowerOpen?0<Ge(n,r.lower):0<=Ge(n,r.lower)))&&(e=e,(t=t).upper===void 0||(t.upperOpen?Ge(e,t.upper)<0:Ge(e,t.upper)<=0));var n,r}function Ao(e,t,D,r,o,c){if(!D||D.length===0)return e;var g=t.query.index,p=g.multiEntry,y=t.query.range,w=r.schema.primaryKey.extractKey,x=g.extractKey,_=(g.lowLevelIndex||g).extractKey,D=D.reduce(function(b,T){var R=b,E=[];if(T.type==="add"||T.type==="put")for(var I=new bt,U=T.values.length-1;0<=U;--U){var F,W=T.values[U],oe=w(W);I.hasKey(oe)||(F=x(W),(p&&P(F)?F.some(function(le){return Oa(le,y)}):Oa(F,y))&&(I.addKey(oe),E.push(W)))}switch(T.type){case"add":var fe=new bt().addKeys(t.values?b.map(function(ve){return w(ve)}):b),R=b.concat(t.values?E.filter(function(ve){return ve=w(ve),!fe.hasKey(ve)&&(fe.addKey(ve),!0)}):E.map(function(ve){return w(ve)}).filter(function(ve){return!fe.hasKey(ve)&&(fe.addKey(ve),!0)}));break;case"put":var ie=new bt().addKeys(T.values.map(function(ve){return w(ve)}));R=b.filter(function(ve){return!ie.hasKey(t.values?w(ve):ve)}).concat(t.values?E:E.map(function(ve){return w(ve)}));break;case"delete":var ue=new bt().addKeys(T.keys);R=b.filter(function(ve){return!ue.hasKey(t.values?w(ve):ve)});break;case"deleteRange":var de=T.range;R=b.filter(function(ve){return!Oa(w(ve),de)})}return R},e);return D===e?e:(D.sort(function(b,T){return Ge(_(b),_(T))||Ge(w(b),w(T))}),t.limit&&t.limit<1/0&&(D.length>t.limit?D.length=t.limit:e.length===t.limit&&D.length<t.limit&&(o.dirty=!0)),c?Object.freeze(D):D)}function Po(e,t){return Ge(e.lower,t.lower)===0&&Ge(e.upper,t.upper)===0&&!!e.lowerOpen==!!t.lowerOpen&&!!e.upperOpen==!!t.upperOpen}function eu(e,t){return function(n,r,o,c){if(n===void 0)return r!==void 0?-1:0;if(r===void 0)return 1;if((r=Ge(n,r))===0){if(o&&c)return 0;if(o)return 1;if(c)return-1}return r}(e.lower,t.lower,e.lowerOpen,t.lowerOpen)<=0&&0<=function(n,r,o,c){if(n===void 0)return r!==void 0?1:0;if(r===void 0)return-1;if((r=Ge(n,r))===0){if(o&&c)return 0;if(o)return-1;if(c)return 1}return r}(e.upper,t.upper,e.upperOpen,t.upperOpen)}function tu(e,t,n,r){e.subscribers.add(n),r.addEventListener("abort",function(){var o,c;e.subscribers.delete(n),e.subscribers.size===0&&(o=e,c=t,setTimeout(function(){o.subscribers.size===0&&Ee(c,o)},3e3))})}var nu={stack:"dbcore",level:0,name:"Cache",create:function(e){var t=e.schema.name;return h(h({},e),{transaction:function(n,r,o){var c,g,p=e.transaction(n,r,o);return r==="readwrite"&&(g=(c=new AbortController).signal,o=function(y){return function(){if(c.abort(),r==="readwrite"){for(var w=new Set,x=0,_=n;x<_.length;x++){var D=_[x],b=Vn["idb://".concat(t,"/").concat(D)];if(b){var T=e.table(D),R=b.optimisticOps.filter(function(ve){return ve.trans===p});if(p._explicit&&y&&p.mutatedParts)for(var E=0,I=Object.values(b.queries.query);E<I.length;E++)for(var U=0,F=(fe=I[E]).slice();U<F.length;U++)Sa((ie=F[U]).obsSet,p.mutatedParts)&&(Ee(fe,ie),ie.subscribers.forEach(function(ve){return w.add(ve)}));else if(0<R.length){b.optimisticOps=b.optimisticOps.filter(function(ve){return ve.trans!==p});for(var W=0,oe=Object.values(b.queries.query);W<oe.length;W++)for(var fe,ie,ue,de=0,le=(fe=oe[W]).slice();de<le.length;de++)(ie=le[de]).res!=null&&p.mutatedParts&&(y&&!ie.dirty?(ue=Object.isFrozen(ie.res),ue=Ao(ie.res,ie.req,R,T,ie,ue),ie.dirty?(Ee(fe,ie),ie.subscribers.forEach(function(ve){return w.add(ve)})):ue!==ie.res&&(ie.res=ue,ie.promise=V.resolve({result:ue}))):(ie.dirty&&Ee(fe,ie),ie.subscribers.forEach(function(ve){return w.add(ve)})))}}}w.forEach(function(ve){return ve()})}}},p.addEventListener("abort",o(!1),{signal:g}),p.addEventListener("error",o(!1),{signal:g}),p.addEventListener("complete",o(!0),{signal:g})),p},table:function(n){var r=e.table(n),o=r.schema.primaryKey;return h(h({},r),{mutate:function(c){var g=be.trans;if(o.outbound||g.db._options.cache==="disabled"||g.explicit||g.idbtrans.mode!=="readwrite")return r.mutate(c);var p=Vn["idb://".concat(t,"/").concat(n)];return p?(g=r.mutate(c),c.type!=="add"&&c.type!=="put"||!(50<=c.values.length||Da(o,c).some(function(y){return y==null}))?(p.optimisticOps.push(c),c.mutatedParts&&Kr(c.mutatedParts),g.then(function(y){0<y.numFailures&&(Ee(p.optimisticOps,c),(y=xo(0,c,y))&&p.optimisticOps.push(y),c.mutatedParts&&Kr(c.mutatedParts))}),g.catch(function(){Ee(p.optimisticOps,c),c.mutatedParts&&Kr(c.mutatedParts)})):g.then(function(y){var w=xo(0,h(h({},c),{values:c.values.map(function(x,_){var D;return y.failures[_]?x:(x=(D=o.keyPath)!==null&&D!==void 0&&D.includes(".")?De(x):h({},x),K(x,o.keyPath,y.results[_]),x)})}),y);p.optimisticOps.push(w),queueMicrotask(function(){return c.mutatedParts&&Kr(c.mutatedParts)})}),g):r.mutate(c)},query:function(c){if(!So(be,r)||!To("query",c))return r.query(c);var g=((w=be.trans)===null||w===void 0?void 0:w.db._options.cache)==="immutable",_=be,p=_.requery,y=_.signal,w=function(T,R,E,I){var U=Vn["idb://".concat(T,"/").concat(R)];if(!U)return[];if(!(R=U.queries[E]))return[null,!1,U,null];var F=R[(I.query?I.query.index.name:null)||""];if(!F)return[null,!1,U,null];switch(E){case"query":var W=F.find(function(oe){return oe.req.limit===I.limit&&oe.req.values===I.values&&Po(oe.req.query.range,I.query.range)});return W?[W,!0,U,F]:[F.find(function(oe){return("limit"in oe.req?oe.req.limit:1/0)>=I.limit&&(!I.values||oe.req.values)&&eu(oe.req.query.range,I.query.range)}),!1,U,F];case"count":return W=F.find(function(oe){return Po(oe.req.query.range,I.query.range)}),[W,!!W,U,F]}}(t,n,"query",c),x=w[0],_=w[1],D=w[2],b=w[3];return x&&_?x.obsSet=c.obsSet:(_=r.query(c).then(function(T){var R=T.result;if(x&&(x.res=R),g){for(var E=0,I=R.length;E<I;++E)Object.freeze(R[E]);Object.freeze(R)}else T.result=De(R);return T}).catch(function(T){return b&&x&&Ee(b,x),Promise.reject(T)}),x={obsSet:c.obsSet,promise:_,subscribers:new Set,type:"query",req:c,dirty:!1},b?b.push(x):(b=[x],(D=D||(Vn["idb://".concat(t,"/").concat(n)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[c.query.index.name||""]=b)),tu(x,b,p,y),x.promise.then(function(T){return{result:Ao(T.result,c,D?.optimisticOps,r,x,g)}})}})}})}};function Hr(e,t){return new Proxy(e,{get:function(n,r,o){return r==="db"?t:Reflect.get(n,r,o)}})}var En=(ct.prototype.version=function(e){if(isNaN(e)||e<.1)throw new S.Type("Given version is not a positive number");if(e=Math.round(10*e)/10,this.idbdb||this._state.isBeingOpened)throw new S.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,e);var t=this._versions,n=t.filter(function(r){return r._cfg.version===e})[0];return n||(n=new this.Version(e),t.push(n),t.sort(js),n.stores({}),this._state.autoSchema=!1,n)},ct.prototype._whenReady=function(e){var t=this;return this.idbdb&&(this._state.openComplete||be.letThrough||this._vip)?e():new V(function(n,r){if(t._state.openComplete)return r(new S.DatabaseClosed(t._state.dbOpenError));if(!t._state.isBeingOpened){if(!t._state.autoOpen)return void r(new S.DatabaseClosed);t.open().catch(Be)}t._state.dbReadyPromise.then(n,r)}).then(e)},ct.prototype.use=function(e){var t=e.stack,n=e.create,r=e.level,o=e.name;return o&&this.unuse({stack:t,name:o}),e=this._middlewares[t]||(this._middlewares[t]=[]),e.push({stack:t,create:n,level:r??10,name:o}),e.sort(function(c,g){return c.level-g.level}),this},ct.prototype.unuse=function(e){var t=e.stack,n=e.name,r=e.create;return t&&this._middlewares[t]&&(this._middlewares[t]=this._middlewares[t].filter(function(o){return r?o.create!==r:!!n&&o.name!==n})),this},ct.prototype.open=function(){var e=this;return on(Ut,function(){return Ys(e)})},ct.prototype._close=function(){var e=this._state,t=Jn.indexOf(this);if(0<=t&&Jn.splice(t,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}e.isBeingOpened||(e.dbReadyPromise=new V(function(n){e.dbReadyResolve=n}),e.openCanceller=new V(function(n,r){e.cancelOpen=r}))},ct.prototype.close=function(n){var t=(n===void 0?{disableAutoOpen:!0}:n).disableAutoOpen,n=this._state;t?(n.isBeingOpened&&n.cancelOpen(new S.DatabaseClosed),this._close(),n.autoOpen=!1,n.dbOpenError=new S.DatabaseClosed):(this._close(),n.autoOpen=this._options.autoOpen||n.isBeingOpened,n.openComplete=!1,n.dbOpenError=null)},ct.prototype.delete=function(e){var t=this;e===void 0&&(e={disableAutoOpen:!0});var n=0<arguments.length&&typeof arguments[0]!="object",r=this._state;return new V(function(o,c){function g(){t.close(e);var p=t._deps.indexedDB.deleteDatabase(t.name);p.onsuccess=rt(function(){var y,w,x;y=t._deps,w=t.name,x=y.indexedDB,y=y.IDBKeyRange,ba(x)||w===Rr||ya(x,y).delete(w).catch(Be),o()}),p.onerror=cn(c),p.onblocked=t._fireOnBlocked}if(n)throw new S.InvalidArgument("Invalid closeOptions argument to db.delete()");r.isBeingOpened?r.dbReadyPromise.then(g):g()})},ct.prototype.backendDB=function(){return this.idbdb},ct.prototype.isOpen=function(){return this.idbdb!==null},ct.prototype.hasBeenClosed=function(){var e=this._state.dbOpenError;return e&&e.name==="DatabaseClosed"},ct.prototype.hasFailed=function(){return this._state.dbOpenError!==null},ct.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(ct.prototype,"tables",{get:function(){var e=this;return f(this._allTables).map(function(t){return e._allTables[t]})},enumerable:!1,configurable:!0}),ct.prototype.transaction=function(){var e=(function(t,n,r){var o=arguments.length;if(o<2)throw new S.InvalidArgument("Too few arguments");for(var c=new Array(o-1);--o;)c[o-1]=arguments[o];return r=c.pop(),[t,Te(c),r]}).apply(this,arguments);return this._transaction.apply(this,e)},ct.prototype._transaction=function(e,t,n){var r=this,o=be.trans;o&&o.db===this&&e.indexOf("!")===-1||(o=null);var c,g,p=e.indexOf("?")!==-1;e=e.replace("!","").replace("?","");try{if(g=t.map(function(w){if(w=w instanceof r.Table?w.name:w,typeof w!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return w}),e=="r"||e===sa)c=sa;else{if(e!="rw"&&e!=ua)throw new S.InvalidArgument("Invalid transaction mode: "+e);c=ua}if(o){if(o.mode===sa&&c===ua){if(!p)throw new S.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");o=null}o&&g.forEach(function(w){if(o&&o.storeNames.indexOf(w)===-1){if(!p)throw new S.SubTransaction("Table "+w+" not included in parent transaction.");o=null}}),p&&o&&!o.active&&(o=null)}}catch(w){return o?o._promise(null,function(x,_){_(w)}):ye(w)}var y=(function w(x,_,D,b,T){return V.resolve().then(function(){var R=be.transless||be,E=x._createTransaction(_,D,x._dbSchema,b);if(E.explicit=!0,R={trans:E,transless:R},b)E.idbtrans=b.idbtrans;else try{E.create(),E.idbtrans._explicit=!0,x._state.PR1398_maxLoop=3}catch(F){return F.name===ut.InvalidState&&x.isOpen()&&0<--x._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),x.close({disableAutoOpen:!1}),x.open().then(function(){return w(x,_,D,null,T)})):ye(F)}var I,U=Oe(T);return U&&wn(),R=V.follow(function(){var F;(I=T.call(E,E))&&(U?(F=an.bind(null,null),I.then(F,F)):typeof I.next=="function"&&typeof I.throw=="function"&&(I=Pa(I)))},R),(I&&typeof I.then=="function"?V.resolve(I).then(function(F){return E.active?F:ye(new S.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):R.then(function(){return I})).then(function(F){return b&&E._resolve(),E._completion.then(function(){return F})}).catch(function(F){return E._reject(F),ye(F)})})}).bind(null,this,c,g,o,n);return o?o._promise(c,y,"lock"):be.trans?on(be.transless,function(){return r._whenReady(y)}):this._whenReady(y)},ct.prototype.table=function(e){if(!C(this._allTables,e))throw new S.InvalidTable("Table ".concat(e," does not exist"));return this._allTables[e]},ct);function ct(e,t){var n=this;this._middlewares={},this.verno=0;var r=ct.dependencies;this._options=t=h({addons:ct.addons,autoOpen:!0,indexedDB:r.indexedDB,IDBKeyRange:r.IDBKeyRange,cache:"cloned"},t),this._deps={indexedDB:t.indexedDB,IDBKeyRange:t.IDBKeyRange},r=t.addons,this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var o,c,g,p,y,w={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:Be,dbReadyPromise:null,cancelOpen:Be,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:t.autoOpen};w.dbReadyPromise=new V(function(_){w.dbReadyResolve=_}),w.openCanceller=new V(function(_,D){w.cancelOpen=D}),this._state=w,this.name=e,this.on=lr(this,"populate","blocked","versionchange","close",{ready:[yt,Be]}),this.on.ready.subscribe=q(this.on.ready.subscribe,function(_){return function(D,b){ct.vip(function(){var T,R=n._state;R.openComplete?(R.dbOpenError||V.resolve().then(D),b&&_(D)):R.onReadyBeingFired?(R.onReadyBeingFired.push(D),b&&_(D)):(_(D),T=n,b||_(function E(){T.on.ready.unsubscribe(D),T.on.ready.unsubscribe(E)}))})}}),this.Collection=(o=this,fr(Us.prototype,function(I,E){this.db=o;var b=ro,T=null;if(E)try{b=E()}catch(U){T=U}var R=I._ctx,E=R.table,I=E.hook.reading.fire;this._ctx={table:E,index:R.index,isPrimKey:!R.index||E.schema.primKey.keyPath&&R.index===E.schema.primKey.name,range:b,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:T,or:R.or,valueMapper:I!==vt?I:null}})),this.Table=(c=this,fr(so.prototype,function(_,D,b){this.db=c,this._tx=b,this.name=_,this.schema=D,this.hook=c._allTables[_]?c._allTables[_].hook:lr(null,{creating:[sn,Be],reading:[Jt,vt],updating:[se,Be],deleting:[en,Be]})})),this.Transaction=(g=this,fr(Ks.prototype,function(_,D,b,T,R){var E=this;this.db=g,this.mode=_,this.storeNames=D,this.schema=b,this.chromeTransactionDurability=T,this.idbtrans=null,this.on=lr(this,"complete","error","abort"),this.parent=R||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new V(function(I,U){E._resolve=I,E._reject=U}),this._completion.then(function(){E.active=!1,E.on.complete.fire()},function(I){var U=E.active;return E.active=!1,E.on.error.fire(I),E.parent?E.parent._reject(I):U&&E.idbtrans&&E.idbtrans.abort(),ye(I)})})),this.Version=(p=this,fr(zs.prototype,function(_){this.db=p,this._cfg={version:_,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=(y=this,fr(go.prototype,function(_,D,b){if(this.db=y,this._ctx={table:_,index:D===":id"?null:D,or:b},this._cmp=this._ascending=Ge,this._descending=function(T,R){return Ge(R,T)},this._max=function(T,R){return 0<Ge(T,R)?T:R},this._min=function(T,R){return Ge(T,R)<0?T:R},this._IDBKeyRange=y._deps.IDBKeyRange,!this._IDBKeyRange)throw new S.MissingAPI})),this.on("versionchange",function(_){0<_.newVersion?console.warn("Another connection wants to upgrade database '".concat(n.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(n.name,"'. Closing db now to resume the delete request.")),n.close({disableAutoOpen:!1})}),this.on("blocked",function(_){!_.newVersion||_.newVersion<_.oldVersion?console.warn("Dexie.delete('".concat(n.name,"') was blocked")):console.warn("Upgrade '".concat(n.name,"' blocked by other connection holding version ").concat(_.oldVersion/10))}),this._maxKey=vr(t.IDBKeyRange),this._createTransaction=function(_,D,b,T){return new n.Transaction(_,D,b,n._options.chromeTransactionDurability,T)},this._fireOnBlocked=function(_){n.on("blocked").fire(_),Jn.filter(function(D){return D.name===n.name&&D!==n&&!D._state.vcFired}).map(function(D){return D.on("versionchange").fire(_)})},this.use(Zs),this.use(nu),this.use(Js),this.use(Xs),this.use(Qs);var x=new Proxy(this,{get:function(_,D,b){if(D==="_vip")return!0;if(D==="table")return function(R){return Hr(n.table(R),x)};var T=Reflect.get(_,D,b);return T instanceof so?Hr(T,x):D==="tables"?T.map(function(R){return Hr(R,x)}):D==="_createTransaction"?function(){return Hr(T.apply(this,arguments),x)}:T}});this.vip=x,r.forEach(function(_){return _(n)})}var Gr,Wt=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",ru=(Ma.prototype.subscribe=function(e,t,n){return this._subscribe(e&&typeof e!="function"?e:{next:e,error:t,complete:n})},Ma.prototype[Wt]=function(){return this},Ma);function Ma(e){this._subscribe=e}try{Gr={indexedDB:l.indexedDB||l.mozIndexedDB||l.webkitIndexedDB||l.msIndexedDB,IDBKeyRange:l.IDBKeyRange||l.webkitIDBKeyRange}}catch{Gr={indexedDB:null,IDBKeyRange:null}}function Ro(e){var t,n=!1,r=new ru(function(o){var c=Oe(e),g,p=!1,y={},w={},x={get closed(){return p},unsubscribe:function(){p||(p=!0,g&&g.abort(),_&&Mn.storagemutated.unsubscribe(b))}};o.start&&o.start(x);var _=!1,D=function(){return Me(T)},b=function(R){Br(y,R),Sa(w,y)&&D()},T=function(){var R,E,I;!p&&Gr.indexedDB&&(y={},R={},g&&g.abort(),g=new AbortController,I=function(U){var F=Pn();try{c&&wn();var W=Ft(e,U);return W=c?W.finally(an):W}finally{F&&Rn()}}(E={subscr:R,signal:g.signal,requery:D,querier:e,trans:null}),Promise.resolve(I).then(function(U){n=!0,t=U,p||E.signal.aborted||(y={},function(F){for(var W in F)if(C(F,W))return;return 1}(w=R)||_||(Mn(hr,b),_=!0),Me(function(){return!p&&o.next&&o.next(U)}))},function(U){n=!1,["DatabaseClosedError","AbortError"].includes(U?.name)||p||Me(function(){p||o.error&&o.error(U)})}))};return setTimeout(D,0),x});return r.hasValue=function(){return n},r.getValue=function(){return t},r}var Hn=En;function ka(e){var t=kn;try{kn=!0,Mn.storagemutated.fire(e),Aa(e,!0)}finally{kn=t}}O(Hn,h(h({},Tt),{delete:function(e){return new Hn(e,{addons:[]}).delete()},exists:function(e){return new Hn(e,{addons:[]}).open().then(function(t){return t.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(e){try{return t=Hn.dependencies,n=t.indexedDB,t=t.IDBKeyRange,(ba(n)?Promise.resolve(n.databases()).then(function(r){return r.map(function(o){return o.name}).filter(function(o){return o!==Rr})}):ya(n,t).toCollection().primaryKeys()).then(e)}catch{return ye(new S.MissingAPI)}var t,n},defineClass:function(){return function(e){N(this,e)}},ignoreTransaction:function(e){return be.trans?on(be.transless,e):e()},vip:wa,async:function(e){return function(){try{var t=Pa(e.apply(this,arguments));return t&&typeof t.then=="function"?t:V.resolve(t)}catch(n){return ye(n)}}},spawn:function(e,t,n){try{var r=Pa(e.apply(n,t||[]));return r&&typeof r.then=="function"?r:V.resolve(r)}catch(o){return ye(o)}},currentTransaction:{get:function(){return be.trans||null}},waitFor:function(e,t){return t=V.resolve(typeof e=="function"?Hn.ignoreTransaction(e):e).timeout(t||6e4),be.trans?be.trans.waitFor(t):t},Promise:V,debug:{get:function(){return xt},set:function(e){Xn(e)}},derive:j,extend:N,props:O,override:q,Events:lr,on:Mn,liveQuery:Ro,extendObservabilitySet:Br,getByKeyPath:Q,setByKeyPath:K,delByKeyPath:function(e,t){typeof t=="string"?K(e,t,void 0):"length"in t&&[].map.call(t,function(n){K(e,n,void 0)})},shallowClone:Z,deepClone:De,getObjectDiff:Ra,cmp:Ge,asap:Y,minKey:-1/0,addons:[],connections:Jn,errnames:ut,dependencies:Gr,cache:Vn,semVer:"4.0.11",version:"4.0.11".split(".").map(function(e){return parseInt(e)}).reduce(function(e,t,n){return e+t/Math.pow(10,2*n)})})),Hn.maxKey=vr(Hn.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(Mn(hr,function(e){kn||(e=new CustomEvent(da,{detail:e}),kn=!0,dispatchEvent(e),kn=!1)}),addEventListener(da,function(e){e=e.detail,kn||ka(e)}));var nr,kn=!1,Do=function(){};return typeof BroadcastChannel<"u"&&((Do=function(){(nr=new BroadcastChannel(da)).onmessage=function(e){return e.data&&ka(e.data)}})(),typeof nr.unref=="function"&&nr.unref(),Mn(hr,function(e){kn||nr.postMessage(e)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(e){if(!En.disableBfCache&&e.persisted){xt&&console.debug("Dexie: handling persisted pagehide"),nr?.close();for(var t=0,n=Jn;t<n.length;t++)n[t].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(e){!En.disableBfCache&&e.persisted&&(xt&&console.debug("Dexie: handling persisted pageshow"),Do(),ka({all:new bt(-1/0,[[]])}))})),V.rejectionMapper=function(e,t){return!e||e instanceof we||e instanceof TypeError||e instanceof SyntaxError||!e.name||!Je[e.name]?e:(t=new Je[e.name](t||e.message,e),"stack"in e&&$(t,"stack",{get:function(){return this.inner.stack}}),t)},Xn(xt),h(En,Object.freeze({__proto__:null,Dexie:En,liveQuery:Ro,Entity:ao,cmp:Ge,PropModification:dr,replacePrefix:function(e,t){return new dr({replacePrefix:[e,t]})},add:function(e){return new dr({add:e})},remove:function(e){return new dr({remove:e})},default:En,RangeSet:bt,mergeRanges:_r,rangesOverlap:_o}),{default:En}),En})}(Xr)),Xr.exports}var Ic=Nc();const Qa=kc(Ic),ls=Symbol.for("Dexie"),ea=globalThis[ls]||(globalThis[ls]=Qa);if(Qa.semVer!==ea.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${Qa.semVer} and ${ea.semVer}`);const{liveQuery:$s,mergeRanges:ld,rangesOverlap:fd,RangeSet:dd,cmp:gd,Entity:hd,PropModification:vd,replacePrefix:pd,add:md,remove:_d}=ea;class $c extends ea{roms;opts;constructor(){super("myDatabase"),this.version(3).stores({roms:"crc32, title",opts:"key"})}}const In=new $c;var Lc=pe('<div class="tooltip-content"><div class="p-2 font-josefin"> </div></div>'),Uc=pe('<div class="relative" role="region"><div><!> <button type="button"><img/></button></div></div>');function fs(v,s){Qe(s,!0);const[i,h]=st(),a=()=>A(fn,"$darkTheme",i);let l=me(s,"item",19,()=>({id:"",icon:""})),f=me(s,"alt",3,"Icon"),P=me(s,"toggle",3,!1),N=me(s,"active",3,!1),k=me(s,"tooltip",3,""),M=me(s,"select",3,()=>{}),C=Rt(""),O=!1;function B(Q){Q.preventDefault(),O=P()?!O:!0,M()(Q.target.id,O)}function $(Q){console.log("onmouseenter"),setTimeout(()=>{Fe(C,"tooltip tooltip-right tooltip-primary")},700)}function j(Q){console.log("onmouseleave"),Fe(C,"")}var L=Uc(),G=re(L),X=re(G);{var q=Q=>{var K=Lc(),Z=re(K),ce=re(Z,!0);ae(Z),ae(K),it(()=>Nt(ce,k())),ne(Q,K)};Xe(X,Q=>{u(C)&&Q(q)})}var m=te(X,2);m.__click=B;var Y=re(m);ae(m),ae(G),ae(L),it(()=>{Ye(G,1,sr(u(C))),Ye(m,1,`btn btn-lg btn-primary btn-square p-1.5 ${N()?"btn-active":""}`),Ye(Y,1,sr(a()?"invert":"")),hn(Y,"id",l().id),hn(Y,"src",l().icon),hn(Y,"alt",f())}),Xt("mouseenter",L,$),Xt("mouseleave",L,j),ne(v,L),Ze(),h()}Zt(["click"]);const Fc=v=>v;function Lt(v,{delay:s=0,duration:i=400,easing:h=Fc}={}){const a=+getComputedStyle(v).opacity;return{delay:s,duration:i,easing:h,css:l=>`opacity: ${l*a}`}}var Bc=pe('<div><div class="bg-base-100/0 absolute top-0 left-0 z-40 flex w-16 flex-col pl-2"><div class="mt-1.5 mb-2 flex flex-col space-y-1.5 border-0"><!> <!></div></div></div>');function Kc(v,s){Qe(s,!0);const[i,h]=st(),a=()=>A(Ot,"$layer",i),l=()=>A(ta,"$showSidebar",i);let f=me(s,"action",3,()=>{}),P=Rt(""),N=200;function k(L,G){Fe(P,L==u(P)?"":L,!0),f()(L,G)}let M="icons/disk.png",C="icons/retroShellIcon.png";const O=gn(()=>a()===gt.shell?"Close the command shell":"Open the command shell");var B=St(),$=je(B);{var j=L=>{var G=Bc(),X=re(G),q=re(X),m=re(q);fs(m,{select:k,item:{id:"export",icon:M},active:!1,tooltip:"Export the file system"});var Y=te(m,2);const Q=gn(()=>a()===gt.shell);fs(Y,{select:k,item:{id:"shell",icon:C},get active(){return u(Q)},get tooltip(){return u(O)}}),ae(q),ae(X),ae(G),$t(3,G,()=>Lt,()=>({duration:N})),ne(L,G)};Xe($,L=>{l()&&L(j)})}ne(v,B),Ze(),h()}var Vc=Tn("<title> </title>"),Hc=Tn('<svg xmlns="http://www.w3.org/2000/svg" class="svelte-c8tyih"><!><!></svg>');function Yn(v,s){let i=me(s,"title",8,null),h=me(s,"viewBox",8);var a=Hc(),l=re(a);{var f=N=>{var k=Vc(),M=re(k,!0);ae(k),it(()=>Nt(M,i())),ne(N,k)};Xe(l,N=>{i()&&N(f)})}var P=te(l);_c(P,s,"default",{}),ae(a),it(()=>hn(a,"viewBox",h())),ne(v,a)}var Gc=Tn('<path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path>');function jc(v,s){const i=qn(s,["children","$$slots","$$events","$$legacy"]);Yn(v,zn({viewBox:"0 0 496 512"},()=>i,{children:(h,a)=>{var l=Gc();ne(h,l)},$$slots:{default:!0}}))}var Wc=Tn('<path d="M542.22 32.05c-54.8 3.11-163.72 14.43-230.96 55.59-4.64 2.84-7.27 7.89-7.27 13.17v363.87c0 11.55 12.63 18.85 23.28 13.49 69.18-34.82 169.23-44.32 218.7-46.92 16.89-.89 30.02-14.43 30.02-30.66V62.75c.01-17.71-15.35-31.74-33.77-30.7zM264.73 87.64C197.5 46.48 88.58 35.17 33.78 32.05 15.36 31.01 0 45.04 0 62.75V400.6c0 16.24 13.13 29.78 30.02 30.66 49.49 2.6 149.59 12.11 218.77 46.95 10.62 5.35 23.21-1.94 23.21-13.46V100.63c0-5.29-2.62-10.14-7.27-12.99z"></path>');function qc(v,s){const i=qn(s,["children","$$slots","$$events","$$legacy"]);Yn(v,zn({viewBox:"0 0 576 512"},()=>i,{children:(h,a)=>{var l=Wc();ne(h,l)},$$slots:{default:!0}}))}var zc=Tn('<path d="M7 4c-.83 0-1.5-.67-1.5-1.5S6.17 1 7 1s1.5.67 1.5 1.5S7.83 4 7 4zm7 6c0 1.11-.89 2-2 2h-1c-1.11 0-2-.89-2-2l2-4h-1c-.55 0-1-.45-1-1H8v8c.42 0 1 .45 1 1h1c.42 0 1 .45 1 1H3c0-.55.58-1 1-1h1c0-.55.58-1 1-1h.03L6 5H5c0 .55-.45 1-1 1H3l2 4c0 1.11-.89 2-2 2H2c-1.11 0-2-.89-2-2l2-4H1V5h3c0-.55.45-1 1-1h4c.55 0 1 .45 1 1h3v1h-1l2 4zM2.5 7L1 10h3L2.5 7zM13 10l-1.5-3-1.5 3h3z"></path>');function Yc(v,s){const i=qn(s,["children","$$slots","$$events","$$legacy"]);Yn(v,zn({viewBox:"0 0 14 16"},()=>i,{children:(h,a)=>{var l=zc();ne(h,l)},$$slots:{default:!0}}))}var Xc=pe('<a href="https://dirkwhoffmann.github.io/vAmiga/" target="_blank" rel="noopener noreferrer"><div class="w-full border-0"><div class="flex items-center"><img class="mt-0 h-14 p-0" src="va-icon.png" alt="vAmiga Icon"/>  <div class="flex flex-col pl-2 border-0"><div class="font-sofia-extra leading-none text-sm text-gray-300 border-0">Powered by</div> <div class="font-sofia-extra leading-none text-4xl text-gray-100  border-0">vAmiga</div></div></div></div></a>');function Qc(v,s){me(s,"shadow",3,!1);var i=Xc();ne(v,i)}var Zc=pe('<div class="flex w-24 border-0 flex-col items-center justify-center"><button><!></button> <div><!></div></div>');function $a(v,s){let i=me(s,"onclick",3,()=>{});var h=Zc(),a=re(h);Ye(a,1,"flex h-10 w-10 border-0 flex-col items-center justify-center text-gray-300"),a.__click=function(...N){i()?.apply(this,N)};var l=re(a);vn(l,()=>s.icon),ae(a);var f=te(a,2);Ye(f,1,"font-josefin flex border-none text-gray-300");var P=re(f);vn(P,()=>s.description),ae(f),ae(h),ne(v,h)}Zt(["click"]);var Jc=pe('<div><div class="font-josefin flex h-[500px] flex-col"><div class="w-full text-center text-3xl font-semibold text-white"> </div> <hr class="my-4 h-px border-0 bg-gray-200 dark:bg-gray-700"/> <div class="grow overflow-auto border-blue-500 px-4"><div><article class="prose mx-1"><!></article></div></div> <hr class="my-4 h-px border-0 bg-gray-200 dark:bg-gray-700"/> <div class="flex w-full justify-center"><button class="btn btn-primary">Close</button></div></div></div>');function Ls(v,s){Qe(s,!0),me(s,"show",11,!1);let i=me(s,"title",3,""),h=me(s,"close",3,()=>{});var a=Jc(),l=re(a),f=re(l),P=re(f,!0);ae(f);var N=te(f,4),k=re(N),M=re(k),C=re(M);vn(C,()=>s.children??Gt),ae(M),ae(k),ae(N);var O=te(N,4),B=re(O);B.__click=function(...$){h()?.apply(this,$)},ae(O),ae(l),ae(a),it(()=>Nt(P,i())),$t(1,M,()=>Lt),$t(3,a,()=>Lt),ne(v,a),Ze()}Zt(["click"]);var el=pe(`<h2>Kontakt</h2> <address>Prof. Dr. Dirk W. Hoffmann<br/> Hochschule Karlsruhe<br/> Moltkestraße 30<br/> D - 76133 Karlsruhe<br/> Germany</address> <h2>Datenschutz</h2> <p>Durch die Nutzung unserer Website erklären Sie sich mit der Erhebung, Verarbeitung und Nutzung
		von Daten gemäß der nachfolgenden Beschreibung einverstanden. Unsere Website kann grundsätzlich
		ohne Registrierung besucht werden. Dabei werden Daten wie beispielsweise aufgerufene Seiten bzw.
		Namen der abgerufenen Datei, Datum und Uhrzeit zu statistischen Zwecken auf dem Server
		gespeichert, ohne dass diese Daten unmittelbar auf Ihre Person bezogen werden. Personenbezogene
		Daten, insbesondere Name, Adresse oder E-Mail-Adresse werden soweit möglich auf freiwilliger
		Basis erhoben. Ohne Ihre Einwilligung erfolgt keine Weitergabe der Daten an Dritte.</p> <h2>Hosting</h2> <p>Diese Webseite wird gehostet auf Servern der Github Inc., 88 Colin P Kelly Jr. Street, San
		Francisco, CA 94107, USA. GitHub kann beim Aufruf dieser Webseiten technische Informationen
		inklusive ihrer IP Adresse aufzeichnen. Weitere Informationen zum Umgang mit Nutzerdaten finden
		Sie in der <a href="https://help.github.com/articles/github-privacy-policy">Datenschutzerklärung von GitHub</a>.</p>`,1);function tl(v,s){Qe(s,!0);function i(){console.log("close"),h(!1)}let h=me(s,"show",15,!1);Ls(v,{title:"Impressum",get show(){return h()},close:i,children:(a,l)=>{var f=el();Sr(10),ne(a,f)},$$slots:{default:!0}}),Ze()}var nl=pe(`<h2>Overview</h2> <p>This web-based tool is designed to inspect and interact Amiga media files such as ADF and HDF
		disk images. It brings the classic Amiga command-line experience directly to your browser, no
		installation required. Getting started is simple: Just drag and drop an ADF or HDF file onto the
		browser window to launch a fully functional command shell. Once inside the shell, you can
		navigate directories and view file contents, create and delete files and folders, or run
		built-in file system diagnostics. It's an intuitive and efficient way to explore the inner
		structure of your Amiga disk images.</p> <h2>Technical Background</h2> <p>Behind the scenes, a modern web-frontend implemented in Svelte interacts with the Amiga emulator <it>vAmiga</it> compiled to WebAssembly (WASM). This setup allows it to emulate the Amiga file system
		and command interface entirely in the browser, delivering fast performance and seamless usability
		across platforms.</p> <h2>What’s Next?</h2> <p>While the current version offers a text-based command interface, the long-term goal is to evolve
		it into a more visual and interactive tool. Future versions may include a graphical file
		manager, allowing users to browse disk contents in a familiar folder view, click on files, and
		perform common actions such as copying, renaming, or deleting.</p>`,1);function rl(v,s){Qe(s,!0);function i(){console.log("close"),h(!1)}let h=me(s,"show",15,!1);Ls(v,{title:"About",get show(){return h()},close:i,children:(a,l)=>{var f=nl();Sr(10),ne(a,f)},$$slots:{default:!0}}),Ze()}var al=pe("<div><!></div>"),ol=pe("<div>Learn More</div>"),il=pe("<div><!></div>"),sl=pe("<div>Source Code</div>"),ul=pe("<div><!></div>"),cl=pe("<div>Impressum</div>"),ll=pe(`<div><div class="modal-box"><!></div></div> <div><div class="modal-box"><!></div></div> <div><div><div class="absolute h-full w-full bg-gradient-to-t from-gray-500 via-white to-white"></div> <div class="absolute flex h-full w-full items-center justify-center"><div class="flex flex-col items-center"><img class="h-[50vh] w-auto object-contain opacity-100" src="icons/hand-disk.png" alt="Background"/> <div class="font-josefin mt-4 w-[50vw] text-center text-2xl text-white">Welcome to the Amiga file system inspector!</div> <div class=" font-josefin w-[50vw] text-center text-lg text-gray-200">Drag and drop an ADF or HDF file anywhere on this window to browse files and explore
						folders.</div> <div class="font-josefin m-4 w-[50vw] text-center text-lg text-indigo-200"><a href="https://github.com/vAmigaDOS/vAmigaDOS/issues">This version is a pre-release. Please help improving this software by filing a bug
							report on GitHub.</a></div></div></div></div> <div><!> <!> <!></div> <div><!></div></div>`,1);function fl(v,s){Qe(s,!1);const[i,h]=st(),a=()=>A(na,"$poweredOn",i);let l=Ct(!1),f=Ct(!1);Wn(()=>{console.log("TitleScreen::onMount()")});function P(){window.location.href="https://github.com/vAmigaDOS/vAmigaDOS"}function N(){Fe(l,!0)}function k(){Fe(f,!0)}Mt();var M=St(),C=je(M);{var O=B=>{var $=ll(),j=je($);let L;var G=re(j),X=re(G);rl(X,{get show(){return u(l)},set show(xe){Fe(l,xe)},$$legacy:!0}),ae(G),ae(j);var q=te(j,2);let m;var Y=re(q),Q=re(Y);tl(Q,{get show(){return u(f)},set show(xe){Fe(f,xe)},$$legacy:!0}),ae(Y),ae(q);var K=te(q,2);Ye(K,1,"z-50 flex h-full w-screen flex-col border-0 border-cyan-400 ");var Z=re(K),ce=te(Z,2);Ye(ce,1,"absolute bottom-6 left-6 flex flex-col space-y-3 border-0 ");var Te=re(ce);$a(Te,{onclick:N,icon:ke=>{var Ee=al(),He=re(Ee);qc(He,{}),ae(Ee),ne(ke,Ee)},description:ke=>{var Ee=ol();ne(ke,Ee)},$$slots:{icon:!0,description:!0}});var Pe=te(Te,2);$a(Pe,{onclick:P,icon:ke=>{var Ee=il(),He=re(Ee);jc(He,{}),ae(Ee),ne(ke,Ee)},description:ke=>{var Ee=sl();ne(ke,Ee)},$$slots:{icon:!0,description:!0}});var _e=te(Pe,2);$a(_e,{onclick:k,icon:ke=>{var Ee=ul(),He=re(Ee);Yc(He,{}),ae(Ee),ne(ke,Ee)},description:ke=>{var Ee=cl();ne(ke,Ee)},$$slots:{icon:!0,description:!0}}),ae(ce);var De=te(ce,2);Ye(De,1,"absolute right-6 bottom-6 flex flex-col space-y-3 border-0 ");var Ie=re(De);Qc(Ie,{}),ae(De),ae(K),it((xe,Ue)=>{L=Ye(j,1,"modal",null,L,xe),m=Ye(q,1,"modal",null,m,Ue)},[()=>({"modal-open":u(l)}),()=>({"modal-open":u(f)})],ee),$t(1,Z,()=>Lt,()=>({duration:2e3})),$t(3,K,()=>Lt),ne(B,$)};Xe(C,B=>{a()||B(O)})}ne(v,M),Ze(),h()}class ir{current=0;target=0;deltaStep=.005;constructor(s=0){this.current=s,this.target=s}animates(){return this.current!=this.target}clamped(){return this.current<0?0:this.current>1?1:this.current}set(s,i=25){this.target=s,this.deltaStep=Math.abs(this.target-this.current)/i}move(){this.current+this.deltaStep<=this.target?this.current+=this.deltaStep:this.current-this.deltaStep>=this.target?this.current-=this.deltaStep:this.current=this.target}}const La=1,dl=313,gl=dl,hl=227,ar=313,or=912,vl=18,pl=26,ds={Escape:69,F1:80,F2:81,F3:82,F4:83,F5:84,F6:85,F7:86,F8:87,F9:88,F10:89,F11:102,F12:103,Backquote:0,Digit1:1,Digit2:2,Digit3:3,Digit4:4,Digit5:5,Digit6:6,Digit7:7,Digit8:8,Digit9:9,Digit0:10,Minus:11,Equal:12,Backspace:65,Tab:66,KeyQ:16,KeyW:17,KeyE:18,KeyR:19,KeyT:20,KeyY:21,KeyU:22,KeyI:23,KeyO:24,KeyP:25,BracketLeft:26,BracketRight:27,Backslash:13,CapsLock:98,KeyA:32,KeyS:33,KeyD:34,KeyF:35,KeyG:36,KeyH:37,KeyJ:38,KeyK:39,KeyL:40,Semicolon:41,Quote:42,Enter:68,ShiftLeft:96,KeyZ:49,KeyX:50,KeyC:51,KeyV:52,KeyB:53,KeyN:54,KeyM:55,Comma:56,Period:57,Slash:58,ShiftRight:97,ControlLeft:99,AltLeft:100,MetaLeft:102,Space:64,AltRight:101,MetaRight:103,ControlRight:99,Delete:70,End:95,PageDown:69,ArrowUp:76,ArrowDown:77,ArrowRight:78,ArrowLeft:79,NumpadDivide:92,NumpadMultiply:93,NumpadSubtract:74,Numpad7:61,Numpad8:62,Numpad9:63,NumpadAdd:94,Numpad4:45,Numpad5:46,Numpad6:47,Numpad1:29,Numpad2:30,Numpad3:31,NumpadEnter:67,Numpad0:15,NumpadDecimal:60},gs={Aros:1062194186,DiagROM:2231503309};class ml{x1=new ir(.1);y1=new ir(.1);x2=new ir(.9);y2=new ir(.9);texW=La*or;texH=ar;normalize(s){return{x:s.x/this.texW,y:s.y/this.texH,w:s.w/this.texW,h:s.h/this.texH}}entire(){return{x:0,y:0,w:this.texW,h:this.texH}}entireNormalized(){return this.normalize(this.entire())}largestVisible(){const s=4*La*vl,i=4*La*hl,h=pl,a=gl;return{x:s,y:h,w:i-s,h:a-h}}largestVisibleNormalized(){return this.normalize(this.largestVisible())}visible(s,i,h,a){const l=this.largestVisible(),f=1-.2*s,P=1-.2*i,N=f*l.w,k=P*l.h,M=l.x+h*(l.w-N),C=l.y+a*(l.h-k);return{x:M,y:C,w:N,h:k}}visibleNormalized(s,i,h,a){return this.normalize(this.visible(s,i,h,a))}animates(){return this.x1.animates()||this.y1.animates()||this.x2.animates()||this.y2.animates()}zoomIn(){this.x1.set(.188),this.y1.set(.106),this.x2.set(.188+.733),this.y2.set(.106+.867)}zoomOut(){this.x1.set(0),this.y1.set(0),this.x2.set(1),this.y2.set(1)}move(){this.x1.move(),this.y1.move(),this.x2.move(),this.y2.move()}}async function _l(v,s,i,h,a){if(!s())await i();else switch(v.button){case 0:h()?.trigger(a().PRESS_LEFT);break;case 1:h()?.trigger(a().PRESS_MIDDLE);break;case 2:h()?.trigger(a().PRESS_RIGHT);break}}function yl(v,s,i){switch(v.button){case 0:s()?.trigger(i().RELEASE_LEFT);break;case 1:s()?.trigger(i().RELEASE_MIDDLE);break;case 2:s()?.trigger(i().RELEASE_RIGHT);break}}var bl=pe('<canvas class="h-full w-full focus:ring-0 focus:outline-none" tabindex="-1"></canvas>');function wl(v,s){Qe(s,!0);const[i,h]=st(),a=()=>A($n,"$amiga",i),l=()=>A(bs,"$denise",i),f=()=>A(Qt,"$wasm",i),P=()=>A(It,"$config",i),N=()=>A(ws,"$running",i),k=()=>A(qt,"$port1",i),M=()=>A(Ts,"$keyset1",i),C=()=>A(xs,"$keyset2",i),O=()=>A(zt,"$port2",i),B=()=>A(to,"$joystick1",i),$=()=>A(no,"$joystick2",i),j=()=>A(Es,"$keyboard",i),L=()=>A(ys,"$mouse1",i),G=()=>A(Ss,"$mouse2",i),X=()=>A(Ka,"$MsgShaking",i);let q=Rt(void 0),m=Rt(void 0);me(s,"x1",3,0),me(s,"y1",3,0),me(s,"x2",3,0),me(s,"y2",3,0);let Y=me(s,"tx1",7,0),Q=me(s,"ty1",7,0),K=me(s,"tx2",7,0),Z=me(s,"ty2",7,0),ce=me(s,"needsDisplay",15,!1),Te=!0,Pe=!0,_e=0,De=()=>document.pointerLockElement===u(q),Ie=!1,xe=!1,Ue=!1,ke=!1,Ee=0,He,Se,Oe,We,we,qe,Ce,tt,ut,at,S;const Je=`
    	attribute vec4 aVertexPosition;
    	varying highp vec2 vTextureCoord;
    	void main() {
    		gl_Position = aVertexPosition;
			vTextureCoord = gl_Position.xy * .5 + .5;
    	}
   	`,Tt=`
		precision mediump float;

		varying highp vec2 vTextureCoord;
	   	uniform sampler2D u_lfSampler;
	   	uniform sampler2D u_sfSampler;

		void main()
		{
			vec2 coord = vec2(floor(gl_FragCoord.x), floor(gl_FragCoord.y));

			vec4 color;
		    if (mod(coord.y, 2.0) == 0.0) {
		        // color = vec4(1.0, 0.0, 0.0, 1.0);
				color = texture2D(u_sfSampler, vTextureCoord);
		    } else {
		        // color = vec4(1.0, 1.0, 0.0, 1.0);
				color = texture2D(u_lfSampler, vTextureCoord);
		    }

		    gl_FragColor = color;
		}
   `,Be=`
    	attribute vec4 aVertexPosition;
    	attribute vec2 aTextureCoord;
    	varying highp vec2 vTextureCoord;
    	void main() {
    		gl_Position = aVertexPosition;
    		vTextureCoord = aTextureCoord;
    	}
   	`,vt=`
		precision mediump float;
    
		varying highp vec2 vTextureCoord;
    	uniform sampler2D sampler;
    	uniform float u_lweight;
		uniform float u_sweight;

    	void main()
    	{
    	    float w;

			vec2 coord = vec2(floor(gl_FragCoord.x), floor(gl_FragCoord.y));
		    if (mod(coord.y, 2.0) == 0.0) {
		        w = u_lweight;
		        // gl_FragColor = vec4(1.0, 0.0, 0.0, 1.0) * vec4(w, w, w, 1.0);
		    } else {
		        w = u_sweight;
		        // gl_FragColor = vec4(1.0, 1.0, 0.0, 1.0) * vec4(w, w, w, 1.0);
		    }

            gl_FragColor = texture2D(sampler, vTextureCoord) * vec4(w, w, w, 1.0);
    	}
   `;function Jt(){const ge={alpha:!1,antialias:!1,depth:!1,preserveDrawingBuffer:!1,stencil:!1};if(!(u(q).getContext("webgl2",ge)instanceof WebGL2RenderingContext))throw new Error("vAmigaDOS needs WebGL2 to run.");Fe(m,u(q).getContext("webgl2",ge),!0),u(m).disable(u(m).BLEND),u(m).disable(u(m).DEPTH_TEST),u(m).disable(u(m).SCISSOR_TEST),u(m).disable(u(m).STENCIL_TEST),u(m).clearColor(0,0,0,1),u(m).clear(u(m).COLOR_BUFFER_BIT),we=en(Je,Tt),ut=u(m).getUniformLocation(we,"u_lfSampler"),tt=u(m).getUniformLocation(we,"u_sfSampler"),at=en(Be,vt),qe=u(m).getUniformLocation(at,"u_lweight"),Ce=u(m).getUniformLocation(at,"u_sweight"),S=u(m).getUniformLocation(at,"sampler"),u(m).uniform1i(S,0);const V=new Float32Array([-1,1,1,1,-1,-1,1,-1]);yt(V),xt(at,"aVertexPosition");const Ae=new Float32Array([0,1,1,1,0,0,1,0]);He=yt(Ae),xt(at,"aTextureCoord"),Se=J(or,ar),Oe=J(or,ar),We=J(or,2*ar)}function pt(ge,V,Ae,nt){const mt=new Float32Array([ge,V,Ae,V,ge,nt,Ae,nt]);u(m).bindBuffer(u(m).ARRAY_BUFFER,He),u(m).bufferSubData(u(m).ARRAY_BUFFER,0,mt)}function sn(){const ge=u(q).clientWidth,V=u(q).clientHeight;(u(q).width!==ge||u(q).height!==V)&&(u(q).width=ge,u(q).height=V)}function en(ge,V){const Ae=se(u(m).VERTEX_SHADER,ge),nt=se(u(m).FRAGMENT_SHADER,V),mt=u(m).createProgram();if(u(m).attachShader(mt,Ae),u(m).attachShader(mt,nt),u(m).linkProgram(mt),!u(m).getProgramParameter(mt,u(m).LINK_STATUS))throw new Error(`Shader link error: ${u(m).getProgramInfoLog(mt)}`);return u(m).useProgram(mt),mt}function se(ge,V){const Ae=u(m).createShader(ge);if(!Ae)throw new Error("Failed to create shader.");if(u(m).shaderSource(Ae,V),u(m).compileShader(Ae),!u(m).getShaderParameter(Ae,u(m).COMPILE_STATUS))throw new Error(`Shader compile error: ${u(m).getShaderInfoLog(Ae)}`);return Ae}function J(ge,V,Ae=0){const nt=u(m).createTexture();if(!nt)throw new Error("Failed to create texture.");const mt=Ae==0?u(m).NEAREST:u(m).LINEAR;return u(m).bindTexture(u(m).TEXTURE_2D,nt),u(m).texParameteri(u(m).TEXTURE_2D,u(m).TEXTURE_WRAP_S,u(m).CLAMP_TO_EDGE),u(m).texParameteri(u(m).TEXTURE_2D,u(m).TEXTURE_WRAP_T,u(m).CLAMP_TO_EDGE),u(m).texParameteri(u(m).TEXTURE_2D,u(m).TEXTURE_MIN_FILTER,mt),u(m).texParameteri(u(m).TEXTURE_2D,u(m).TEXTURE_MAG_FILTER,mt),u(m).texImage2D(u(m).TEXTURE_2D,0,u(m).RGBA,ge,V,0,u(m).RGBA,u(m).UNSIGNED_BYTE,null),nt}function yt(ge){const V=u(m).createBuffer();return u(m).bindBuffer(u(m).ARRAY_BUFFER,V),u(m).bufferData(u(m).ARRAY_BUFFER,ge,u(m).STATIC_DRAW),V}function xt(ge,V){const Ae=u(m).getAttribLocation(ge,V);u(m).enableVertexAttribArray(Ae),u(m).vertexAttribPointer(Ae,2,u(m).FLOAT,!1,0,0)}function Xn(){sn(),pn(),a().wakeUp()}function pn(){const ge=or,V=ar;if(a().poweredOff()){const Ae=l().noise();Pe=Te,Te=!Pe;const nt=new Uint8Array(f().HEAPU8.buffer,Ae,ge*V*4);Te?(u(m).activeTexture(u(m).TEXTURE0),u(m).bindTexture(u(m).TEXTURE_2D,Se),u(m).texSubImage2D(u(m).TEXTURE_2D,0,0,0,ge,V,u(m).RGBA,u(m).UNSIGNED_BYTE,nt)):(u(m).activeTexture(u(m).TEXTURE1),u(m).bindTexture(u(m).TEXTURE_2D,Oe),u(m).texSubImage2D(u(m).TEXTURE_2D,0,0,0,ge,V,u(m).RGBA,u(m).UNSIGNED_BYTE,nt))}else{const Ae=l().getEmulatorTexture();if(Pe=Ae.prevLof,Te=Ae.currLof,Ae.frameNr!=_e+1&&Ae.frameNr==_e)return;_e=Ae.frameNr;const nt=new Uint8Array(f().HEAPU8.buffer,Ae.data,ge*V*4);Te?(u(m).activeTexture(u(m).TEXTURE0),u(m).bindTexture(u(m).TEXTURE_2D,Se),u(m).texSubImage2D(u(m).TEXTURE_2D,0,0,0,ge,V,u(m).RGBA,u(m).UNSIGNED_BYTE,nt)):(u(m).activeTexture(u(m).TEXTURE1),u(m).bindTexture(u(m).TEXTURE_2D,Oe),u(m).texSubImage2D(u(m).TEXTURE_2D,0,0,0,ge,V,u(m).RGBA,u(m).UNSIGNED_BYTE,nt))}ce(!0)}function Qn(){ce()&&(mn(),tn(),ce(!1))}function mn(){Te==Pe?Te?(u(m).useProgram(we),u(m).uniform1i(ut,0),u(m).uniform1i(tt,0)):(u(m).useProgram(we),u(m).uniform1i(ut,1),u(m).uniform1i(tt,1)):(u(m).useProgram(we),u(m).uniform1i(ut,1),u(m).uniform1i(tt,0));const ge=u(m).createFramebuffer();u(m).activeTexture(u(m).TEXTURE0),u(m).bindTexture(u(m).TEXTURE_2D,Se),u(m).activeTexture(u(m).TEXTURE1),u(m).bindTexture(u(m).TEXTURE_2D,Oe),u(m).bindFramebuffer(u(m).FRAMEBUFFER,ge),u(m).viewport(0,0,or,2*ar),u(m).framebufferTexture2D(u(m).FRAMEBUFFER,u(m).COLOR_ATTACHMENT0,u(m).TEXTURE_2D,We,0),u(m).drawArrays(u(m).TRIANGLE_STRIP,0,4)}function tn(){if(u(m).bindFramebuffer(u(m).FRAMEBUFFER,null),u(m).viewport(0,0,u(m).canvas.width,u(m).canvas.height),u(m).activeTexture(u(m).TEXTURE0),u(m).bindTexture(u(m).TEXTURE_2D,We),u(m).useProgram(at),u(m).uniform1f(qe,1),u(m).uniform1f(Ce,1),Te!=Pe){let ge=P().getNum(d.FLICKER_WEIGHT);if(ge>0&&N()){const V=1-ge/100;u(m).uniform1f(qe,Ee%4>=2?1:V),u(m).uniform1f(Ce,Ee%4>=2?V:1),Ee+=1}}u(m).drawArrays(u(m).TRIANGLE_STRIP,0,4)}Wn(()=>{console.log("GLCanvas::onMount()"),document.addEventListener("pointerlockchange",yn,!1),Jt(),pt(Y(),Q(),K(),Z())}),Fu(()=>{document.removeEventListener("pointerlockchange",yn)});function jt(ge,V){let Ae;switch(V==1&&k()==kt.keyset1&&(Ae=M()[ge]),V==1&&k()==kt.keyset2&&(Ae=C()[ge]),V==2&&O()==kt.keyset1&&(Ae=M()[ge]),V==2&&O()==kt.keyset2&&(Ae=C()[ge]),Ae){case void 0:return[];case f().PULL_UP:return Ie=!0,[f().PULL_UP];case f().PULL_DOWN:return xe=!0,[f().PULL_DOWN];case f().PULL_LEFT:return Ue=!0,[f().PULL_LEFT];case f().PULL_RIGHT:return ke=!0,[f().PULL_RIGHT];case f().PRESS_FIRE:return[f().PRESS_FIRE];case f().PRESS_FIRE2:return[f().PRESS_FIRE2];case f().PRESS_FIRE3:return[f().PRESS_FIRE3]}}function xn(ge,V){let Ae;switch(V==1&&k()==kt.keyset1&&(Ae=M()[ge]),V==1&&k()==kt.keyset2&&(Ae=C()[ge]),V==2&&O()==kt.keyset1&&(Ae=M()[ge]),V==2&&O()==kt.keyset2&&(Ae=C()[ge]),Ae){case void 0:return[];case f().PULL_UP:return Ie=!1,xe?[f().PULL_DOWN]:[f().RELEASE_Y];case f().PULL_DOWN:return xe=!1,Ie?[f().PULL_UP]:[f().RELEASE_Y];case f().PULL_LEFT:return Ue=!1,ke?[f().PULL_RIGHT]:[f().RELEASE_X];case f().PULL_RIGHT:return ke=!1,Ue?[f().PULL_LEFT]:[f().RELEASE_X];case f().PRESS_FIRE:return[f().RELEASE_FIRE];case f().PRESS_FIRE2:return[f().RELEASE_FIRE2];case f().PRESS_FIRE3:return[f().RELEASE_FIRE3]}}function _n(ge){if(ge.repeat)return;let V=jt(ge.code,1);if(V?.length){V?.forEach(nt=>B().trigger(nt));return}if(V=jt(ge.code,2),V?.length){V?.forEach(nt=>$().trigger(nt));return}const Ae=ds[ge.code];Ae!==void 0&&(j().pressKey(Ae),ge.preventDefault(),ge.stopPropagation())}function Ln(ge){let V=xn(ge.code,1);if(V?.length){V?.forEach(nt=>B().trigger(nt));return}if(V=xn(ge.code,2),V?.length){V?.forEach(nt=>$().trigger(nt));return}const Ae=ds[ge.code];Ae!==void 0&&j().releaseKey(Ae)}function yn(){document.pointerLockElement===u(q)?document.addEventListener("mousemove",Ut,!1):document.removeEventListener("mousemove",Ut)}async function nn(){De()||await u(q).requestPointerLock()}function An(){De()&&document.exitPointerLock()}function bn(){return k()==kt.mouse?L():O()==kt.mouse?G():null}function Ut(ge){const V=ge.movementX/2,Ae=ge.movementY/2;L().detectShakeRel(V,Ae),bn()?.setDxDy(V,Ae)}let be=gn(()=>P().getNum(d.RENDER_MODE)==wr.smooth?"image-rendering: auto":"image-rendering: pixelated");Fa(()=>{u(m)&&pt(Y(),Q(),K(),Z())}),Fa(()=>{X()&&P().getBool(d.SHAKING)&&An()});var At=bl();At.__keydown=_n,At.__keyup=Ln,At.__mousedown=[_l,De,nn,bn,f],At.__mouseup=[yl,bn,f],Yt(At,ge=>Fe(q,ge),()=>u(q)),it(()=>Cs(At,u(be))),ne(v,At);var rn=Ze({update:Xn,render:Qn,get tx1(){return Y()},set tx1(ge){Y(ge)},get tx2(){return K()},set tx2(ge){K(ge)},get ty1(){return Q()},set ty1(ge){Q(ge)},get ty2(){return Z()},set ty2(ge){Z(ge)},get needsDisplay(){return ce()},set needsDisplay(ge){ce(ge)}});return h(),rn}Zt(["keydown","keyup","mousedown","mouseup"]);var El=pe('<div class="relative flex h-full grow flex-col justify-center"><div class="flex h-full items-center justify-center"><div><!></div></div></div>');function Sl(v,s){Qe(s,!0);const[i,h]=st(),a=()=>A(Va,"$canvasWidth",i),l=()=>A(Ha,"$canvasHeight",i),f=()=>A(qr,"$aspectWidth",i),P=()=>A(zr,"$aspectHeight",i),N=()=>A($n,"$amiga",i),k=()=>A(Qt,"$wasm",i),M=()=>A(na,"$poweredOn",i),C=()=>A(Ga,"$gamepadManager",i),O=()=>A(Yr,"$layout",i),B=()=>A(It,"$config",i);let $=Rt(void 0),j=Rt(0),L=Rt(0),G=Rt(0),X=Rt(0),q=Rt(0),m=Rt(0),Y=Rt(0),Q=Rt(0),K=me(s,"textureRect",23,()=>new ml),Z=new ir(0),ce=new ir(0),Te=Rt(0),Pe=Rt(0);Wn(()=>{console.log("Emulator::onMount()"),K().zoomIn()});function _e(Se){if(Se=="full")Z.set(a()),ce.set(l());else if(Se=="aspect")Z.set(f()),ce.set(P());else if(Se=="fit"){const Oe=K().x1.current*K().texW,We=K().y1.current*K().texH,we=K().x2.current*K().texW,qe=K().y2.current*K().texH;Z.set(we-Oe+2),ce.set(2*(qe-We+2))}}function De(Se,Oe){const We=[];for(N().lockMsgQueue();;){let we=N().readMessage();if(we.type==k().Msg.NONE)break;We.push(we)}N().unlockMsgQueue();for(const we of We)k().processMsg(we);M()&&(Ie(),u($)?.render())}function Ie(Se){let Oe=K().animates(),We=Z.animates()||ce.animates();C().pollState(),Oe&&(K().move(),Fe(q,K().x1.current,!0),Fe(m,K().y1.current,!0),Fe(Y,K().x2.current,!0),Fe(Q,K().y2.current,!0),Fe(j,K().x1.current*K().texW),Fe(L,K().y1.current*K().texH),Fe(G,K().x2.current*K().texW),Fe(X,K().y2.current*K().texH),O()=="fit"&&(Fe(Te,Z.current=Z.target=u(G)-u(j)+2,!0),Fe(Pe,ce.current=ce.target=2*(u(X)-u(L)+2),!0)),u($)&&(u($).needsDisplay=!0)),We&&(Z.move(),ce.move(),Fe(Te,Z.current,!0),Fe(Pe,ce.current,!0),u($)&&(u($).needsDisplay=!0)),u($)?.update()}let xe=gn(()=>B()?.getBool(d.CANVAS_BORDER)?"border-2 border-primary border-opacity-100":"");Fa(()=>{const Se=O();if(Se==="full")Z.set(a()),ce.set(l());else if(Se==="aspect")Z.set(f()),ce.set(P());else if(Se==="fit"){const Oe=K().x1.current*K().texW,We=K().y1.current*K().texH,we=K().x2.current*K().texW,qe=K().y2.current*K().texH;Z.set(we-Oe+2),ce.set(2*(qe-We+2))}});var Ue=St(),ke=je(Ue);{var Ee=Se=>{var Oe=El(),We=re(Oe),we=re(We),qe=re(we);Yt(wl(qe,{get x1(){return u(j)},get x2(){return u(G)},get y1(){return u(L)},get y2(){return u(X)},get tx1(){return u(q)},get tx2(){return u(Y)},get ty1(){return u(m)},get ty2(){return u(Q)}}),Ce=>Fe($,Ce,!0),()=>u($)),ae(we),ae(We),ae(Oe),it(()=>{Ye(we,1,sr(u(xe))),Cs(we,`height:${u(Pe)??""}px; width:${u(Te)??""}px`)}),$t(3,Oe,()=>Lt),ne(Se,Oe)};Xe(ke,Se=>{M()&&Se(Ee)})}ne(v,Ue);var He=Ze({updateRect:_e,doAnimationFrame:De,get textureRect(){return K()},set textureRect(Se){K(Se)}});return h(),He}var Tl=pe("<button> </button>");function yr(v,s){let i=me(s,"name",3,""),h=me(s,"active",3,""),a=me(s,"style",3,"text-3xl");var l=Tl();l.__click=function(...P){s.onclick?.apply(this,P)};var f=re(l,!0);ae(l),it(()=>{Ye(l,1,`btn btn-ghost p-0 font-thin ${h()===i()?"btn-active":""} ${a()??""}`),Nt(f,i())}),ne(v,l)}Zt(["click"]);var xl=pe('<div class="px-0 py-0.5"><div class="w-full flex"><div class="text-xl text-base-content"> </div></div> <!></div>');function ht(v,s){let i=me(s,"name",3,"");var h=xl(),a=re(h),l=re(a),f=re(l,!0);ae(l),ae(a);var P=te(a,2);vn(P,()=>s.children??Gt),ae(h),it(()=>Nt(f,i())),ne(v,h)}var Al=Tn('<path d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path>');function Pl(v,s){const i=qn(s,["children","$$slots","$$events","$$legacy"]);Yn(v,zn({viewBox:"0 0 14 16"},()=>i,{children:(h,a)=>{var l=Al();ne(h,l)},$$slots:{default:!0}}))}var Rl=Tn('<path d="M254.28 17.313c-81.048 0-146.624 65.484-146.624 146.406V236h49.594v-69.094c0-53.658 43.47-97.187 97.03-97.187 53.563 0 97.032 44.744 97.032 97.186V236h49.594v-72.28c0-78.856-65.717-146.407-146.625-146.407zM85.157 254.688c-14.61 22.827-22.844 49.148-22.844 76.78 0 88.358 84.97 161.5 191.97 161.5 106.998 0 191.968-73.142 191.968-161.5 0-27.635-8.26-53.95-22.875-76.78H85.155zM254 278.625c22.34 0 40.875 17.94 40.875 40.28 0 16.756-10.6 31.23-25.125 37.376l32.72 98.126h-96.376l32.125-98.125c-14.526-6.145-24.532-20.62-24.532-37.374 0-22.338 17.972-40.28 40.312-40.28z"></path>');function Dl(v,s){const i=qn(s,["children","$$slots","$$events","$$legacy"]);Yn(v,zn({viewBox:"0 0 512 512"},()=>i,{children:(h,a)=>{var l=Rl();ne(h,l)},$$slots:{default:!0}}))}var Ol=(v,s)=>s(!0),Ml=(v,s)=>s(v),kl=pe('<ul tabindex="0" class="dropdown-content menu bg-base-100 text-base-content mt-1 w-full"><input type="range" class="range range-accent h-12 rounded-none px-4"/></ul>'),Cl=pe('<div class="dropdown dropdown-bottom"><button type="button" tabindex="0"><!></button> <!></div>');function Nl(v,s){Qe(s,!0);let i=me(s,"value",7,0),h=me(s,"locked",3,!1),a=me(s,"min",3,0),l=me(s,"max",3,0),f=me(s,"open",7,!0),P=me(s,"select",3,()=>{});function N($){$.preventDefault(),i(Number($.target.value)),P()(i())}var k=Cl(),M=re(k);M.__click=[Ol,f];var C=re(M);vn(C,()=>s.children??Gt),ae(M);var O=te(M,2);{var B=$=>{var j=kl(),L=re(j);Tc(L),L.__input=[Ml,N],ae(j),it(()=>{hn(L,"min",a()),hn(L,"max",l()),xc(L,i())}),ne($,j)};Xe(O,$=>{f()&&$(B)})}ae(k),it(()=>Ye(M,1,sr(h()?"pointer-events-none":""))),ne(v,k),Ze()}Zt(["click","input"]);var Il=pe('<div class="w-4">&#10003</div>'),$l=pe('<div class="w-4"></div>');function Ll(v,s){var i=St(),h=je(i);{var a=l=>{var f=St(),P=je(f);{var N=M=>{var C=Il();ne(M,C)},k=M=>{var C=$l();ne(M,C)};Xe(P,M=>{s.visible?M(N):M(k,!1)})}ne(l,f)};Xe(h,l=>{l(a)})}ne(v,i)}var Ul=pe('<li class="divider"></li>'),Fl=(v,s,i)=>s(v,u(i).tag),Bl=pe("<li><button><!> </button></li>"),Kl=pe('<div><label tabindex="0"><!></label>  <ul tabindex="0"><!></ul></div>');function Vl(v,s){Qe(s,!0);let i=me(s,"items",19,()=>[]),h=me(s,"isEnabled",3,!0),a=me(s,"checkmarks",3,!1),l=me(s,"dropdownStyle",3,""),f=me(s,"listStyle",3,""),P=me(s,"select",3,()=>{});const N=($,j)=>{$.preventDefault(),document.activeElement&&document.activeElement.blur(),P()(j)};var k=Kl(),M=re(k),C=re(M);vn(C,()=>s.children??Gt),ae(M);var O=te(M,2),B=re(O);Jr(B,i,$=>{var j=St(),L=je(j);vc(L,17,i,gc,(G,X)=>{var q=St(),m=je(q);{var Y=K=>{var Z=Ul();ne(K,Z)},Q=(K,Z)=>{{var ce=Te=>{var Pe=Bl(),_e=re(Pe);_e.__click=[Fl,N,X];var De=re(_e);{var Ie=Ue=>{Ll(Ue,{get visible(){return u(X).isSelected}})};Xe(De,Ue=>{a()&&Ue(Ie)})}var xe=te(De);ae(_e),ae(Pe),it(()=>{_e.disabled=!u(X).isEnabled,Ye(_e,1,sr(u(X).isEnabled?"":"hover:bg-base-100 opacity-40")),Nt(xe,` ${u(X).title??""}`)}),ne(Te,Pe)};Xe(K,Te=>{u(X).isHidden||Te(ce)},Z)}};Xe(m,K=>{u(X)instanceof Wu?K(Y):K(Q,!1)})}ne(G,q)}),ne($,j)}),ae(O),ae(k),it(()=>{Ye(k,1,`dropdown ${l()??""}`),Ye(M,1,sr(h()?"":"pointer-events-none")),Ye(O,1,`dropdown-content menu bg-base-100 ${f()??""}`)}),ne(v,k),Ze()}Zt(["click"]);function Hl(v,s){let i=me(s,"items",19,()=>[]),h=me(s,"isEnabled",3,!0),a=me(s,"dropdownStyle",3,""),l=me(s,"listStyle",3,""),f=me(s,"selectedTag",3,0),P=me(s,"select",3,()=>{}),N=gn(()=>{let C=i(),O=f();for(const B of C)B.isSelected=B.tag==O;return C});var k=St(),M=je(k);Jr(M,i,C=>{var O=St(),B=je(O);Jr(B,f,$=>{Vl($,{get items(){return u(N)},get isEnabled(){return h()},checkmarks:!0,get dropdownStyle(){return a()},get listStyle(){return l()},select:P(),children:(j,L)=>{var G=St(),X=je(G);vn(X,()=>s.children??Gt),ne(j,G)},$$slots:{default:!0}})}),ne(C,O)}),ne(v,k)}var Gl=Tn('<path d="M207.029 381.476L12.686 187.132c-9.373-9.373-9.373-24.569 0-33.941l22.667-22.667c9.357-9.357 24.522-9.375 33.901-.04L224 284.505l154.745-154.021c9.379-9.335 24.544-9.317 33.901.04l22.667 22.667c9.373 9.373 9.373 24.569 0 33.941L240.971 381.476c-9.373 9.372-24.569 9.372-33.942 0z"></path>');function jl(v,s){const i=qn(s,["children","$$slots","$$events","$$legacy"]);Yn(v,zn({viewBox:"0 0 448 512"},()=>i,{children:(h,a)=>{var l=Gl();ne(h,l)},$$slots:{default:!0}}))}var Wl=pe('<div class="flex w-full items-center justify-between"><div class="flex grow justify-center"><!></div> <div class="h-4 w-4"><!></div></div>');function ql(v,s){var i=Wl(),h=re(i),a=re(h);vn(a,()=>s.children??Gt),ae(h);var l=te(h,2),f=re(l);jl(f,{}),ae(l),ae(i),ne(v,i)}const zl=v=>{console.log("infoAction",v),v.preventDefault()};var Yl=pe("<button> </button>"),Xl=pe('<button class="btn btn-primary w-[18rem] rounded-none border-0 text-xl font-normal"><!></button>'),Ql=pe("<button> </button>"),Zl=pe('<div class="px-0 py-0.5"><div class="flex w-full items-center justify-between space-x-1 text-xl"><div class="bg-primary flex h-12 w-full grow overflow-hidden border-0"><div><div class="mx-2 flex grow overflow-hidden border-0 whitespace-nowrap"> </div></div></div> <div><button><!></button></div> <div><button><!></button></div> <div class="bg-primary h-12 border-0"><!></div></div></div>');function Re(v,s){Qe(s,!0);let i=me(s,"name",3,""),h=me(s,"min",3,0),a=me(s,"max",3,0),l=me(s,"locked",3,!1),f=me(s,"selectedTag",7,0),P=me(s,"items",19,()=>[]),N=me(s,"select",3,()=>{}),k=me(s,"info",3,void 0);const M=gn(()=>l()?"opacity-50":""),C=gn(()=>{for(const _e of P())if(_e.tag==f())return _e.title;return"???"});var O=Zl(),B=re(O),$=re(B),j=re($),L=re(j),G=re(L,!0);ae(L),ae(j),ae($);var X=te($,2),q=re(X),m=re(q);Dl(m,{}),ae(q),ae(X);var Y=te(X,2),Q=re(Y);Q.__click=[zl];var K=re(Q);Pl(K,{}),ae(Q),ae(Y);var Z=te(Y,2),ce=re(Z);{var Te=_e=>{const De=gn(()=>!l());Hl(_e,{get isEnabled(){return u(De)},get items(){return P()},select:Ie=>{f(Ie),N()(f())},get selectedTag(){return f()},listStyle:"w-[18rem] mt-2 text-xl bg-accent text-accent-content",children:(Ie,xe)=>{var Ue=St(),ke=je(Ue);{var Ee=Se=>{var Oe=Yl(),We=re(Oe,!0);ae(Oe),it(()=>{Ye(Oe,1,`btn btn-primary ${u(M)??""} w-[18rem] rounded-none border-0 text-xl font-normal`),Nt(We,u(C))}),ne(Se,Oe)},He=Se=>{var Oe=Xl(),We=re(Oe);ql(We,{children:(we,qe)=>{Sr();var Ce=Bu();it(()=>Nt(Ce,u(C))),ne(we,Ce)}}),ae(Oe),ne(Se,Oe)};Xe(ke,Se=>{l()?Se(Ee):Se(He,!1)})}ne(Ie,Ue)},$$slots:{default:!0}})},Pe=_e=>{Nl(_e,{get min(){return h()},get max(){return a()},get locked(){return l()},get value(){return f()},select:N(),children:(De,Ie)=>{var xe=Ql(),Ue=re(xe,!0);ae(xe),it(()=>{Ye(xe,1,`btn btn-primary ${u(M)??""} w-[18rem] rounded-none border-0 text-xl font-normal`),Nt(Ue,f())}),ne(De,xe)},$$slots:{default:!0}})};Xe(ce,_e=>{h()===a()?_e(Te):_e(Pe,!1)})}ae(Z),ae(B),ae(O),it(()=>{Ye(j,1,`w-full border-0 text-xl ${u(M)??""} text-primary-content flex items-center justify-between`),Nt(G,i()),Ye(X,1,`bg-primary flex h-12 w-20 items-center justify-center border-0 ${l()?"":"hidden"}`),Ye(q,1,`text-primary-content h-7 w-7 ${u(M)??""}`),Ye(Y,1,`bg-primary flex h-12 w-20 items-center justify-center border-0 ${k()?"":"hidden"}`),Ye(Q,1,`text-primary-content h-7 w-7 ${u(M)??""}`)}),ne(v,O),Ze()}Zt(["click"]);var Jl=pe("<!> <!>",1),ef=pe("<div><!> <!> <!></div>");function tf(v,s){Qe(s,!1);const[i,h]=st(),a=()=>A(It,"$config",i);Mt();var l=ef(),f=re(l);ht(f,{name:"Warp mode",children:(k,M)=>{const C=ee(()=>[new H("During Disk Accesses",0),new H("Never",1),new H("Always",2)]),O=ee(()=>a().getNum(d.WARP_MODE));Re(k,{get items(){return u(C)},name:"Enable warp mode",select:B=>a().setNum(d.WARP_MODE,B),get selectedTag(){return u(O)}})},$$slots:{default:!0}});var P=te(f,2);ht(P,{name:"Appearance",children:(k,M)=>{var C=Jl(),O=je(C);const B=ee(()=>[new H("Default",dt.default),new H("Light",dt.light),new H("Dark",dt.dark),new H("Coffee",dt.coffee),new H("Cupcake",dt.cupcake),new H("Forest",dt.forest),new H("Aqua",dt.aqua),new H("Garden",dt.garden),new H("Pastel",dt.pastel)]),$=ee(()=>a().getNum(d.THEME));Re(O,{get items(){return u(B)},name:"Color theme",select:X=>a().setNum(d.THEME,X),get selectedTag(){return u($)}});var j=te(O,2);const L=ee(()=>[new H("Yes",1),new H("No",0)]),G=ee(()=>a().getNum(d.CANVAS_BORDER));Re(j,{get items(){return u(L)},name:"Draw Canvas Border",select:X=>a().setNum(d.CANVAS_BORDER,X),get selectedTag(){return u(G)}}),ne(k,C)},$$slots:{default:!0}});var N=te(P,2);ht(N,{name:"Peripherals",children:(k,M)=>{const C=ee(()=>[new H("Yes",1),new H("No",0)]),O=ee(()=>a().getNum(d.SHAKING));Re(k,{get items(){return u(C)},name:"Release Mouse by Shaking",select:B=>a().setNum(d.SHAKING,B),get selectedTag(){return u(O)}})},$$slots:{default:!0}}),ae(l),$t(1,l,()=>Lt),ne(v,l),Ze(),h()}var nf=pe("<!> <!>",1),rf=pe("<!> <!> <!>",1),af=pe("<!> <!> <!> <!> <!> <!> <!> <!>",1),of=pe("<!> <!> <!> <!>",1),sf=pe("<!> <!> <!> <!>",1),uf=pe("<div> </div> <!> <!> <!> <!> <!>",1),cf=pe("<div><!></div>");function lf(v,s){Qe(s,!1);const[i,h]=st(),a=()=>A(ja,"$MsgConfig",i),l=()=>A(Qt,"$wasm",i),f=()=>A(It,"$config",i),P=()=>A(na,"$poweredOn",i);Mt();var N=cf(),k=re(N);Jr(k,a,M=>{var C=uf(),O=je(C),B=re(O);ae(O);var $=te(O,2);ht($,{name:"CPU",children:(q,m)=>{var Y=nf(),Q=je(Y);const K=ee(()=>[new H("68000",l().CPU_68000),new H("68010",l().CPU_68010),new H("68020",l().CPU_68EC020)]),Z=ee(()=>f().getNum(d.CPU_REVISION));Re(Q,{name:"CPU",get items(){return u(K)},get selectedTag(){return u(Z)},select:_e=>f().setNum(d.CPU_REVISION,_e)});var ce=te(Q,2);const Te=ee(()=>[new H("7 Mhz",0),new H("14 Mhz",2),new H("21 Mhz",3),new H("28 Mhz",4),new H("35 Mhz",5),new H("42 Mhz",6),new H("84 Mhz",12)]),Pe=ee(()=>f().getNum(d.CPU_SPEED));Re(ce,{name:"Frequency",get items(){return u(Te)},get selectedTag(){return u(Pe)},select:_e=>f().setNum(d.CPU_SPEED,_e)}),ne(q,Y)},$$slots:{default:!0}});var j=te($,2);ht(j,{name:"Custom Chipset",children:(q,m)=>{var Y=rf(),Q=je(Y);const K=ee(()=>[new H("Early OCS",l().AGNUS_OCS_OLD),new H("OCS",l().AGNUS_OCS),new H("ECS (1MB)",l().AGNUS_ECS_1MB),new H("ECS (2MB)",l().AGNUS_ECS_2MB)]),Z=ee(()=>f().getNum(d.AGNUS_REVISION));Re(Q,{name:"Agnus Revision",get items(){return u(K)},get selectedTag(){return u(Z)},select:xe=>f().setNum(d.AGNUS_REVISION,xe),get locked(){return P()}});var ce=te(Q,2);const Te=ee(()=>[new H("OCS",l().DENISE_OCS),new H("ECS",l().DENISE_ECS)]),Pe=ee(()=>f().getNum(d.DENISE_REVISION));Re(ce,{name:"Denise Revision",get items(){return u(Te)},get selectedTag(){return u(Pe)},select:xe=>f().setNum(d.DENISE_REVISION,xe),get locked(){return P()}});var _e=te(ce,2);const De=ee(()=>[new H("NONE",l().RTC_NONE),new H("OKI",l().RTC_OKI),new H("RICOH",l().RTC_RICOH)]),Ie=ee(()=>f().getNum(d.RTC_MODEL));Re(_e,{name:"Real-time Clock",get items(){return u(De)},get selectedTag(){return u(Ie)},select:xe=>f().setNum(d.RTC_MODEL,xe),get locked(){return P()}}),ne(q,Y)},$$slots:{default:!0}});var L=te(j,2);ht(L,{name:"Memory",children:(q,m)=>{var Y=af(),Q=je(Y);const K=ee(()=>[new H("256 KB",256),new H("512 KB",512),new H("1024 KB",1024),new H("2048 KB",2048)]),Z=ee(()=>f().getNum(d.CHIP_RAM));Re(Q,{name:"Chip RAM",get items(){return u(K)},get selectedTag(){return u(Z)},select:Je=>f().setNum(d.CHIP_RAM,Je),get locked(){return P()}});var ce=te(Q,2);const Te=ee(()=>[new H("0 KB",0),new H("512 KB",512),new H("1 MB",1024),new H("1.5 MB",1536)]),Pe=ee(()=>f().getNum(d.SLOW_RAM));Re(ce,{name:"Slow RAM",get items(){return u(Te)},get selectedTag(){return u(Pe)},select:Je=>f().setNum(d.SLOW_RAM,Je),get locked(){return P()}});var _e=te(ce,2);const De=ee(()=>[new H("0 KB",0),new H("64 KB",64),new H("128 KB",128),new H("256 KB",256),new H("512 KB",512),new H("1 MB",1024),new H("2 MB",2048),new H("4 MB",4096),new H("8 MB",8192)]),Ie=ee(()=>f().getNum(d.FAST_RAM));Re(_e,{name:"Fast RAM",get items(){return u(De)},get selectedTag(){return u(Ie)},select:Je=>f().setNum(d.FAST_RAM,Je),get locked(){return P()}});var xe=te(_e,2);const Ue=ee(()=>[new H("Amiga 500",l().BANK_MAP_A500),new H("Amiga 1000",l().BANK_MAP_A1000),new H("Amiga 2000A",l().BANK_MAP_A2000A),new H("Amiga 2000B",l().BANK_MAP_A2000B)]),ke=ee(()=>f().getNum(d.BANK_MAP));Re(xe,{name:"Memory Layout",get items(){return u(Ue)},get selectedTag(){return u(ke)},select:Je=>f().setNum(d.BANK_MAP,Je),get locked(){return P()}});var Ee=te(xe,2);const He=ee(()=>[new H("All Zeroes",l().RAM_INIT_ALL_ZEROES),new H("All Ones",l().RAM_INIT_ALL_ONES),new H("Random",l().RAM_INIT_RANDOMIZED)]),Se=ee(()=>f().getNum(d.INIT_PATTERN));Re(Ee,{name:"Memory Startup Pattern",get items(){return u(He)},get selectedTag(){return u(Se)},select:Je=>f().setNum(d.INIT_PATTERN,Je),get locked(){return P()}});var Oe=te(Ee,2);const We=ee(()=>[new H("Floating",l().UNMAPPED_FLOATING),new H("All Zeroes",l().UNMAPPED_ALL_ZEROES),new H("All Ones",l().UNMAPPED_ALL_ONES)]),we=ee(()=>f().getNum(d.UNMAPPED));Re(Oe,{name:"Unmapped Memory Area",get items(){return u(We)},get selectedTag(){return u(we)},select:Je=>f().setNum(d.UNMAPPED,Je),get locked(){return P()}});var qe=te(Oe,2);const Ce=ee(()=>[new H("Yes",1),new H("No",0)]),tt=ee(()=>f().getNum(d.SLOW_RAM_MIRROR));Re(qe,{name:"Emulate Slow RAM Mirror",get items(){return u(Ce)},get selectedTag(){return u(tt)},select:Je=>f().setNum(d.SLOW_RAM_MIRROR,Je)});var ut=te(qe,2);const at=ee(()=>[new H("Yes",1),new H("No",0)]),S=ee(()=>f().getNum(d.SLOW_RAM_DELAY));Re(ut,{name:"Emulate Slow RAM Bus Delays",get items(){return u(at)},get selectedTag(){return u(S)},select:Je=>f().setNum(d.SLOW_RAM_DELAY,Je)}),ne(q,Y)},$$slots:{default:!0}});var G=te(L,2);ht(G,{name:"Floppy Drives",children:(q,m)=>{var Y=of(),Q=je(Y);const K=ee(()=>[new H("Internal Drive",1)]),Z=ee(()=>f().getNum(d.DF0));Re(Q,{name:"DF0",get items(){return u(K)},get selectedTag(){return u(Z)},select:Se=>f().setNum(d.DF0,Se),get locked(){return P()}});var ce=te(Q,2);const Te=ee(()=>[new H("None",0),new H("A1010",1)]),Pe=ee(()=>f().getNum(d.DF1));Re(ce,{name:"DF1",get items(){return u(Te)},get selectedTag(){return u(Pe)},select:Se=>f().setNum(d.DF1,Se),get locked(){return P()}});var _e=te(ce,2);const De=ee(()=>[new H("None",0),new H("A1010",1)]),Ie=ee(()=>f().getNum(d.DF2)),xe=ee(()=>P()||!f().getBool(d.DF1));Re(_e,{name:"DF2",get items(){return u(De)},get selectedTag(){return u(Ie)},select:Se=>f().setNum(d.DF2,Se),get locked(){return u(xe)}});var Ue=te(_e,2);const ke=ee(()=>[new H("None",0),new H("A1010",1)]),Ee=ee(()=>f().getNum(d.DF3)),He=ee(()=>P()||!f().getBool(d.DF2));Re(Ue,{name:"DF3",get items(){return u(ke)},get selectedTag(){return u(Ee)},select:Se=>f().setNum(d.DF3,Se),get locked(){return u(He)}}),ne(q,Y)},$$slots:{default:!0}});var X=te(G,2);ht(X,{name:"Hard Drives",children:(q,m)=>{var Y=sf(),Q=je(Y);const K=ee(()=>[new H("None",0),new H("Zorro Board",1)]),Z=ee(()=>f().getNum(d.HD0));Re(Q,{name:"HD0",get items(){return u(K)},get selectedTag(){return u(Z)},select:Ee=>f().setNum(d.HD0,Ee),get locked(){return P()}});var ce=te(Q,2);const Te=ee(()=>[new H("None",0),new H("Zorro Board",1)]),Pe=ee(()=>f().getNum(d.HD1));Re(ce,{name:"HD1",get items(){return u(Te)},get selectedTag(){return u(Pe)},select:Ee=>f().setNum(d.HD1,Ee),get locked(){return P()}});var _e=te(ce,2);const De=ee(()=>[new H("None",0),new H("Zorro Board",1)]),Ie=ee(()=>f().getNum(d.HD2));Re(_e,{name:"HD2",get items(){return u(De)},get selectedTag(){return u(Ie)},select:Ee=>f().setNum(d.HD2,Ee),get locked(){return P()}});var xe=te(_e,2);const Ue=ee(()=>[new H("None",0),new H("Zorro Board",1)]),ke=ee(()=>f().getNum(d.HD3));Re(xe,{name:"HD3",get items(){return u(Ue)},get selectedTag(){return u(ke)},select:Ee=>f().setNum(d.HD3,Ee),get locked(){return P()}}),ne(q,Y)},$$slots:{default:!0}}),it(()=>Nt(B,`Huhu ${a()??""}`)),ne(M,C)}),ae(N),$t(1,N,()=>Lt),ne(v,N),Ze(),h()}var ff=pe("<!> <!>",1),df=pe("<!> <!> <!>",1),gf=pe("<div><!> <!> <!> <!> <!> <!></div>");function hf(v,s){Qe(s,!1);const[i,h]=st(),a=()=>A(It,"$config",i);Mt();var l=gf(),f=re(l);ht(f,{name:"Blitter",children:(O,B)=>{const $=ee(()=>[new H("Low",0),new H("Medium",1),new H("High",2)]),j=ee(()=>a().getNum(d.BLITTER_ACCURACY));Re(O,{name:"Accuracy",get items(){return u($)},select:L=>a().setNum(d.BLITTER_ACCURACY,L),get selectedTag(){return u(j)}})},$$slots:{default:!0}});var P=te(f,2);ht(P,{name:"Chipset Features",children:(O,B)=>{var $=ff(),j=je($);const L=ee(()=>[new H("Yes",1),new H("No",0)]),G=ee(()=>a().getNum(d.TODBUG));Re(j,{name:"Emulate TOD Bug",get items(){return u(L)},select:Y=>a().setNum(d.TODBUG,Y),get selectedTag(){return u(G)}});var X=te(j,2);const q=ee(()=>[new H("Yes",1),new H("No",0)]),m=ee(()=>a().getNum(d.PTR_DROPS));Re(X,{name:"Emulate Dropped Register Writes",get items(){return u(q)},select:Y=>a().setNum(d.PTR_DROPS,Y),get selectedTag(){return u(m)}}),ne(O,$)},$$slots:{default:!0}});var N=te(P,2);ht(N,{name:"Timing",children:(O,B)=>{const $=ee(()=>[new H("Yes",1),new H("No",0)]),j=ee(()=>a().getNum(d.ECLOCK_SYNCING));Re(O,{name:"Sync CIA Accesses With E-Clock",get items(){return u($)},select:L=>a().setNum(d.ECLOCK_SYNCING,L),get selectedTag(){return u(j)}})},$$slots:{default:!0}});var k=te(N,2);ht(k,{name:"Floppy Drives",children:(O,B)=>{const $=ee(()=>[new H("Original",1),new H("Accelerated (2 x)",2),new H("Accelerated (4 x)",4),new H("Accelerated (8 x)",8),new H("Infinite",-1)]),j=ee(()=>a().getNum(d.DRIVE_SPEED));Re(O,{name:"Drive Speed",get items(){return u($)},select:L=>a().setNum(d.DRIVE_SPEED,L),get selectedTag(){return u(j)}})},$$slots:{default:!0}});var M=te(k,2);ht(M,{name:"Sprites",children:(O,B)=>{var $=df(),j=je($);const L=ee(()=>[new H("Yes",1),new H("No",0)]),G=ee(()=>a().getNum(d.CLX_SPR_SPR));Re(j,{name:"Sprite-Sprite Collision Detection",get items(){return u(L)},select:Z=>a().setNum(d.CLX_SPR_SPR,Z),get selectedTag(){return u(G)}});var X=te(j,2);const q=ee(()=>[new H("Yes",1),new H("No",0)]),m=ee(()=>a().getNum(d.CLX_SPR_PLF));Re(X,{name:"Sprite-Playfield Collision Detection",get items(){return u(q)},select:Z=>a().setNum(d.CLX_SPR_PLF,Z),get selectedTag(){return u(m)}});var Y=te(X,2);const Q=ee(()=>[new H("Yes",1),new H("No",0)]),K=ee(()=>a().getNum(d.CLX_PLF_PLF));Re(Y,{name:"Playfield-Playfield Collision Detection",get items(){return u(Q)},select:Z=>a().setNum(d.CLX_PLF_PLF,Z),get selectedTag(){return u(K)}}),ne(O,$)},$$slots:{default:!0}});var C=te(M,2);ht(C,{name:"Keyboard",children:(O,B)=>{const $=ee(()=>[new H("Yes",1),new H("No",0)]),j=ee(()=>a().getNum(d.ACCURATE_KEYBOARD));Re(O,{name:"Transmit Keycodes Bit by Bit",get items(){return u($)},select:L=>a().setNum(d.ACCURATE_KEYBOARD,L),get selectedTag(){return u(j)}})},$$slots:{default:!0}}),ae(l),$t(1,l,()=>Lt),ne(v,l),Ze(),h()}var vf=pe("<!> <!> <!> <!>",1),pf=pe("<div><!> <!> <!></div>");function mf(v,s){Qe(s,!1);const[i,h]=st(),a=()=>A(It,"$config",i),l=()=>A(Qt,"$wasm",i);function f(L){a().set(d.RENDER_MODE,L),update()}function P(L){a().set(d.PALETTE,L),update()}function N(L){a().set(d.BRIGHTNESS,L),update()}function k(L){a().set(d.CONTRAST,L),update()}function M(L){a().set(d.SATURATION,L),update()}function C(L){a().set(d.FLICKER_WEIGHT,L),update()}Mt();var O=pf(),B=re(O);ht(B,{name:"WebGL",children:(L,G)=>{const X=ee(()=>[new H("Smooth",wr.smooth),new H("Pixelated",wr.pixelated)]),q=ee(()=>a().getNum(d.RENDER_MODE));Re(L,{name:"Render Mode",get items(){return u(X)},get selectedTag(){return u(q)},select:f})},$$slots:{default:!0}});var $=te(B,2);ht($,{name:"Colors",children:(L,G)=>{var X=vf(),q=je(X);const m=ee(()=>[new H("Color",l().PALETTE_COLOR),new H("Black and White",l().PALETTE_BLACK_WHITE),new H("Paper White",l().PALETTE_PAPER_WHITE),new H("Green",l().PALETTE_GREEN),new H("Amber",l().PALETTE_AMBER),new H("Sepia",l().PALETTE_SEPIA)]),Y=ee(()=>a().getNum(d.PALETTE));Re(q,{name:"Palette",get items(){return u(m)},get selectedTag(){return u(Y)},select:P});var Q=te(q,2);const K=ee(()=>a().getNum(d.BRIGHTNESS));Re(Q,{name:"Brightness",min:0,max:100,get tag(){return l().OPT_BRIGHTNESS},get selectedTag(){return u(K)},select:N});var Z=te(Q,2);const ce=ee(()=>a().getNum(d.CONTRAST));Re(Z,{name:"Contrast",min:0,max:100,get tag(){return l().OPT_CONTRAST},get selectedTag(){return u(ce)},select:k});var Te=te(Z,2);const Pe=ee(()=>a().getNum(d.SATURATION));Re(Te,{name:"Saturation",min:0,max:100,get tag(){return l().OPT_SATURATION},get selectedTag(){return u(Pe)},select:M}),ne(L,X)},$$slots:{default:!0}});var j=te($,2);ht(j,{name:"Interlace",children:(L,G)=>{const X=ee(()=>a().getNum(d.FLICKER_WEIGHT));Re(L,{name:"Flicker Weight",min:0,max:100,tag:1e3,get selectedTag(){return u(X)},select:C})},$$slots:{default:!0}}),ae(O),$t(1,O,()=>Lt),ne(v,O),Ze(),h()}var _f=pe("<!> <!>",1),yf=pe("<!> <!> <!> <!> <!> <!>",1),bf=pe("<!> <!> <!> <!>",1),wf=pe("<div><!> <!> <!></div>");function Ef(v,s){Qe(s,!1);const[i,h]=st(),a=()=>A(It,"$config",i);Mt();var l=wf(),f=re(l);ht(f,{name:"Sound Synthesis",children:(k,M)=>{var C=_f(),O=je(C);const B=ee(()=>[new H("None",0),new H("Nearest",1),new H("Linear",2)]),$=ee(()=>a().getNum(d.SAMPLING_METHOD));Re(O,{name:"Interpolation Method",get items(){return u(B)},select:X=>a().setNum(d.SAMPLING_METHOD,X),get selectedTag(){return u($)}});var j=te(O,2);const L=ee(()=>[new H("None",0),new H("A500",1),new H("A1000",2),new H("A1200",3),new H("Legacy Filter",4),new H("Low-pass only",5),new H("LED filter only",6),new H("High-pass only",7)]),G=ee(()=>a().get(d.FILTER_TYPE));Re(j,{name:"Audio Filter",get items(){return u(L)},select:X=>a().set(d.FILTER_TYPE,X),get selectedTag(){return u(G)}}),ne(k,C)},$$slots:{default:!0}});var P=te(f,2);ht(P,{name:"Speakers",children:(k,M)=>{var C=yf(),O=je(C);const B=ee(()=>a().get(d.AUDVOLL));Re(O,{name:"Left Speaker Volume",get selectedTag(){return u(B)},select:Z=>a().set(d.AUDVOLL,Z),min:0,max:100});var $=te(O,2);const j=ee(()=>a().get(d.AUDVOLR));Re($,{name:"Right Speaker Volume",get selectedTag(){return u(j)},select:Z=>a().set(d.AUDVOLR,Z),min:0,max:100});var L=te($,2);const G=ee(()=>a().get(d.AUDVOL0));Re(L,{name:"Paula Channel 0 Volume",get selectedTag(){return u(G)},select:Z=>a().set(d.AUDVOL0,Z),min:0,max:100});var X=te(L,2);const q=ee(()=>a().get(d.AUDVOL1));Re(X,{name:"Paula Channel 1 Volume",get selectedTag(){return u(q)},select:Z=>a().set(d.AUDVOL1,Z),min:0,max:100});var m=te(X,2);const Y=ee(()=>a().get(d.AUDVOL2));Re(m,{name:"Paula Channel 2 Volume",get selectedTag(){return u(Y)},select:Z=>a().set(d.AUDVOL2,Z),min:0,max:100});var Q=te(m,2);const K=ee(()=>a().get(d.AUDVOL3));Re(Q,{name:"Paula Channel 3 Volume",get selectedTag(){return u(K)},select:Z=>a().set(d.AUDVOL3,Z),min:0,max:100}),ne(k,C)},$$slots:{default:!0}});var N=te(P,2);ht(N,{name:"Drive Sounds",children:(k,M)=>{var C=bf(),O=je(C);const B=ee(()=>a().get(d.STEP_VOLUME));Re(O,{name:"Head Step Volume",get selectedTag(){return u(B)},select:m=>a().set(d.STEP_VOLUME,m),min:0,max:100});var $=te(O,2);const j=ee(()=>a().get(d.POLL_VOLUME));Re($,{name:"Poll Disk Volume",get selectedTag(){return u(j)},select:m=>a().set(d.POLL_VOLUME,m),min:0,max:100});var L=te($,2);const G=ee(()=>a().get(d.INSERT_VOLUME));Re(L,{name:"Insert Disk Volume",get selectedTag(){return u(G)},select:m=>a().set(d.INSERT_VOLUME,m),min:0,max:100});var X=te(L,2);const q=ee(()=>a().get(d.EJECT_VOLUME));Re(X,{name:"Eject Disk Volume",get selectedTag(){return u(q)},select:m=>a().set(d.EJECT_VOLUME,m),min:0,max:100}),ne(k,C)},$$slots:{default:!0}}),ae(l),$t(1,l,()=>Lt),ne(v,l),Ze(),h()}var Sf=pe('<div class="absolute top-0 left-0 w-full h-full flex overflow-auto text-base-content"><div class="w-16 mr-1"></div> <div class="bg-base-100/75 opacity-100 mt-0 p-4 grow h-full overflow-auto"><div class="font-sofia-extra"><div class="flex border-0 border-red-500 justify-between"><div class="text-5xl">SETTINGS</div></div> <div class="flex border-0 border-red-500 justify-between"><div class="float space-x-4 mb-6 border-0"><!> <!> <!> <!> <!></div> <div class="flex justify-between mb-6 border-0 w-[18rem]"><button class="btn btn-outline text-2xl font-normal w-[8.5rem]">Save</button> <button class="btn btn-outline text-2xl font-normal w-[8.5rem]">Reset</button></div></div></div> <!></div></div>');function Tf(v,s){Qe(s,!1);const[i,h]=st(),a=()=>A(It,"$config",i),l=()=>A(Ot,"$layer",i);let f=Ct("GENERAL");function P(){switch(u(f)){case"GENERAL":a().saveGeneralSettings();break;case"MACHINE":a().saveMachineSettings();break;case"COMPATIBILITY":a().saveCompatibilitySettings();break;case"AUDIO":a().saveAudioSettings();break;case"VIDEO":a().saveVideoSettings();break}}function N(){switch(u(f)){case"GENERAL":a().restoreGeneralDefaults();break;case"MACHINE":a().restoreMachineDefaults();break;case"COMPATIBILITY":a().restoreCompatibilityDefaults();break;case"AUDIO":a().restoreAudioDefaults();break;case"VIDEO":a().restoreVideoDefaults();break}}Mt();var k=St(),M=je(k);{var C=O=>{var B=Sf(),$=te(re(B),2),j=re($),L=te(re(j),2),G=re(L),X=re(G);yr(X,{name:"GENERAL",get active(){return u(f)},onclick:()=>Fe(f,"GENERAL")});var q=te(X,2);yr(q,{name:"MACHINE",get active(){return u(f)},onclick:()=>Fe(f,"MACHINE")});var m=te(q,2);yr(m,{name:"COMPATIBILITY",get active(){return u(f)},onclick:()=>Fe(f,"COMPATIBILITY")});var Y=te(m,2);yr(Y,{name:"VIDEO",get active(){return u(f)},onclick:()=>Fe(f,"VIDEO")});var Q=te(Y,2);yr(Q,{name:"AUDIO",get active(){return u(f)},onclick:()=>Fe(f,"AUDIO")}),ae(G);var K=te(G,2),Z=re(K),ce=te(Z,2);ae(K),ae(L),ae(j);var Te=te(j,2);{var Pe=De=>{tf(De,{})},_e=(De,Ie)=>{{var xe=ke=>{lf(ke,{})},Ue=(ke,Ee)=>{{var He=Oe=>{hf(Oe,{})},Se=(Oe,We)=>{{var we=Ce=>{mf(Ce,{})},qe=(Ce,tt)=>{{var ut=at=>{Ef(at,{})};Xe(Ce,at=>{u(f)==="AUDIO"&&at(ut)},tt)}};Xe(Oe,Ce=>{u(f)==="VIDEO"?Ce(we):Ce(qe,!1)},We)}};Xe(ke,Oe=>{u(f)==="COMPATIBILITY"?Oe(He):Oe(Se,!1)},Ee)}};Xe(De,ke=>{u(f)==="MACHINE"?ke(xe):ke(Ue,!1)},Ie)}};Xe(Te,De=>{u(f)==="GENERAL"?De(Pe):De(_e,!1)})}ae($),ae(B),Xt("click",Z,P),Xt("click",ce,N),$t(3,B,()=>Lt),ne(O,B)};Xe(M,O=>{l()===gt.settings&&O(C)})}ne(v,k),Ze(),h()}var xf=pe('<div class="flex h-8"><div><!></div> <div class="h-full w-1 bg-black"></div></div>');function Af(v,s){let i=me(s,"bg",3,"");var h=xf(),a=re(h),l=re(a);vn(l,()=>s.children??Gt),ae(a),Sr(2),ae(h),it(()=>Ye(a,1,`flex h-full w-16 items-center justify-center ${i()??""}`)),ne(v,h)}Zt(["click"]);var Pf=pe('<input type="file" class="hidden"/>');function Rf(v,s){Qe(s,!1);let i=Ct(),h,a;function l(){return u(i).click(),new Promise(function(k,M){h=k,a=M})}async function f(){if(u(i).files&&u(i).files.length>0){let k=u(i).files[0],M=await P(k);h(M)}else a();Ba(i,u(i).value="")}function P(k){return new Promise(async(M,C)=>{try{let O=new FileReader;O.onload=function(B){M(new Uint8Array(this.result))},O.readAsArrayBuffer(k)}catch(O){C(O)}})}Mt();var N=Pf();return Yt(N,k=>Fe(i,k),()=>u(i)),Xt("change",N,f),ne(v,N),Le(s,"open",l),Ze({open:l})}function Df(v,s,i,h){v.preventDefault(),s().setup(),z(ta,!i()),i()||z(Ot,gt.none)}var Of=pe('<button type="button" class="flex h-full w-16 justify-center" id="vamigaButton"><img class="h-full" src="icons/vamigaIcon.png" alt="vAmiga Icon"/></button>'),Mf=pe('<!> <div><!> <div class="flex grow border-0 border-red-500"></div></div>',1);function kf(v,s){Qe(s,!0);const[i,h]=st(),a=()=>A(Er,"$audio",i),l=()=>A(ta,"$showSidebar",i),f=()=>A(Ot,"$layer",i);let P;function N($,j){}var k=Mf(),M=je(k);Yt(Rf(M,{}),$=>P=$,()=>P);var C=te(M,2);Ye(C,1,"relative z-50 mb-1 flex h-8 bg-gradient-to-t from-primary to-primary/80");var O=re(C);Af(O,{children:($,j)=>{var L=Of();L.__click=[Df,a,l,f],ne($,L)},$$slots:{default:!0}}),Sr(2),ae(C),ne(v,k);var B=Ze({update:N});return h(),B}Zt(["click"]);var Cf=pe('<div class="absolute top-0 left-0 w-full h-full flex overflow-auto"><div class="bg-gray-500/85 grow h-full overflow-auto"><textarea readonly="" style="resize: none; font-variant-ligatures: none" class="font-azeret text-base focus:border-transparent focus:outline-none focus:ring-0 text-white bg-transparent w-full h-full p-2"></textarea></div></div>');function Nf(v,s){Qe(s,!1);const[i,h]=st(),a=()=>A(Wa,"$MsgConsoleClose",i),l=()=>A(Ot,"$layer",i),f=()=>A(qa,"$MsgConsoleUpdate",i),P=()=>A(ra,"$retroShell",i);let N=Ct();function k(B){if(B.preventDefault(),B.ctrlKey){switch(B.key){case"k":P().pressCut();break;case"a":P().pressHome();break}return}switch(B.key){case"ArrowUp":P().pressUp();break;case"ArrowDown":P().pressDown();break;case"ArrowLeft":P().pressLeft();break;case"ArrowRight":P().pressRight();break;case"Home":P().pressHome();break;case"End":P().pressEnd();break;case"Backspace":P().pressBackspace();break;case"Delete":P().pressDelete();break;case"Enter":B.shiftKey?P().pressShiftReturn():P().pressReturn();break;case"Tab":P().pressTab();break;default:B.key.length==1&&P().pressKey(B.key.charCodeAt(0))}}jn(()=>(a(),gt),()=>{a()&&z(Ot,gt.none)}),jn(()=>(f(),P(),u(N)),()=>{if(f()){let B=P().getCursorRel();u(N)&&(Ba(N,u(N).value=P().getText()),u(N).focus(),u(N).setSelectionRange(u(N).value.length+B-1,u(N).value.length+B),Ba(N,u(N).scrollTop=u(N).scrollHeight))}}),eo(),Mt();var M=St(),C=je(M);{var O=B=>{var $=Cf(),j=re($),L=re(j);Yt(L,G=>Fe(N,G),()=>u(N)),ae(j),ae($),Xt("keydown",L,k),$t(3,$,()=>Lt),ne(B,$)};Xe(C,B=>{l(),Ku(gt),br(()=>l()===gt.shell)&&B(O)})}ne(v,M),Ze(),h()}var If=pe('<div class="flex h-screen w-screen flex-grow flex-col overflow-clip" role="region"><!></div>');function $f(v,s){Qe(s,!0);const[i,h]=st(),a=()=>A(Qt,"$wasm",i),l=()=>A($n,"$amiga",i),f=()=>A(za,"$proxy",i),P=()=>A(ra,"$retroShell",i),N=()=>A(Qr,"$initialized",i);function k(q){q.preventDefault(),q.dataTransfer}function M(q){q.preventDefault()}function C(q){}async function O(q){if(q.preventDefault(),!q.dataTransfer||!q.dataTransfer.items||q.dataTransfer.items.length!==1)return;let m=q.dataTransfer.items[0];if(m.kind!=="file")return;const Y=m.getAsFile();if(!Y)return;const Q=Y.name;console.log("Dropped file:",Q);let K=await Y.arrayBuffer(),Z=new Uint8Array(K);await Y.arrayBuffer();let ce=Q;switch(console.log("tmp name:",ce),console.log("WASM.FS",a().FS),a().FS.writeFile(ce,Z),console.log("Checking type..."),l().getFileType(ce)){case a().FILETYPE_ROM:await B(Z);return;case a().FILETYPE_ADF:case a().FILETYPE_EADF:case a().FILETYPE_DMS:case a().FILETYPE_EXE:$(Z);return;case a().FILETYPE_HDF:j(Z);return;default:console.warn("Unsupported file format");return}}async function B(q){f().addRom(q)}function $(q){l().insertDisk(q,0),P().importDf(0),P().type(`info
`),z(Ot,gt.shell)}function j(q){l().attachHardDrive(q,0),P().importHd(0,0),P().type(`info
`),z(Ot,gt.shell)}var L=If(),G=re(L);{var X=q=>{var m=St(),Y=je(m);vn(Y,()=>s.children??Gt),ne(q,m)};Xe(G,q=>{N()&&q(X)})}ae(L),Xt("dragenter",L,k),Xt("dragleave",L,C),Xt("dragover",L,M),Xt("drop",L,O),ne(v,L),Ze(),h()}var Lf=Tn('<path d="M242.72 256l100.07-100.07c12.28-12.28 12.28-32.19 0-44.48l-22.24-22.24c-12.28-12.28-32.19-12.28-44.48 0L176 189.28 75.93 89.21c-12.28-12.28-32.19-12.28-44.48 0L9.21 111.45c-12.28 12.28-12.28 32.19 0 44.48L109.28 256 9.21 356.07c-12.28 12.28-12.28 32.19 0 44.48l22.24 22.24c12.28 12.28 32.2 12.28 44.48 0L176 322.72l100.07 100.07c12.28 12.28 32.2 12.28 44.48 0l22.24-22.24c12.28-12.28 12.28-32.19 0-44.48L242.72 256z"></path>');function Uf(v,s){const i=qn(s,["children","$$slots","$$events","$$legacy"]);Yn(v,zn({viewBox:"0 0 352 512"},()=>i,{children:(h,a)=>{var l=Lf();ne(h,l)},$$slots:{default:!0}}))}async function Ff(v,s,i,h){v.preventDefault(),await s().setup(),i()(h.name)}var Bf=pe('<div class="text-primary-content h-full w-full opacity-50"><!></div>'),Kf=pe('<img alt="Icon"/>'),Vf=pe('<img alt="Icon"/>'),Hf=pe('<div class="bg-primary/90 rounded-xl p-4"><div class="flex flex-col items-center"><div role="button" tabindex="0"><!></div> <div class="font-azaret text-primary-content text-xl"> </div></div></div>');function Cn(v,s){Qe(s,!0);const[i,h]=st(),a=()=>A(Er,"$audio",i),l=()=>A(dn,"$invert",i);let f=me(s,"enabled",3,!1),P=me(s,"selected",7,!1),N=me(s,"icon1",3,"icons/disk.png"),k=me(s,"icon2",3,"icons/disk.png");me(s,"opacity",3,"opacity-50");let M=me(s,"select",3,()=>{}),C=gn(()=>P()?"opacity-100":"opacity-50"),O=gn(()=>f()?"opacity-100":"opacity-50");function B(K){K.preventDefault(),f()&&P(!0)}function $(K){K.preventDefault(),P(!1)}var j=Hf(),L=re(j),G=re(L);G.__mousedown=[Ff,a,M,s];var X=re(G);{var q=K=>{var Z=Bf(),ce=re(Z);Uf(ce,{}),ae(Z),ne(K,Z)},m=(K,Z)=>{{var ce=Pe=>{var _e=Kf();it(()=>{Ye(_e,1,`${l()??""} ${u(C)??""}`),hn(_e,"src",N())}),ne(Pe,_e)},Te=(Pe,_e)=>{{var De=Ie=>{var xe=Vf();it(()=>{Ye(xe,1,`${l()??""} ${u(C)??""}`),hn(xe,"src",k())}),ne(Ie,xe)};Xe(Pe,Ie=>{k()!==""&&Ie(De)},_e)}};Xe(K,Pe=>{P()?Pe(ce):Pe(Te,!1)},Z)}};Xe(X,K=>{f()?K(m,!1):K(q)})}ae(G);var Y=te(G,2),Q=re(Y,!0);ae(Y),ae(L),ae(j),it(()=>{Ye(G,1,`border-primary-content h-32 w-32 rounded-xl border-2 p-5 ${u(O)??""}`),Nt(Q,s.name)}),Xt("mouseenter",G,B),Xt("mouseleave",G,$),ne(v,j),Ze(),h()}Zt(["mousedown"]);var Gf=pe("<!> <!> <!> <!>",1),jf=pe("<!> <!> <!> <!>",1),Wf=pe('<div class="absolute top-10 left-0 flex w-screen justify-center"><div class="relative flex items-center justify-center space-x-4 rounded-xl p-4"><!></div></div>');function qf(v,s){Qe(s,!1);const[i,h]=st(),a=()=>A(zu,"$dragItem",i),l=()=>A($n,"$amiga",i),f=()=>A(Ot,"$layer",i),P=()=>A(qu,"$dragType",i),N=()=>A(Rs,"$dfHasDisk",i),k=()=>A(As,"$dfConnected",i),M=()=>A(Ps,"$hdConnected",i);function C(L){a()&&(l().insertDisk(a(),L),l().running||l().run()),z(Ot,gt.none)}function O(L){a()&&(l().attachHardDrive(a(),L),l().running||l().run()),z(Ot,gt.none)}Mt();var B=St(),$=je(B);{var j=L=>{var G=Wf(),X=re(G),q=re(X);{var m=Q=>{var K=Gf(),Z=je(K);const ce=ee(()=>N()[0]?"icons/disk.png":"");Cn(Z,{id:0,icon1:"icons/disk.png",get icon2(){return u(ce)},name:"DF0",get enabled(){return k()[0]},select:()=>C(0)});var Te=te(Z,2);const Pe=ee(()=>N()[1]?"icons/disk.png":"");Cn(Te,{id:1,icon1:"icons/disk.png",get icon2(){return u(Pe)},name:"DF1",get enabled(){return k()[1]},select:()=>C(1)});var _e=te(Te,2);const De=ee(()=>N()[1]?"icons/disk.png":"");Cn(_e,{id:2,icon1:"icons/disk.png",get icon2(){return u(De)},name:"DF2",get enabled(){return k()[2]},select:()=>C(2)});var Ie=te(_e,2);const xe=ee(()=>N()[1]?"icons/disk.png":"");Cn(Ie,{id:3,icon1:"icons/disk.png",get icon2(){return u(xe)},name:"DF3",get enabled(){return k()[3]},select:()=>C(3)}),ne(Q,K)},Y=Q=>{var K=jf(),Z=je(K);Cn(Z,{id:0,icon1:"icons/hard-drive.png",icon2:"icons/hard-drive.png",name:"HD0",get enabled(){return M()[0]},select:()=>O(0)});var ce=te(Z,2);Cn(ce,{id:1,icon1:"icons/hard-drive.png",icon2:"icons/hard-drive.png",name:"HD1",get enabled(){return M()[1]},select:()=>O(1)});var Te=te(ce,2);Cn(Te,{id:2,icon1:"icons/hard-drive.png",icon2:"icons/hard-drive.png",name:"HD2",get enabled(){return M()[2]},select:()=>O(2)});var Pe=te(Te,2);Cn(Pe,{id:3,icon1:"icons/hard-drive.png",icon2:"icons/hard-drive.png",name:"HD3",get enabled(){return M()[3]},select:()=>O(3)}),ne(Q,K)};Xe(q,Q=>{P()==="floppy"?Q(m):Q(Y,!1)})}ae(X),ae(G),$t(3,G,()=>Lt),ne(L,G)};Xe($,L=>{f()===gt.dropzone&&L(j)})}ne(v,B),Ze(),h()}function zf(v,s,i,h){console.log("onclick"),z(Zr,0),Fe(i,!1),clearInterval(u(h)),Fe(h,void 0)}var Yf=pe('<div><div class="font-azeret flex h-24 w-full flex-col justify-center border-none text-center text-lg"><p class="p-1"> </p> <p class="p-1"> </p></div></div>');function Xf(v,s){Qe(s,!1);const[i,h]=st(),a=()=>A(Qt,"$wasm",i),l=()=>A(Zr,"$errno",i),f=()=>A(Ds,"$enums",i),P=()=>A(Ya,"$what",i),N=Ct(),k=Ct();let M=Ct(void 0),C=Ct(!1),O=Ct(!0);jn(()=>a(),()=>{Fe(N,a()!=null)}),jn(()=>(l(),u(N),u(C),u(M),u(O)),()=>{l()&&u(N)&&!u(C)&&(Fe(C,!0),u(M)===void 0&&Fe(M,setInterval(()=>{Fe(O,!u(O))},800)))}),jn(()=>u(O),()=>{Fe(k,u(O)?"border-red-600":"border-black")}),eo(),Mt();var B=St(),$=je(B);{var j=L=>{var G=Yf();G.__click=[zf,l,C,M];var X=re(G),q=re(X),m=re(q);ae(q);var Y=te(q,2),Q=re(Y,!0);ae(Y),ae(X),ae(G),it(K=>{Ye(G,1,`relative flex justify-center border-[10px] bg-black text-red-600 ${u(k)??""}`),Nt(m,`Emulator failure. Uncaught exception ${l()??""} (${K??""})`),Nt(Q,P())},[()=>(f(),l(),br(()=>f().ErrorCodeKey(l())))],ee),ne(L,G)};Xe($,L=>{u(C)&&L(j)})}ne(v,B),Ze(),h()}Zt(["click"]);function Qf(v,s){Qe(s,!1);const[i,h]=st(),a=()=>A(Qt,"$wasm",i),l=()=>A(Er,"$audio",i),f=()=>A($n,"$amiga",i),P=()=>A(It,"$config",i),N=()=>A(Vo,"$memory",i),k=()=>A(Co,"$df0",i),M=()=>A(No,"$df1",i),C=()=>A(Io,"$df2",i),O=()=>A($o,"$df3",i),B=()=>A(Lo,"$diskController",i),$=()=>A(Uo,"$hd0",i),j=()=>A(Fo,"$hd1",i),L=()=>A(Bo,"$hd2",i),G=()=>A(Ko,"$hd3",i),X=()=>A(Ho,"$paula",i),q=()=>A(Qr,"$initialized",i),m=()=>A(rs,"$warp",i),Y=()=>A(ts,"$MsgNone",i),Q=()=>A(ja,"$MsgConfig",i),K=()=>A(es,"$MsgPower",i),Z=()=>A(Ji,"$MsgRun",i),ce=()=>A(Zi,"$MsgPause",i),Te=()=>A(Qi,"$MsgStep",i),Pe=()=>A(Xi,"$MsgReset",i),_e=()=>A(Yi,"$MsgShutdown",i),De=()=>A(zi,"$MsgAbort",i),Ie=()=>A(qi,"$MsgWarp",i),xe=()=>A(Wi,"$MsgTrack",i),Ue=()=>A(ji,"$MsgMute",i),ke=()=>A(Gi,"$MsgPowerLedOn",i),Ee=()=>A(Hi,"$MsgPowerLedDim",i),He=()=>A(Vi,"$MsgPowerLedOff",i),Se=()=>A(Wa,"$MsgConsoleClose",i),Oe=()=>A(qa,"$MsgConsoleUpdate",i),We=()=>A(Ki,"$MsgConsoleDebugger",i),we=()=>A(Bi,"$MsgScriptDone",i),qe=()=>A(Fi,"$MsgScriptPause",i),Ce=()=>A(Ui,"$MsgScriptAbort",i),tt=()=>A(Li,"$MsgScriptWakeup",i),ut=()=>A($i,"$MsgVideoFormat",i),at=()=>A(Ii,"$MsgOverclocking",i),S=()=>A(Ni,"$MsgBreakpointReached",i),Je=()=>A(Ci,"$MsgBreakpointUpdated",i),Tt=()=>A(ki,"$MsgWatchpointReached",i),Be=()=>A(Mi,"$MsgWatchpointUpdated",i),vt=()=>A(Oi,"$MsgCatchpointReached",i),Jt=()=>A(Di,"$MsgCatchpointUpdated",i),pt=()=>A(Ri,"$MsgSwTrapReached",i),sn=()=>A(Pi,"$MsgCpuHalt",i),en=()=>A(Ai,"$MsgCopperBpReached",i),se=()=>A(xi,"$MsgCopperBpUpdated",i),J=()=>A(Ti,"$MsgCopperWpReached",i),yt=()=>A(Si,"$MsgCopperWpUpdated",i),xt=()=>A(Ei,"$MsgViewport",i),Xn=()=>A(wi,"$MsgMemLayout",i),pn=()=>A(bi,"$MsgDriveConnect",i),Qn=()=>A(yi,"$MsgDriveSelect",i),mn=()=>A(_i,"$MsgDriveRead",i),tn=()=>A(mi,"$MsgDriveWrite",i),jt=()=>A(pi,"$MsgDriveLed",i),xn=()=>A(vi,"$MsgDriveMotor",i),_n=()=>A(hi,"$MsgDriveStep",i),Ln=()=>A(gi,"$MsgDrivePoll",i),yn=()=>A(di,"$MsgDiskInsert",i),nn=()=>A(fi,"$MsgDiskEject",i),An=()=>A(li,"$MsgDiskProtected",i),bn=()=>A(ci,"$MsgHdcConnect",i),Ut=()=>A(ui,"$MsgHdcState",i),be=()=>A(si,"$MsgHdrStep",i),At=()=>A(ii,"$MsgHdrRead",i),rn=()=>A(oi,"$MsgHdrWrite",i),ge=()=>A(ai,"$MsgHdrIdle",i),V=()=>A(ri,"$MsgCtrlAmigaAmiga",i),Ae=()=>A(Ka,"$MsgShaking",i),nt=()=>A(ni,"$MsgSerIn",i),mt=()=>A(ti,"$MsgSerOut",i),Tr=()=>A(ei,"$MsgAutoSnapshotTaken",i),ur=()=>A(Jo,"$MsgUserSnapshotTaken",i),aa=()=>A(Zo,"$MsgSnapshotRestored",i),oa=()=>A(Qo,"$MsgRecordingStarted",i),Pn=()=>A(Xo,"$MsgRecordingStopped",i),Rn=()=>A(Yo,"$MsgRecordingAborted",i),cr=()=>A(zo,"$MsgDmaDebug",i),Zn=()=>A(qo,"$MsgSrvState",i),rt=()=>A(Wo,"$MsgSrvReceive",i),lt=()=>A(jo,"$MsgSrvSend",i),ia=()=>A(Go,"$MsgAlarm",i);Wn(()=>{console.log("Proxy::onMount()"),ju(Qt,br(a).processMsg=on,br(a)),Bt()});async function Un(Me){await l().setup();try{console.log("Showcase:",Me.title),f().powerOff(),Ft(Me.roms),P().set(d.CHIP_RAM,Me.memory[0]),P().set(d.SLOW_RAM,Me.memory[1]),P().set(d.FAST_RAM,Me.memory[2]),P().set(d.DF1,Me.adf.length>1);for(let ye=0;ye<Me.adf.length;ye++)await un(Me.adf[ye],ye);P().set(d.WARP_MODE,Me.warp),console.log("Launchine emulator..."),f().run(),Me.title=="Absolute Inebriation"&&(console.log("Scheduling disk change (inebriation)"),f().setAlarmAbs(3e3,1)),Me.title=="Eon"&&(console.log("Scheduling disk change (eon)"),f().setAlarmAbs(7600,2)),console.log("Done")}catch(ye){throw console.log("CATCHED "+ye),ye}}function Dn(){console.error("Exception "+f().errorCode()+": "+f().what())}async function un(Me,ye){try{console.log("Fetching adf/"+Me);let Kt=await(await fetch("adf/"+Me)).arrayBuffer(),Pr=new Uint8Array(Kt);f().insertDisk(Pr,ye),console.log("Disk inserted")}catch{Dn()}}async function Fn(Me){if(Me==0)return N().deleteRom(),N().deleteExt(),z(ns,Me),!0;try{const ye=await In.roms.get(Me);return ye?(ye?.rom?(N().loadRom(ye.rom,ye.rom.length),z(ns,Me)):N().deleteRom(),ye?.ext?N().loadExt(ye.ext,ye.ext.length):N().deleteExt(),!0):!1}catch(ye){return console.log("installRom failed: ",ye),!1}}async function Ft(Me){for(const ye of Me)if(await Fn(ye))return!0;return!1}async function wn(Me){let ye=N().analyzeRom(Me,Me.byteLength);if(ye.crc32){try{const ft=ye.title,Kt=await In.roms.add({crc32:ye.crc32,title:ye.title,version:ye.version,released:ye.released,model:ye.model,isAros:ye.vendor==a().RomVendor.AROS,isDiag:ye.vendor==a().RomVendor.DIAG,isCommodore:ye.vendor==a().RomVendor.COMMODORE,isHyperion:ye.vendor==a().RomVendor.HYPERION,isUnknown:ye.vendor==a().RomVendor.UNKNOWN,isPatched:ye.isPatched,rom:Me,ext:null,extStart:0});console.log(`${ft} successfully added with id ${Kt}`)}catch(ft){throw console.log("Failed to add Kickstart",ft),ft}z(Ot,gt.kickstart)}}async function an(){await Fn(gs.Aros)}async function Bn(){await Fn(gs.DiagROM)}function xr(){Bt()}function Bt(){console.log("Creating proxies..."),z(Yu,new(a()).AgnusProxy),z(Os,new(a()).AudioPortProxy),z(Xu,new(a()).CPUProxy),z(bs,new(a()).DeniseProxy),z(Co,new(a()).DriveProxy(0)),z(No,new(a()).DriveProxy(1)),z(Io,new(a()).DriveProxy(2)),z($o,new(a()).DriveProxy(3)),z(Lo,new(a()).DiskControllerProxy),z(Ds,new(a()).EnumProxy),z(Uo,new(a()).HardDriveProxy(0)),z(Fo,new(a()).HardDriveProxy(1)),z(Bo,new(a()).HardDriveProxy(2)),z(Ko,new(a()).HardDriveProxy(3)),z(to,new(a()).JoystickProxy(1)),z(no,new(a()).JoystickProxy(2)),z(Es,new(a()).KeyboardProxy),z(Vo,new(a()).MemoryProxy),z(ys,new(a()).MouseProxy(1)),z(Ss,new(a()).MouseProxy(2)),z(Ho,new(a()).PaulaProxy),z(ra,new(a()).RetroShellProxy),z($n,new(a()).AmigaProxy),console.log("Launching the emulator..."),f().launch(),console.log("Configuring the emulator..."),f().configure(a().OPT_AGNUS_REVISION,a().AGNUS_ECS_2MB),z(Ts,{ArrowLeft:a().PULL_LEFT,ArrowRight:a().PULL_RIGHT,ArrowUp:a().PULL_UP,ArrowDown:a().PULL_DOWN,ControlRight:a().PRESS_FIRE,Space:a().PRESS_FIRE}),z(xs,{KeyS:a().PULL_LEFT,KeyD:a().PULL_RIGHT,KeyE:a().PULL_UP,KeyX:a().PULL_DOWN,KeyC:a().RELEASE_FIRE}),(async()=>(console.log("Installing Roms..."),Ft([3304125791,2798523958,3283989056,1062194186]),console.log("Initialization completed"),z(Qr,!0)))()}function et(){if(!q())return;const Me=B().getState(),ye=B().getSelected(),ft=Me==a().DRIVE_DMA_WRITE;z(na,f().poweredOn()),z(ws,f().isRunning()),z(rs,f().isWarping()),z(Zu,P().getNum(d.WARP_MODE)),z(Ju,f().isTracking()),z(ec,X().isMuted()||m()),z(tc,f().isHalted()),z(As,[k().isConnected(),M().isConnected(),C().isConnected(),O().isConnected()]),z(Rs,[k().hasDisk(),M().hasDisk(),C().hasDisk(),O().hasDisk()]),z(nc,[k().motor(),M().motor(),C().motor(),O().motor()]),z(rc,[ye==0&&ft,ye==1&&ft,ye==2&&ft,ye==3&&ft]),z(ac,[k().hasModifiedDisk(),M().hasModifiedDisk(),C().hasModifiedDisk(),O().hasModifiedDisk()]),z(oc,[k().hasProtectedDisk(),M().hasProtectedDisk(),C().hasProtectedDisk(),O().hasProtectedDisk()]),z(ic,[k().currentCyl(),M().currentCyl(),C().currentCyl(),O().currentCyl()]),z(Ps,[$().isConnected(),j().isConnected(),L().isConnected(),G().isConnected()]),z(sc,[$().currentCyl(),j().currentCyl(),L().currentCyl(),G().currentCyl()]),z(uc,[$().isReading(),j().isReading(),L().isReading(),G().isReading()]),z(cc,[$().isWriting(),j().isWriting(),L().isWriting(),G().isWriting()])}function on(Me){switch(Me.type?.value){case a().MSG_NONE:he(ts,Y());break;case a().MSG_CONFIG:he(ja,Q()),z(It,P()),et();break;case a().MSG_POWER:he(es,K()),et();break;case a().MSG_RUN:he(Ji,Z()),et();break;case a().MSG_PAUSE:he(Zi,ce()),et();break;case a().MSG_STEP:he(Qi,Te());break;case a().MSG_RESET:he(Xi,Pe()),et();break;case a().MSG_SHUTDOWN:he(Yi,_e());break;case a().MSG_ABORT:he(zi,De());break;case a().MSG_WARP:he(qi,Ie()),et();break;case a().MSG_TRACK:he(Wi,xe()),et();break;case a().MSG_MUTE:he(ji,Ue()),et();break;case a().MSG_POWER_LED_ON:he(Gi,ke());break;case a().MSG_POWER_LED_DIM:he(Hi,Ee());break;case a().MSG_POWER_LED_OFF:he(Vi,He());break;case a().MSG_CONSOLE_CLOSE:he(Wa,Se());break;case a().MSG_CONSOLE_UPDATE:he(qa,Oe());break;case a().MSG_CONSOLE_DEBUGGER:he(Ki,We());break;case a().MSG_SCRIPT_DONE:he(Bi,we());break;case a().MSG_SCRIPT_PAUSE:he(Fi,qe());break;case a().MSG_SCRIPT_ABORT:he(Ui,Ce());break;case a().MSG_SCRIPT_WAKEUP:he(Li,tt());break;case a().MSG_VIDEO_FORMAT:he($i,ut());break;case a().MSG_OVERCLOCKING:he(Ii,at());break;case a().MSG_BREAKPOINT_REACHED:he(Ni,S());break;case a().MSG_BREAKPOINT_UPDATED:he(Ci,Je());break;case a().MSG_WATCHPOINT_REACHED:he(ki,Tt());break;case a().MSG_WATCHPOINT_UPDATED:he(Mi,Be());break;case a().MSG_CATCHPOINT_REACHED:he(Oi,vt());break;case a().MSG_CATCHPOINT_UPDATED:he(Di,Jt());break;case a().MSG_SWTRAP_REACHED:he(Ri,pt());break;case a().MSG_CPU_HALT:he(Pi,sn()),et();break;case a().MSG_COPPERBP_REACHED:he(Ai,en());break;case a().MSG_COPPERBP_UPDATED:he(xi,se());break;case a().MSG_COPPERWP_REACHED:he(Ti,J());break;case a().MSG_COPPERWP_UPDATED:he(Si,yt());break;case a().MSG_VIEWPORT:he(Ei,xt());break;case a().MSG_MEM_LAYOUT:he(wi,Xn());break;case a().MSG_DRIVE_CONNECT:he(bi,pn()),et();break;case a().MSG_DRIVE_SELECT:he(yi,Qn());break;case a().MSG_DRIVE_READ:he(_i,mn());break;case a().MSG_DRIVE_WRITE:he(mi,tn()),et();break;case a().MSG_DRIVE_LED:he(pi,jt());break;case a().MSG_DRIVE_MOTOR:he(vi,xn()),et();break;case a().MSG_DRIVE_STEP:he(hi,_n()),et(),l().playStepSound(Me.drive.volume,Me.drive.pan);break;case a().MSG_DRIVE_POLL:he(gi,Ln()),et(),l().playStepSound(Me.drive.volume,Me.drive.pan);break;case a().MSG_DISK_INSERT:he(di,yn()),et(),l().playInsertSound(Me.drive.volume,Me.drive.pan);break;case a().MSG_DISK_EJECT:he(fi,nn()),et(),l().playEjectSound(Me.drive.volume,Me.drive.pan);break;case a().MSG_DISK_PROTECTED:he(li,An()),et();break;case a().MSG_HDC_CONNECT:he(ci,bn()),et();break;case a().MSG_HDC_STATE:he(ui,Ut()),et();break;case a().MSG_HDR_STEP:he(si,be()),l().playClickSound(Me.drive.volume,Me.drive.pan);break;case a().MSG_HDR_READ:he(ii,At()),et();break;case a().MSG_HDR_WRITE:he(oi,rn()),et();break;case a().MSG_HDR_IDLE:he(ai,ge()),et();break;case a().MSG_CTRL_AMIGA_AMIGA:he(ri,V());break;case a().MSG_SHAKING:he(Ka,Ae());break;case a().MSG_SER_IN:he(ni,nt());break;case a().MSG_SER_OUT:he(ti,mt());break;case a().MSG_AUTO_SNAPSHOT_TAKEN:he(ei,Tr());break;case a().MSG_USER_SNAPSHOT_TAKEN:he(Jo,ur());break;case a().MSG_SNAPSHOT_RESTORED:he(Zo,aa()),et();break;case a().MSG_RECORDING_STARTED:he(Qo,oa());break;case a().MSG_RECORDING_STOPPED:he(Xo,Pn());break;case a().MSG_RECORDING_ABORTED:he(Yo,Rn());break;case a().MSG_DMA_DEBUG:he(zo,cr()),z(Qu,Me.value);break;case a().MSG_SRV_STATE:he(qo,Zn());break;case a().MSG_SRV_RECEIVE:he(Wo,rt());break;case a().MSG_SRV_SEND:he(jo,lt());break;case a().MSG_ALARM:he(Go,ia()),console.log("Alarm received: ",Me.value),Me.value==1&&(console.log("Inserting disk 2..."),un("AbsoluteInebriation2.adf",0)),Me.value==2&&(console.log("Inserting disk 2..."),un("Eon2.adf",0));break}}Mt(),Le(s,"runShowcase",Un),Le(s,"reportException",Dn),Le(s,"insert",un),Le(s,"installRom",Fn),Le(s,"installRoms",Ft),Le(s,"addRom",wn),Le(s,"installAros",an),Le(s,"installDiagRom",Bn),Le(s,"runtimeInitialized",xr),Le(s,"onRuntimeInitialized",Bt),Le(s,"updateStateVariables",et),Le(s,"processMsg",on);var Ar=Ze({runShowcase:Un,reportException:Dn,insert:un,installRom:Fn,installRoms:Ft,addRom:wn,installAros:an,installDiagRom:Bn,runtimeInitialized:xr,onRuntimeInitialized:Bt,updateStateVariables:et,processMsg:on});return h(),Ar}function Zf(v,s){Qe(s,!1);const[i,h]=st(),a=()=>A(Os,"$audioPort",i),l=()=>A(Qt,"$wasm",i);let f,P,N,k,M,C=0;async function O(){if(f)return;console.log("Setting up audio..."),f=new AudioContext,f.onstatechange=()=>console.log("Audio Context: state = "+f.state);let Y=f.createGain();Y.gain.value=1,Y.connect(f.destination),console.log("Audio context: ",f.state),a().setSampleRate(f.sampleRate),await f.audioWorklet.addModule("js/audio-processor.js"),console.log("Audio Worklet module loaded");const Q=new AudioWorkletNode(f,"audio-processor",{outputChannelCount:[2],processorOptions:{pointers:[a().leftChannelBuffer(),a().rightChannelBuffer()],buffer:l().HEAPF32.buffer,length:2048}});console.log("Audio Worklet Node created"),Q.port.onmessage=K=>{a().updateAudio(K.data)},Q.connect(Y),f.state==="suspended"&&await f.resume(),await B()}async function B(){console.log("Loading sounds..."),P||(P=await q("sounds/insert.mp3")),N||(N=await q("sounds/eject.mp3")),k||(k=await q("sounds/step.mp3")),M||(M=await q("sounds/stephd.mp3"))}function $(Y,Q){X(P,Y)}function j(Y,Q){X(N,Y)}function L(Y,Q){X(k,Y)}function G(Y,Q){X(M,Y)}async function X(Y,Q,K){if(Y==null||C>=3)return;const Z=f.createGain();Z.gain.value=.004*Q,Z.connect(f.destination);const ce=f.createBufferSource();ce.buffer=Y,ce.addEventListener("ended",()=>{C--}),ce.connect(Z),ce.start(),C++}async function q(Y){let K=await(await fetch(Y)).arrayBuffer();return await f.decodeAudioData(K)}Mt(),Le(s,"setup",O),Le(s,"playInsertSound",$),Le(s,"playEjectSound",j),Le(s,"playStepSound",L),Le(s,"playClickSound",G);var m=Ze({setup:O,playInsertSound:$,playEjectSound:j,playStepSound:L,playClickSound:G});return h(),m}function Jf(v,s){Qe(s,!1);const[i,h]=st(),a=()=>A($n,"$amiga",i),l=()=>A(Qt,"$wasm",i),f=()=>A(It,"$config",i);let P=[{opt:d.WARP_MODE,default:[lc.auto].toString()},{opt:d.THEME,default:dt.default.toString()},{opt:d.CANVAS_BORDER,default:"0"},{opt:d.SHAKING,default:"1"}],N=[{opt:d.CPU_REVISION,default:"0"},{opt:d.AGNUS_REVISION,default:"0"},{opt:d.DENISE_REVISION,default:"0"},{opt:d.RTC_MODEL,default:"0"},{opt:d.CHIP_RAM,default:"512"},{opt:d.SLOW_RAM,default:"512"},{opt:d.FAST_RAM,default:"0"},{opt:d.BANK_MAP,default:"0"},{opt:d.INIT_PATTERN,default:"0"},{opt:d.UNMAPPED,default:"0"},{opt:d.SLOW_RAM_MIRROR,default:"1"},{opt:d.SLOW_RAM_DELAY,default:"1"},{opt:d.DF0,default:"1"},{opt:d.DF1,default:"1"},{opt:d.DF2,default:"0"},{opt:d.DF3,default:"0"},{opt:d.HD0,default:"1"},{opt:d.HD1,default:"0"},{opt:d.HD2,default:"0"},{opt:d.HD3,default:"0"}],k=[{opt:d.BLITTER_ACCURACY,default:"2"},{opt:d.TODBUG,default:"1"},{opt:d.PTR_DROPS,default:"1"},{opt:d.ECLOCK_SYNCING,default:"1"},{opt:d.DRIVE_SPEED,default:"1"},{opt:d.DRIVE_MECHANICS,default:"1"},{opt:d.OPT_LOCK_DSKSYNC,default:"0"},{opt:d.OPT_AUTO_DSKSYNC,default:"0"},{opt:d.CLX_SPR_SPR,default:"0"},{opt:d.CLX_SPR_PLF,default:"0"},{opt:d.CLX_PLF_PLF,default:"0"},{opt:d.ACCURATE_KEYBOARD,default:"1"}],M=[{opt:d.ASR,default:"0"},{opt:d.BUFFER_SIZE,default:"16384"},{opt:d.AUDVOL0,default:"100"},{opt:d.AUDVOL1,default:"100"},{opt:d.AUDVOL2,default:"100"},{opt:d.AUDVOL3,default:"100"},{opt:d.AUDVOLL,default:"50"},{opt:d.AUDVOLR,default:"50"},{opt:d.STEP_VOLUME,default:"50"},{opt:d.POLL_VOLUME,default:"50"},{opt:d.INSERT_VOLUME,default:"50"},{opt:d.EJECT_VOLUME,default:"50"}],C=[{opt:d.RENDER_MODE,default:wr.smooth.toString()},{opt:d.FLICKER_WEIGHT,default:"0"},{opt:d.PALETTE,default:"0"},{opt:d.BRIGHTNESS,default:"50"},{opt:d.CONTRAST,default:"100"},{opt:d.SATURATION,default:"50"}],O=dt.default,B=0,$=1,j=wr.smooth;$s(()=>In.opts.toArray()).subscribe(se=>{}),Wn(()=>{console.log("Config::onMount()"),G(),xe()});async function G(){await X(),await q(),await m(),await Y(),await Q()}async function X(){for(const se of P)await K(se.opt,se.default)}async function q(){for(const se of N)await K(se.opt,se.default)}async function m(){for(const se of k)await K(se.opt,se.default)}async function Y(){for(const se of M)await K(se.opt,se.default)}async function Q(){for(const se of C)await K(se.opt,se.default)}async function K(se,J){try{await In.opts.add({key:se,value:J})}catch{}}async function Z(){await ce(),await Te(),await Pe(),await _e(),await De()}async function ce(){for(const se of P)await Ie(se.opt);await X(),await Ue()}async function Te(){for(const se of N)await Ie(se.opt);await q(),await ke()}async function Pe(){for(const se of k)await Ie(se.opt);await m(),await Ee()}async function _e(){for(const se of M)await Ie(se.opt);await Y(),await He()}async function De(){for(const se of C)await Ie(se.opt);await Q(),await Se()}async function Ie(se){try{const J=await In.opts.delete(se)}catch{console.log("Failed to remove entry",se)}}async function xe(){console.log("Loading settings..."),await Ue(),await ke(),await Ee(),await He(),await Se()}async function Ue(){for(const se of P)await Oe(se.opt)}async function ke(){for(const se of N)await Oe(se.opt)}async function Ee(){for(const se of k)await Oe(se.opt)}async function He(){for(const se of M)await Oe(se.opt)}async function Se(){for(const se of C)await Oe(se.opt)}async function Oe(se){try{const J=await In.opts.get(se);J!==void 0&&vt(se,J.value)}catch{}}async function We(){await we(),await qe(),await Ce(),await tt(),await ut()}async function we(){for(const se of P)await at(se.opt)}async function qe(){for(const se of N)await at(se.opt)}async function Ce(){for(const se of k)await at(se.opt)}async function tt(){for(const se of M)await at(se.opt)}async function ut(){for(const se of C)await at(se.opt)}async function at(se){const J=Je(se);try{const yt=await In.opts.put({key:se,value:J})}catch{}}function S(se){if(se==null)throw console.warn("Value is undefined or null"),new Error("Value is undefined or null");return se}function Je(se){switch(se){case d.THEME:return[O].toString();case d.CANVAS_BORDER:return B.toString();case d.SHAKING:return $.toString();case d.CPU_REVISION:return a().getConfig(S(l().OPT_CPU_REVISION)).toString();case d.CPU_SPEED:return a().getConfig(S(l().OPT_CPU_OVERCLOCKING)).toString();case d.WARP_MODE:return a().getConfig(S(l().OPT_AMIGA_WARP_MODE)).toString();case d.AGNUS_REVISION:return a().getConfig(S(l().OPT_AGNUS_REVISION)).toString();case d.DENISE_REVISION:return a().getConfig(S(l().OPT_DENISE_REVISION)).toString();case d.RTC_MODEL:return a().getConfig(S(l().OPT_RTC_MODEL)).toString();case d.CHIP_RAM:return a().getConfig(S(l().OPT_MEM_CHIP_RAM)).toString();case d.SLOW_RAM:return a().getConfig(S(l().OPT_MEM_SLOW_RAM)).toString();case d.FAST_RAM:return a().getConfig(S(l().OPT_MEM_FAST_RAM)).toString();case d.BANK_MAP:return a().getConfig(S(l().OPT_MEM_BANKMAP)).toString();case d.INIT_PATTERN:return a().getConfig(S(l().OPT_MEM_RAM_INIT_PATTERN)).toString();case d.UNMAPPED:return a().getConfig(S(l().OPT_MEM_UNMAPPING_TYPE)).toString();case d.SLOW_RAM_MIRROR:return a().getConfig(S(l().OPT_MEM_SLOW_RAM_MIRROR)).toString();case d.SLOW_RAM_DELAY:return a().getConfig(S(l().OPT_MEM_SLOW_RAM_DELAY)).toString();case d.DF0:return a().getConfigId(S(l().OPT_DRIVE_CONNECT),0).toString();case d.DF1:return a().getConfigId(S(l().OPT_DRIVE_CONNECT),1).toString();case d.DF2:return a().getConfigId(S(l().OPT_DRIVE_CONNECT),2).toString();case d.DF3:return a().getConfigId(S(l().OPT_DRIVE_CONNECT),3).toString();case d.HD0:return a().getConfigId(S(l().OPT_HDC_CONNECT),0).toString();case d.HD1:return a().getConfigId(S(l().OPT_HDC_CONNECT),1).toString();case d.HD2:return a().getConfigId(S(l().OPT_HDC_CONNECT),2).toString();case d.HD3:return a().getConfigId(S(l().OPT_HDC_CONNECT),3).toString();case d.BLITTER_ACCURACY:return a().getConfig(S(l().OPT_BLITTER_ACCURACY)).toString();case d.TODBUG:return a().getConfig(S(l().OPT_CIA_TODBUG)).toString();case d.PTR_DROPS:return a().getConfig(S(l().OPT_AGNUS_PTR_DROPS)).toString();case d.ECLOCK_SYNCING:return a().getConfig(S(l().OPT_CIA_ECLOCK_SYNCING)).toString();case d.DRIVE_SPEED:return a().getConfig(S(l().OPT_DC_SPEED)).toString();case d.DRIVE_MECHANICS:return a().getConfig(S(l().OPT_DRIVE_MECHANICS)).toString();case d.OPT_LOCK_DSKSYNC:return a().getConfig(S(l().OPT_DC_LOCK_DSKSYNC)).toString();case d.OPT_AUTO_DSKSYNC:return a().getConfig(S(l().OPT_DC_AUTO_DSKSYNC)).toString();case d.CLX_SPR_SPR:return a().getConfig(S(l().OPT_DENISE_CLX_SPR_SPR)).toString();case d.CLX_SPR_PLF:return a().getConfig(S(l().OPT_DENISE_CLX_SPR_PLF)).toString();case d.CLX_PLF_PLF:return a().getConfig(S(l().OPT_DENISE_CLX_PLF_PLF)).toString();case d.ACCURATE_KEYBOARD:return a().getConfig(S(l().OPT_KBD_ACCURACY)).toString();case d.SAMPLING_METHOD:return a().getConfig(S(l().OPT_AUD_SAMPLING_METHOD)).toString();case d.FILTER_TYPE:return a().getConfig(S(l().OPT_AUD_FILTER_TYPE)).toString();case d.BUFFER_SIZE:return a().getConfig(S(l().OPT_AUD_BUFFER_SIZE)).toString();case d.ASR:return a().getConfig(S(l().OPT_AUD_ASR)).toString();case d.AUDVOL0:return a().getConfig(S(l().OPT_AUD_VOL0)).toString();case d.AUDVOL1:return a().getConfig(S(l().OPT_AUD_VOL1)).toString();case d.AUDVOL2:return a().getConfig(S(l().OPT_AUD_VOL2)).toString();case d.AUDVOL3:return a().getConfig(S(l().OPT_AUD_VOL3)).toString();case d.AUDVOLL:return a().getConfig(S(l().OPT_AUD_VOLL)).toString();case d.AUDVOLR:return a().getConfig(S(l().OPT_AUD_VOLR)).toString();case d.STEP_VOLUME:return a().getConfigId(S(l().OPT_DRIVE_STEP_VOLUME),0).toString();case d.POLL_VOLUME:return a().getConfigId(S(l().OPT_DRIVE_POLL_VOLUME),0).toString();case d.INSERT_VOLUME:return a().getConfigId(S(l().OPT_DRIVE_INSERT_VOLUME),0).toString();case d.EJECT_VOLUME:return a().getConfigId(S(l().OPT_DRIVE_EJECT_VOLUME),0).toString();case d.RENDER_MODE:return j.toString();case d.PALETTE:return a().getConfig(S(l().OPT_MON_PALETTE)).toString();case d.BRIGHTNESS:return a().getConfig(S(l().OPT_MON_BRIGHTNESS)).toString();case d.CONTRAST:return a().getConfig(S(l().OPT_MON_CONTRAST)).toString();case d.SATURATION:return a().getConfig(S(l().OPT_MON_SATURATION)).toString();case d.FLICKER_WEIGHT:return a().getConfig(S(l().OPT_MON_FLICKER_WEIGHT)).toString();default:return console.warn("get: Invalid option: ",se),"???"}}function Tt(se){return Number(Je(se))}function Be(se){return Tt(se)!=0}function vt(se,J){switch(se){case d.THEME:sn(Number(J));break;case d.CANVAS_BORDER:B=Number(J);break;case d.SHAKING:$=Number(J);break;case d.CPU_REVISION:a().configure(S(l().OPT_CPU_REVISION),Number(J));break;case d.CPU_SPEED:a().configure(S(l().OPT_CPU_OVERCLOCKING),Number(J));break;case d.WARP_MODE:a().configure(S(l().OPT_AMIGA_WARP_MODE),Number(J));break;case d.AGNUS_REVISION:a().configure(S(l().OPT_AGNUS_REVISION),Number(J));break;case d.DENISE_REVISION:a().configure(S(l().OPT_DENISE_REVISION),Number(J));break;case d.RTC_MODEL:a().configure(S(l().OPT_RTC_MODEL),Number(J));break;case d.CHIP_RAM:a().configure(S(l().OPT_MEM_CHIP_RAM),Number(J));break;case d.SLOW_RAM:a().configure(S(l().OPT_MEM_SLOW_RAM),Number(J));break;case d.FAST_RAM:a().configure(S(l().OPT_MEM_FAST_RAM),Number(J));break;case d.BANK_MAP:a().configure(S(l().OPT_MEM_BANKMAP),Number(J));break;case d.INIT_PATTERN:a().configure(S(l().OPT_MEM_RAM_INIT_PATTERN),Number(J));break;case d.UNMAPPED:a().configure(S(l().OPT_MEM_UNMAPPING_TYPE),Number(J));break;case d.SLOW_RAM_MIRROR:a().configure(S(l().OPT_MEM_SLOW_RAM_MIRROR),Number(J));break;case d.SLOW_RAM_DELAY:a().configure(S(l().OPT_MEM_SLOW_RAM_DELAY),Number(J));break;case d.DF0:break;case d.DF1:a().configureId(S(l().OPT_DRIVE_CONNECT),Number(J),1),Number(J)==0&&a().configureId(S(l().OPT_DRIVE_CONNECT),0,2),Number(J)==0&&a().configureId(S(l().OPT_DRIVE_CONNECT),0,3);break;case d.DF2:Number(J)==1&&a().configureId(S(l().OPT_DRIVE_CONNECT),1,1),a().configureId(S(l().OPT_DRIVE_CONNECT),Number(J),2),Number(J)==0&&a().configureId(S(l().OPT_DRIVE_CONNECT),0,3);break;case d.DF3:Number(J)==1&&a().configureId(S(l().OPT_DRIVE_CONNECT),1,1),Number(J)==1&&a().configureId(S(l().OPT_DRIVE_CONNECT),1,2),a().configureId(S(l().OPT_DRIVE_CONNECT),Number(J),3);break;case d.HD0:a().configureId(S(l().OPT_HDC_CONNECT),0,J);break;case d.HD1:a().configureId(S(l().OPT_HDC_CONNECT),1,J);break;case d.HD2:a().configureId(S(l().OPT_HDC_CONNECT),2,J);break;case d.HD3:a().configureId(S(l().OPT_HDC_CONNECT),3,J);break;case d.BLITTER_ACCURACY:a().configure(S(l().OPT_BLITTER_ACCURACY),Number(J));break;case d.TODBUG:a().configure(S(l().OPT_CIA_TODBUG),Number(J));break;case d.PTR_DROPS:a().configure(S(l().OPT_AGNUS_PTR_DROPS),Number(J));break;case d.ECLOCK_SYNCING:a().configure(S(l().OPT_CIA_ECLOCK_SYNCING),Number(J));break;case d.DRIVE_SPEED:a().configure(S(l().OPT_DC_SPEED),Number(J));break;case d.DRIVE_MECHANICS:a().configureId(S(l().OPT_DRIVE_MECHANICS),0,Number(J)),a().configureId(S(l().OPT_DRIVE_MECHANICS),1,Number(J)),a().configureId(S(l().OPT_DRIVE_MECHANICS),2,Number(J)),a().configureId(S(l().OPT_DRIVE_MECHANICS),3,Number(J));break;case d.OPT_LOCK_DSKSYNC:a().configure(S(l().OPT_DC_LOCK_DSKSYNC),Number(J));break;case d.OPT_AUTO_DSKSYNC:a().configure(S(l().OPT_DC_AUTO_DSKSYNC),Number(J));break;case d.CLX_SPR_SPR:a().configure(S(l().OPT_DENISE_CLX_SPR_SPR),Number(J));break;case d.CLX_SPR_PLF:a().configure(S(l().OPT_DENISE_CLX_SPR_PLF),Number(J));break;case d.CLX_PLF_PLF:a().configure(S(l().OPT_DENISE_CLX_PLF_PLF),Number(J));break;case d.ACCURATE_KEYBOARD:a().configure(S(l().OPT_KBD_ACCURACY),Number(J));break;case d.SAMPLING_METHOD:a().configure(S(l().OPT_AUD_SAMPLING_METHOD),Number(J));break;case d.FILTER_TYPE:a().configure(S(l().OPT_AUD_FILTER_TYPE),Number(J));break;case d.BUFFER_SIZE:a().configure(S(l().OPT_AUD_BUFFER_SIZE),Number(J));break;case d.ASR:a().configure(S(l().OPT_AUD_ASR),Number(J));break;case d.AUDVOL0:a().configure(S(l().OPT_AUD_VOL0),Number(J));break;case d.AUDVOL1:a().configure(S(l().OPT_AUD_VOL1),Number(J));break;case d.AUDVOL2:a().configure(S(l().OPT_AUD_VOL2),Number(J));break;case d.AUDVOL3:a().configure(S(l().OPT_AUD_VOL3),Number(J));break;case d.AUDVOLL:a().configure(S(l().OPT_AUD_VOLL),Number(J));break;case d.AUDVOLR:a().configure(S(l().OPT_AUD_VOLR),Number(J));break;case d.STEP_VOLUME:a().configureId(S(l().OPT_DRIVE_STEP_VOLUME),Number(J),0);break;case d.POLL_VOLUME:a().configureId(S(l().OPT_DRIVE_POLL_VOLUME),Number(J),0);break;case d.INSERT_VOLUME:a().configureId(S(l().OPT_DRIVE_INSERT_VOLUME),Number(J),0);break;case d.EJECT_VOLUME:a().configureId(S(l().OPT_DRIVE_EJECT_VOLUME),Number(J),0);break;case d.RENDER_MODE:j=Number(J);break;case d.PALETTE:a().configure(S(l().OPT_MON_PALETTE),Number(J));break;case d.BRIGHTNESS:a().configure(S(l().OPT_MON_BRIGHTNESS),Number(J));break;case d.CONTRAST:a().configure(S(l().OPT_MON_CONTRAST),Number(J));break;case d.SATURATION:a().configure(S(l().OPT_MON_SATURATION),Number(J));break;case d.FLICKER_WEIGHT:a().configure(S(l().OPT_MON_FLICKER_WEIGHT),Number(J));break;default:console.warn("set: Invalid option: ",se)}z(It,f())}function Jt(se,J){vt(se,J.toString())}function pt(se,J){vt(se,J?"true":"false")}function sn(se){O=se;let J="";switch(O){case dt.default:J="mytheme",z(fn,!0),z(dn,"invert");break;case dt.light:J="light",z(fn,!0),z(dn,"invert");break;case dt.dark:J="dark",z(fn,!0),z(dn,"invert");break;case dt.coffee:J="coffee",z(fn,!1),z(dn,"");break;case dt.cupcake:J="cupcake",z(fn,!1),z(dn,"");break;case dt.forest:J="forest",z(fn,!0),z(dn,"invert");break;case dt.aqua:J="aqua",z(fn,!1),z(dn,"");break;case dt.garden:J="garden",z(fn,!0),z(dn,"invert");break;case dt.pastel:J="pastel",z(fn,!1),z(dn,"");break;default:console.warn("Invalid theme")}document.querySelector("html")?.setAttribute("data-theme",J)}Mt(),Le(s,"restoreDefaults",Z),Le(s,"restoreGeneralDefaults",ce),Le(s,"restoreMachineDefaults",Te),Le(s,"restoreCompatibilityDefaults",Pe),Le(s,"restoreAudioDefaults",_e),Le(s,"restoreVideoDefaults",De),Le(s,"loadSettings",xe),Le(s,"loadGeneralSettings",Ue),Le(s,"loadMachineSettings",ke),Le(s,"loadCompatibilitySettings",Ee),Le(s,"loadAudioSettings",He),Le(s,"loadVideoSettings",Se),Le(s,"saveSettings",We),Le(s,"saveGeneralSettings",we),Le(s,"saveMachineSettings",qe),Le(s,"saveCompatibilitySettings",Ce),Le(s,"saveAudioSettings",tt),Le(s,"saveVideoSettings",ut),Le(s,"get",Je),Le(s,"getNum",Tt),Le(s,"getBool",Be),Le(s,"set",vt),Le(s,"setNum",Jt),Le(s,"setBool",pt);var en=Ze({restoreDefaults:Z,restoreGeneralDefaults:ce,restoreMachineDefaults:Te,restoreCompatibilityDefaults:Pe,restoreAudioDefaults:_e,restoreVideoDefaults:De,loadSettings:xe,loadGeneralSettings:Ue,loadMachineSettings:ke,loadCompatibilitySettings:Ee,loadAudioSettings:He,loadVideoSettings:Se,saveSettings:We,saveGeneralSettings:we,saveMachineSettings:qe,saveCompatibilitySettings:Ce,saveAudioSettings:tt,saveVideoSettings:ut,get:Je,getNum:Tt,getBool:Be,set:vt,setNum:Jt,setBool:pt});return h(),en}function ed(v,s){Qe(s,!0);const[i,h]=st(),a=()=>A(qt,"$port1",i),l=()=>A(to,"$joystick1",i),f=()=>A(zt,"$port2",i),P=()=>A(no,"$joystick2",i),N=()=>A(Qt,"$wasm",i);let k=me(s,"gamepads",31,()=>Vu({}));Wn(()=>{console.log("GamePadManager::onMount()"),window.addEventListener("gamepadconnected",B=>{k(k()[B.gamepad.index]=B.gamepad,!0)},!1),window.addEventListener("gamepaddisconnected",B=>{delete k()[B.gamepad.index]},!1)});function M(){return a()==kt.gamepad1||a()==kt.gamepad2?l():f()==kt.gamepad1||f()==kt.gamepad2?P():null}function C(){const B=navigator.getGamepads();if(B.length==0)return;const $=B[0];if(!$)return;const j=$.buttons[0].pressed,L=$.axes[0].valueOf(),G=$.axes[1].valueOf();j?M()?.trigger(N().PRESS_FIRE):M()?.trigger(N().RELEASE_FIRE),L<-.5?M()?.trigger(N().PULL_LEFT):L>.5?M()?.trigger(N().PULL_RIGHT):M()?.trigger(N().RELEASE_X),G<-.5?M()?.trigger(N().PULL_UP):G>.5?M()?.trigger(N().PULL_DOWN):M()?.trigger(N().RELEASE_Y)}var O=Ze({pollState:C});return h(),O}var td=pe('<!> <div class="box relative grow overflow-auto border-none border-green-300"><!> <!> <!> <!> <!> <!></div>',1),nd=pe("<!> <!> <!> <!>",1),rd=pe('<div class="h-screen overflow-y-auto scroll-smooth bg-black text-white"><!> <!> <!></div>');function yd(v,s){Qe(s,!1);const[i,h]=st(),a=()=>A(Qr,"$initialized",i),l=()=>A(Va,"$canvasWidth",i),f=()=>A(Ha,"$canvasHeight",i),P=()=>A(qr,"$aspectWidth",i),N=()=>A(zr,"$aspectHeight",i),k=()=>A($n,"$amiga",i),M=()=>A(ra,"$retroShell",i),C=()=>A(Qt,"$wasm",i),O=()=>A(Ot,"$layer",i),B=()=>A(qt,"$port1",i),$=()=>A(zt,"$port2",i),j=()=>A(za,"$proxy",i),L=()=>A(It,"$config",i),G=()=>A(Er,"$audio",i),X=()=>A(Ga,"$gamepadManager",i);let q=0,m=Ct(),Y=Ct(),Q=Ct(),K;$s(()=>In.roms.orderBy("title").toArray()).subscribe(we=>{z(fc,we)}),Wn(()=>{console.log("+page::onMount()"),window.addEventListener("resize",function(){clearTimeout(K),K=setTimeout(Pe,250)}),window.addEventListener("error",_e),window.addEventListener("unhandledrejection",De)});function ce(we){q++,u(m)&&u(m).doAnimationFrame(q,we),u(Q)&&u(Q).update(q,we),window.requestAnimationFrame(ce)}function Te(){u(Y)!=null&&(z(Va,u(Y).clientWidth),z(Ha,u(Y).clientHeight),z(qr,l()),z(zr,P()*3/4),N()>f()&&(z(zr,f()),z(qr,N()*4/3)))}function Pe(){Te()}function _e(we){k().what()!==0&&(z(Ya,k().what()),z(Zr,k().errorCode()))}function De(we){k().what()!==0&&(z(Ya,k().what()),z(Zr,k().errorCode()))}async function Ie(we,qe){const tt=await(await window.showSaveFilePicker({suggestedName:we,types:[{description:"Binary File",accept:{"application/octet-stream":[".adf",".hdf"]}}]})).createWritable();await tt.write(qe),await tt.close()}function xe(we,qe){switch(we){case"export":console.log("export");try{console.log("Exporting file system..."),M().exportBlocks("blob"),console.log("Reading data..."),console.log(C().FS.readdir("/")),console.log(C().FS.analyzePath("/blob"));const Ce=C().FS.readFile("/blob");console.log("data: ",Ce),console.log("Save to host file system..."),Ie("",Ce),console.log("File system successfully exported")}catch(Ce){console.error("Export failed!"),console.error("Error object:",Ce),console.log("FS.analyzePath:",C().FS.analyzePath("/blob")),console.log("FS contents:",C().FS.readdir("/"))}break;case"shell":z(Ot,O()==gt.shell?gt.none:gt.shell),z(ta,!1);break;case"settings":z(Ot,O()==gt.settings?gt.none:gt.settings);break;case"monitor":k().getConfig(C().OPT_DMA_DEBUG_ENABLE)?(u(m).textureRect.zoomIn(),k().configure(C().OPT_DMA_DEBUG_ENABLE,0)):(u(m).textureRect.zoomOut(),k().configure(C().OPT_DMA_DEBUG_ENABLE,1));break;case"pause":try{k().isRunning()?(console.log("Pausing..."),k().pause()):(console.log("Running..:"),k().run())}catch(Ce){console.log(Ce),C().reportException()}break;case"power":try{k().poweredOn()?(k().powerOff(),k().hardReset()):k().run()}catch(Ce){console.log(Ce),C().reportException()}break;case"reset":try{k().hardReset()}catch(Ce){console.log(Ce),C().reportException()}break;case"fit":z(Yr,"fit");break;case"aspect":z(Yr,"aspect");break;case"full":z(Yr,"full");break;case"empty1":z(qt,0);break;case"mouse1":z(qt,1),$()==1&&z(zt,0);break;case"keyset11":z(qt,2),$()==2&&z(zt,0);break;case"keyset12":z(qt,3),$()==3&&z(zt,0);break;case"gamepad11":z(qt,4),$()==4&&z(zt,0);break;case"empty2":z(zt,0);break;case"mouse2":z(zt,1),B()==1&&z(qt,0);break;case"keyset21":z(zt,2),B()==2&&z(qt,0);break;case"keyset22":z(zt,3),B()==3&&z(qt,0);break;case"gamepad21":z(zt,4),B()==4&&z(qt,0);break;default:console.log("Unhandled sender: "+we)}}function Ue(we){}jn(()=>u(Y),()=>{u(Y)&&Te()}),jn(()=>a(),()=>{a()&&window.requestAnimationFrame(ce)}),eo(),Mt();var ke=rd();Hu(we=>{Gu.title="vAmigaDOS"});var Ee=re(ke);Xf(Ee,{});var He=te(Ee,2);{var Se=we=>{Yt(Qf(we,{$$legacy:!0}),qe=>z(za,qe),()=>j())};Xe(He,we=>{C()&&we(Se)})}var Oe=te(He,2);{var We=we=>{var qe=nd(),Ce=je(qe);Yt(Jf(Ce,{$$legacy:!0}),S=>z(It,S),()=>L());var tt=te(Ce,2);Yt(Zf(tt,{$$legacy:!0}),S=>z(Er,S),()=>G());var ut=te(tt,2);Yt(ed(ut,{$$legacy:!0}),S=>z(Ga,S),()=>X());var at=te(ut,2);$f(at,{children:(S,Je)=>{var Tt=td(),Be=je(Tt);Yt(kf(Be,{$$events:{push:Ue},$$legacy:!0}),yt=>Fe(Q,yt),()=>u(Q));var vt=te(Be,2),Jt=re(vt);fl(Jt,{});var pt=te(Jt,2);Yt(Sl(pt,{$$legacy:!0}),yt=>Fe(m,yt),()=>u(m));var sn=te(pt,2);Nf(sn,{});var en=te(sn,2);Tf(en,{});var se=te(en,2);qf(se,{});var J=te(se,2);Kc(J,{action:xe}),ae(vt),Yt(vt,yt=>Fe(Y,yt),()=>u(Y)),ne(S,Tt)},$$slots:{default:!0}}),ne(we,qe)};Xe(Oe,we=>{a()&&we(We)})}ae(ke),ne(v,ke),Ze(),h()}export{yd as component};
